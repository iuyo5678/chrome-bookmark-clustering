(lp0
S'http://shiyanjun.cn/archives/744.html'
p1
aS'RDD\xef\xbc\x9a\xe5\x9f\xba\xe4\xba\x8e\xe5\x86\x85\xe5\xad\x98\xe7\x9a\x84\xe9\x9b\x86\xe7\xbe\xa4\xe8\xae\xa1\xe7\xae\x97\xe5\xae\xb9\xe9\x94\x99\xe6\x8a\xbd\xe8\xb1\xa1 | \xe7\xae\x80\xe5\x8d\x95\xe4\xb9\x8b\xe7\xbe\x8e'
p2
aI0
aV<!DOCTYPE html>\u000a<html lang="zh-CN" class="no-js">\u000a<head>\u000a<meta charset="UTF-8" />\u000a<meta name="baidu_union_verify" content="fa039528e51a3ffc6565fb61e9efe996">\u000a<meta name="baidu-tc-verification" content="50ab2a647c7650cd0f17b1a9de12d89d" />\u000a<meta name="viewport" content="width=device-width" />\u000a<title>\u7b80\u5355\u4e4b\u7f8e | RDD\uff1a\u57fa\u4e8e\u5185\u5b58\u7684\u96c6\u7fa4\u8ba1\u7b97\u5bb9\u9519\u62bd\u8c61</title>\u000a<link rel="profile" href="http://gmpg.org/xfn/11" />\u000a<link rel="pingback" href="http://shiyanjun.cn/xmlrpc.php" />\u000a\u000a\u000a<link rel="alternate" type="application/rss+xml" title="\u7b80\u5355\u4e4b\u7f8e &raquo; Feed" href="http://shiyanjun.cn/feed" />\u000a<link rel="alternate" type="application/rss+xml" title="\u7b80\u5355\u4e4b\u7f8e &raquo; \u8bc4\u8bbaFeed" href="http://shiyanjun.cn/comments/feed" />\u000a<link rel="alternate" type="application/rss+xml" title="\u7b80\u5355\u4e4b\u7f8e &raquo; RDD\uff1a\u57fa\u4e8e\u5185\u5b58\u7684\u96c6\u7fa4\u8ba1\u7b97\u5bb9\u9519\u62bd\u8c61\u8bc4\u8bbaFeed" href="http://shiyanjun.cn/archives/744.html/feed" />\u000a<link rel='stylesheet' id='mediamaven_style-css'  href='http://shiyanjun.cn/wp-content/themes/media-maven/style.css?ver=3.9.2' type='text/css' media='all' />\u000a<link rel='stylesheet' id='wp-pagenavi-css'  href='http://shiyanjun.cn/wp-content/plugins/wp-pagenavi/pagenavi-css.css?ver=2.70' type='text/css' media='all' />\u000a<script type='text/javascript' src='http://shiyanjun.cn/wp-content/themes/media-maven/library/js/modernizr-2.6.1.min.js?ver=2.6.1'></script>\u000a<script type='text/javascript' src='http://shiyanjun.cn/wp-includes/js/jquery/jquery.js?ver=1.11.0'></script>\u000a<script type='text/javascript' src='http://shiyanjun.cn/wp-includes/js/jquery/jquery-migrate.min.js?ver=1.2.1'></script>\u000a<script type='text/javascript' src='http://shiyanjun.cn/wp-content/themes/media-maven/library/js/scripts.js?ver=1.0.0'></script>\u000a<link rel="EditURI" type="application/rsd+xml" title="RSD" href="http://shiyanjun.cn/xmlrpc.php?rsd" />\u000a<link rel="wlwmanifest" type="application/wlwmanifest+xml" href="http://shiyanjun.cn/wp-includes/wlwmanifest.xml" /> \u000a<link rel='prev' title='\u4f7f\u7528Java\u7f16\u5199\u5e76\u8fd0\u884cSpark\u5e94\u7528\u7a0b\u5e8f' href='http://shiyanjun.cn/archives/742.html' />\u000a<link rel='next' title='Shark-0.9.0\u5b89\u88c5\u914d\u7f6e\u8fd0\u884c\u5b9e\u8df5' href='http://shiyanjun.cn/archives/772.html' />\u000a<meta name="generator" content="WordPress 3.9.2" />\u000a<link rel='canonical' href='http://shiyanjun.cn/archives/744.html' />\u000a<link rel='shortlink' href='http://shiyanjun.cn/?p=744' />\u000a<style type="text/css" id="custom-background-css">\u000abody.custom-background { background-image: url('http://shiyanjun.cn/wp-content/themes/media-maven/library/images/bg.jpg'); background-repeat: repeat; background-position: top left; background-attachment: fixed; }\u000a</style>\u000a<style type="text/css" id="syntaxhighlighteranchor"></style>\u000a</head>\u000a\u000a<body class="single single-post postid-744 single-format-standard custom-background single-author">\u000a<div id="container">\u000a	<header id="branding" role="banner">\u000a      <div id="inner-header" class="clearfix">\u000a		<hgroup id="site-heading">\u000a			<h1 id="site-title"><a href="http://shiyanjun.cn/" title="\u7b80\u5355\u4e4b\u7f8e" rel="home">\u7b80\u5355\u4e4b\u7f8e</a></h1>\u000a			<h2 id="site-description">\u7b80\u5355\u4e4b\u7f8e\uff0c\u96be\u5f97\u7b80\u5355\uff0c\u4eab\u53d7\u7b80\u5355\u7684\u552f\u7f8e\u3002</h2>\u000a		</hgroup>\u000a\u000a		<nav id="access" role="navigation">\u000a			<h1 class="assistive-text section-heading">Main menu</h1>\u000a			<div class="skip-link screen-reader-text"><a href="#content" title="Skip to content">Skip to content</a></div>\u000a			<div class="menu"><ul id="menu-%e6%88%91%e7%9a%84%e8%8f%9c%e5%8d%95" class="menu"><li id="menu-item-167" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-home menu-item-167"><a href="http://shiyanjun.cn">\u9996\u9875</a></li>\u000a<li id="menu-item-118" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-118"><a href="http://shiyanjun.cn/archives/category/programming">\u7f16\u7a0b\u8bed\u8a00</a></li>\u000a<li id="menu-item-788" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-788"><a href="http://shiyanjun.cn/archives/category/algorithm">\u7b97\u6cd5</a></li>\u000a<li id="menu-item-113" class="menu-item menu-item-type-taxonomy menu-item-object-category current-post-ancestor menu-item-113"><a href="http://shiyanjun.cn/archives/category/opensource">\u5f00\u6e90\u6280\u672f</a></li>\u000a<li id="menu-item-126" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-126"><a href="http://shiyanjun.cn/archives/category/database">\u6570\u636e\u5e93</a></li>\u000a<li id="menu-item-121" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-121"><a href="http://shiyanjun.cn/archives/category/server">\u670d\u52a1\u5668</a></li>\u000a<li id="menu-item-226" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-226"><a href="http://shiyanjun.cn/archives/category/datamining">\u6570\u636e\u6316\u6398</a></li>\u000a<li id="menu-item-199" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-199"><a href="http://shiyanjun.cn/about">\u5173\u4e8e</a></li>\u000a</ul></div>			<form role="search" method="get" id="searchform" class="searchform" action="http://shiyanjun.cn/">\u000a				<div>\u000a					<label class="screen-reader-text" for="s">\u641c\u7d22\uff1a</label>\u000a					<input type="text" value="" name="s" id="s" />\u000a					<input type="submit" id="searchsubmit" value="\u641c\u7d22" />\u000a				</div>\u000a			</form>		</nav><!-- #access -->\u000a        \u000a\u000a      </div>\u000a\u000a\u000a	</header><!-- #branding -->\u000a\u000a    <div id="content" class="clearfix">\u000a        \u000a        <div id="main" class="col620 clearfix" role="main">\u000a\u000a			\u000a				<article id="post-744" class="post-744 post type-post status-publish format-standard hentry category-spark tag-spark">\u000a	<header class="entry-header">\u000a		<h1 class="entry-title">RDD\uff1a\u57fa\u4e8e\u5185\u5b58\u7684\u96c6\u7fa4\u8ba1\u7b97\u5bb9\u9519\u62bd\u8c61</h1>\u000a\u000a		<div class="entry-meta">\u000a			<span class="sep"><i title="\u53d1\u8868\u65f6\u95f4" class="icon-calendar"></i></span> <a href="http://shiyanjun.cn/archives/744.html" title="21:39:32" rel="bookmark"><time class="entry-date" datetime="2014-03-13T21:39:32+00:00">2014-03-13 21:39:32</time></a> <span class="byline"> <span class="sep"> &nbsp;&nbsp;<i title="\u6587\u7ae0\u4f5c\u8005" class="icon-user"></i></span> <span class="author vcard"><a class="url fn n" href="http://shiyanjun.cn/archives/author/yanjun" title="\u67e5\u770b\u4f5c\u8005 Yanjun \u7684\u5168\u90e8\u6587\u7ae0" rel="author">Yanjun</a></span></span>		</div><!-- .entry-meta -->\u000a	</header><!-- .entry-header -->\u000a\u000a	<div class="entry-content post_content">\u000a		<p><em>\u8be5\u8bba\u6587\u6765\u81eaBerkeley\u5b9e\u9a8c\u5ba4\uff0c\u82f1\u6587\u6807\u9898\u4e3a\uff1a<a href="http://www.eecs.berkeley.edu/Pubs/TechRpts/2011/EECS-2011-82.pdf">Resilient Distributed Datasets: A Fault-Tolerant Abstraction for In-Memory Cluster Computing</a>\u3002\u4e0b\u9762\u7684\u7ffb\u8bd1\uff0c\u6211\u662f\u57fa\u4e8e<a href="http://blog.sciencenet.cn/blog-425672-520947.html">\u79d1\u5b66\u7f51</a>\u7ffb\u8bd1\u57fa\u7840\u4e0a\u8fdb\u884c\u4f18\u5316\u3001\u4fee\u6539\u3001\u8865\u5145\uff0c\u8fd9\u7bc7\u8bd1\u6587\u7ffb\u8bd1\u5f97\u5f88\u4e0d\u9519\u3002\u5728\u6b64\u57fa\u7840\u4e0a\uff0c\u6211\u589e\u52a0\u4e86\u6765\u81ea\u82f1\u6587\u539f\u6587\u7684\u56fe\u548c\u8868\u683c\u6570\u636e\uff0c\u4ee5\u53ca\u8bd1\u6587\u4e2d\u7f3a\u5c11\u7684\u672a\u7ffb\u8bd1\u7684\u90e8\u5206\u3002\u5982\u679c\u7ffb\u8bd1\u63aa\u8f9e\u6216\u903b\u8f91\u6709\u8bef\uff0c\u6b22\u8fce\u6279\u8bc4\u6307\u6b63\u3002</em></p>\u000a<h2>\u6458\u8981</h2>\u000a<p>\u672c\u6587\u63d0\u51fa\u4e86\u5206\u5e03\u5f0f\u5185\u5b58\u62bd\u8c61\u7684\u6982\u5ff5\u2014\u2014\u5f39\u6027\u5206\u5e03\u5f0f\u6570\u636e\u96c6\uff08RDD\uff0cResilient Distributed Datasets\uff09\uff0c\u5b83\u5177\u5907\u50cfMapReduce\u7b49\u6570\u636e\u6d41\u6a21\u578b\u7684\u5bb9\u9519\u7279\u6027\uff0c\u5e76\u4e14\u5141\u8bb8\u5f00\u53d1\u4eba\u5458\u5728\u5927\u578b\u96c6\u7fa4\u4e0a\u6267\u884c\u57fa\u4e8e\u5185\u5b58\u7684\u8ba1\u7b97\u3002\u73b0\u6709\u7684\u6570\u636e\u6d41\u7cfb\u7edf\u5bf9\u4e24\u79cd\u5e94\u7528\u7684\u5904\u7406\u5e76\u4e0d\u9ad8\u6548\uff1a\u4e00\u662f\u8fed\u4ee3\u5f0f\u7b97\u6cd5\uff0c\u8fd9\u5728\u56fe\u5e94\u7528\u548c\u673a\u5668\u5b66\u4e60\u9886\u57df\u5f88\u5e38\u89c1\uff1b\u4e8c\u662f\u4ea4\u4e92\u5f0f\u6570\u636e\u6316\u6398\u5de5\u5177\u3002\u8fd9\u4e24\u79cd\u60c5\u51b5\u4e0b\uff0c\u5c06\u6570\u636e\u4fdd\u5b58\u5728\u5185\u5b58\u4e2d\u80fd\u591f\u6781\u5927\u5730\u63d0\u9ad8\u6027\u80fd\u3002\u4e3a\u4e86\u6709\u6548\u5730\u5b9e\u73b0\u5bb9\u9519\uff0cRDD\u63d0\u4f9b\u4e86\u4e00\u79cd\u9ad8\u5ea6\u53d7\u9650\u7684\u5171\u4eab\u5185\u5b58\uff0c\u5373RDD\u662f\u53ea\u8bfb\u7684\uff0c\u5e76\u4e14\u53ea\u80fd\u901a\u8fc7\u5176\u4ed6RDD\u4e0a\u7684\u6279\u91cf\u64cd\u4f5c\u6765\u521b\u5efa\u3002\u5c3d\u7ba1\u5982\u6b64\uff0cRDD\u4ecd\u7136\u8db3\u4ee5\u8868\u793a\u5f88\u591a\u7c7b\u578b\u7684\u8ba1\u7b97\uff0c\u5305\u62ecMapReduce\u548c\u4e13\u7528\u7684\u8fed\u4ee3\u7f16\u7a0b\u6a21\u578b\uff08\u5982Pregel\uff09\u7b49\u3002\u6211\u4eec\u5b9e\u73b0\u7684RDD\u5728\u8fed\u4ee3\u8ba1\u7b97\u65b9\u9762\u6bd4Hadoop\u5feb20\u591a\u500d\uff0c\u540c\u65f6\u8fd8\u53ef\u4ee5\u57285-7\u79d2\u5185\u4ea4\u4e92\u5f0f\u5730\u67e5\u8be21TB\u6570\u636e\u96c6\u3002</p>\u000a<h2>1.\u5f15\u8a00</h2>\u000a<p>\u65e0\u8bba\u662f\u5de5\u4e1a\u754c\u8fd8\u662f\u5b66\u672f\u754c\uff0c\u90fd\u5df2\u7ecf\u5e7f\u6cdb\u4f7f\u7528\u9ad8\u7ea7\u96c6\u7fa4\u7f16\u7a0b\u6a21\u578b\u6765\u5904\u7406\u65e5\u76ca\u589e\u957f\u7684\u6570\u636e\uff0c\u5982MapReduce\u548cDryad\u3002\u8fd9\u4e9b\u7cfb\u7edf\u5c06\u5206\u5e03\u5f0f\u7f16\u7a0b\u7b80\u5316\u4e3a\u81ea\u52a8\u63d0\u4f9b\u4f4d\u7f6e\u611f\u77e5\u6027\u8c03\u5ea6\u3001\u5bb9\u9519\u4ee5\u53ca\u8d1f\u8f7d\u5747\u8861\uff0c\u4f7f\u5f97\u5927\u91cf\u7528\u6237\u80fd\u591f\u5728\u5546\u7528\u96c6\u7fa4\u4e0a\u5206\u6790\u8d85\u5927\u6570\u636e\u96c6\u3002</p>\u000a<p>\u5927\u591a\u6570\u73b0\u6709\u7684\u96c6\u7fa4\u8ba1\u7b97\u7cfb\u7edf\u90fd\u662f\u57fa\u4e8e\u975e\u5faa\u73af\u7684\u6570\u636e\u6d41\u6a21\u578b\u3002\u4ece\u7a33\u5b9a\u7684\u7269\u7406\u5b58\u50a8\uff08\u5982\u5206\u5e03\u5f0f\u6587\u4ef6\u7cfb\u7edf\uff09\u4e2d\u52a0\u8f7d\u8bb0\u5f55\uff0c\u8bb0\u5f55\u88ab\u4f20\u5165\u7531\u4e00\u7ec4\u786e\u5b9a\u6027\u64cd\u4f5c\u6784\u6210\u7684DAG\uff0c\u7136\u540e\u5199\u56de\u7a33\u5b9a\u5b58\u50a8\u3002DAG\u6570\u636e\u6d41\u56fe\u80fd\u591f\u5728\u8fd0\u884c\u65f6\u81ea\u52a8\u5b9e\u73b0\u4efb\u52a1\u8c03\u5ea6\u548c\u6545\u969c\u6062\u590d\u3002</p>\u000a<p>\u5c3d\u7ba1\u975e\u5faa\u73af\u6570\u636e\u6d41\u662f\u4e00\u79cd\u5f88\u5f3a\u5927\u7684\u62bd\u8c61\u65b9\u6cd5\uff0c\u4f46\u4ecd\u7136\u6709\u4e9b\u5e94\u7528\u65e0\u6cd5\u4f7f\u7528\u8fd9\u79cd\u65b9\u5f0f\u63cf\u8ff0\u3002\u6211\u4eec\u5c31\u662f\u9488\u5bf9\u8fd9\u4e9b\u4e0d\u592a\u9002\u5408\u975e\u5faa\u73af\u6a21\u578b\u7684\u5e94\u7528\uff0c\u5b83\u4eec\u7684\u7279\u70b9\u662f\u5728\u591a\u4e2a\u5e76\u884c\u64cd\u4f5c\u4e4b\u95f4\u91cd\u7528\u5de5\u4f5c\u6570\u636e\u96c6\u3002\u8fd9\u7c7b\u5e94\u7528\u5305\u62ec\uff1a\uff081\uff09\u673a\u5668\u5b66\u4e60\u548c\u56fe\u5e94\u7528\u4e2d\u5e38\u7528\u7684\u8fed\u4ee3\u7b97\u6cd5\uff08\u6bcf\u4e00\u6b65\u5bf9\u6570\u636e\u6267\u884c\u76f8\u4f3c\u7684\u51fd\u6570\uff09\uff1b\uff082\uff09\u4ea4\u4e92\u5f0f\u6570\u636e\u6316\u6398\u5de5\u5177\uff08\u7528\u6237\u53cd\u590d\u67e5\u8be2\u4e00\u4e2a\u6570\u636e\u5b50\u96c6\uff09\u3002\u57fa\u4e8e\u6570\u636e\u6d41\u7684\u6846\u67b6\u5e76\u4e0d\u660e\u786e\u652f\u6301\u5de5\u4f5c\u96c6\uff0c\u6240\u4ee5\u9700\u8981\u5c06\u6570\u636e\u8f93\u51fa\u5230\u78c1\u76d8\uff0c\u7136\u540e\u5728\u6bcf\u6b21\u67e5\u8be2\u65f6\u91cd\u65b0\u52a0\u8f7d\uff0c\u8fd9\u5e26\u6765\u8f83\u5927\u7684\u5f00\u9500\u3002</p>\u000a<p>\u6211\u4eec\u63d0\u51fa\u4e86\u4e00\u79cd\u5206\u5e03\u5f0f\u7684\u5185\u5b58\u62bd\u8c61\uff0c\u79f0\u4e3a\u5f39\u6027\u5206\u5e03\u5f0f\u6570\u636e\u96c6\uff08RDD\uff0cResilient Distributed Datasets\uff09\u3002\u5b83\u652f\u6301\u57fa\u4e8e\u5de5\u4f5c\u96c6\u7684\u5e94\u7528\uff0c\u540c\u65f6\u5177\u6709\u6570\u636e\u6d41\u6a21\u578b\u7684\u7279\u70b9\uff1a\u81ea\u52a8\u5bb9\u9519\u3001\u4f4d\u7f6e\u611f\u77e5\u8c03\u5ea6\u548c\u53ef\u4f38\u7f29\u6027\u3002RDD\u5141\u8bb8\u7528\u6237\u5728\u6267\u884c\u591a\u4e2a\u67e5\u8be2\u65f6\u663e\u5f0f\u5730\u5c06\u5de5\u4f5c\u96c6\u7f13\u5b58\u5728\u5185\u5b58\u4e2d\uff0c\u540e\u7eed\u7684\u67e5\u8be2\u80fd\u591f\u91cd\u7528\u5de5\u4f5c\u96c6\uff0c\u8fd9\u6781\u5927\u5730\u63d0\u5347\u4e86\u67e5\u8be2\u901f\u5ea6\u3002</p>\u000a<p>RDD\u63d0\u4f9b\u4e86\u4e00\u79cd\u9ad8\u5ea6\u53d7\u9650\u7684\u5171\u4eab\u5185\u5b58\u6a21\u578b\uff0c\u5373RDD\u662f\u53ea\u8bfb\u7684\u8bb0\u5f55\u5206\u533a\u7684\u96c6\u5408\uff0c\u53ea\u80fd\u901a\u8fc7\u5728\u5176\u4ed6RDD\u6267\u884c\u786e\u5b9a\u7684\u8f6c\u6362\u64cd\u4f5c\uff08\u5982map\u3001join\u548cgroup by\uff09\u800c\u521b\u5efa\uff0c\u7136\u800c\u8fd9\u4e9b\u9650\u5236\u4f7f\u5f97\u5b9e\u73b0\u5bb9\u9519\u7684\u5f00\u9500\u5f88\u4f4e\u3002\u4e0e\u5206\u5e03\u5f0f\u5171\u4eab\u5185\u5b58\u7cfb\u7edf\u9700\u8981\u4ed8\u51fa\u9ad8\u6602\u4ee3\u4ef7\u7684\u68c0\u67e5\u70b9\u548c\u56de\u6eda\u673a\u5236\u4e0d\u540c\uff0cRDD\u901a\u8fc7Lineage\u6765\u91cd\u5efa\u4e22\u5931\u7684\u5206\u533a\uff1a\u4e00\u4e2aRDD\u4e2d\u5305\u542b\u4e86\u5982\u4f55\u4ece\u5176\u4ed6RDD\u884d\u751f\u6240\u5fc5\u9700\u7684\u76f8\u5173\u4fe1\u606f\uff0c\u4ece\u800c\u4e0d\u9700\u8981\u68c0\u67e5\u70b9\u64cd\u4f5c\u5c31\u53ef\u4ee5\u91cd\u6784\u4e22\u5931\u7684\u6570\u636e\u5206\u533a\u3002\u5c3d\u7ba1RDD\u4e0d\u662f\u4e00\u4e2a\u901a\u7528\u7684\u5171\u4eab\u5185\u5b58\u62bd\u8c61\uff0c\u4f46\u5374\u5177\u5907\u4e86\u826f\u597d\u7684\u63cf\u8ff0\u80fd\u529b\u3001\u53ef\u4f38\u7f29\u6027\u548c\u53ef\u9760\u6027\uff0c\u4f46\u5374\u80fd\u591f\u5e7f\u6cdb\u9002\u7528\u4e8e\u6570\u636e\u5e76\u884c\u7c7b\u5e94\u7528\u3002</p>\u000a<p>\u7b2c\u4e00\u4e2a\u6307\u51fa\u975e\u5faa\u73af\u6570\u636e\u6d41\u5b58\u5728\u4e0d\u8db3\u7684\u5e76\u975e\u662f\u6211\u4eec\uff0c\u4f8b\u5982\uff0cGoogle\u7684Pregel[21]\uff0c\u662f\u4e00\u79cd\u4e13\u95e8\u7528\u4e8e\u8fed\u4ee3\u5f0f\u56fe\u7b97\u6cd5\u7684\u7f16\u7a0b\u6a21\u578b\uff1bTwister[13]\u548cHaLoop[8]\uff0c\u662f\u4e24\u79cd\u5178\u578b\u7684\u8fed\u4ee3\u5f0fMapReduce\u6a21\u578b\u3002\u4f46\u662f\uff0c\u5bf9\u4e8e\u4e00\u4e9b\u7279\u5b9a\u7c7b\u578b\u7684\u5e94\u7528\uff0c\u8fd9\u4e9b\u7cfb\u7edf\u63d0\u4f9b\u4e86\u4e00\u4e2a\u53d7\u9650\u7684\u901a\u4fe1\u6a21\u578b\u3002\u76f8\u6bd4\u4e4b\u4e0b\uff0cRDD\u5219\u4e3a\u57fa\u4e8e\u5de5\u4f5c\u96c6\u7684\u5e94\u7528\u63d0\u4f9b\u4e86\u66f4\u4e3a\u901a\u7528\u7684\u62bd\u8c61\uff0c\u7528\u6237\u53ef\u4ee5\u5bf9\u4e2d\u95f4\u7ed3\u679c\u8fdb\u884c\u663e\u5f0f\u7684\u547d\u540d\u548c\u7269\u5316\uff0c\u63a7\u5236\u5176\u5206\u533a\uff0c\u8fd8\u80fd\u6267\u884c\u7528\u6237\u9009\u62e9\u7684\u7279\u5b9a\u64cd\u4f5c\uff08\u800c\u4e0d\u662f\u5728\u8fd0\u884c\u65f6\u53bb\u5faa\u73af\u6267\u884c\u4e00\u7cfb\u5217MapReduce\u6b65\u9aa4\uff09\u3002RDD\u53ef\u4ee5\u7528\u6765\u63cf\u8ff0Pregel\u3001\u8fed\u4ee3\u5f0fMapReduce\uff0c\u4ee5\u53ca\u8fd9\u4e24\u79cd\u6a21\u578b\u65e0\u6cd5\u63cf\u8ff0\u7684\u5176\u4ed6\u5e94\u7528\uff0c\u5982\u4ea4\u4e92\u5f0f\u6570\u636e\u6316\u6398\u5de5\u5177\uff08\u7528\u6237\u5c06\u6570\u636e\u96c6\u88c5\u5165\u5185\u5b58\uff0c\u7136\u540e\u6267\u884cad-hoc\u67e5\u8be2\uff09\u3002</p>\u000a<p>Spark\u662f\u6211\u4eec\u5b9e\u73b0\u7684RDD\u7cfb\u7edf\uff0c\u5728\u6211\u4eec\u5185\u90e8\u80fd\u591f\u88ab\u7528\u4e8e\u5f00\u53d1\u591a\u79cd\u5e76\u884c\u5e94\u7528\u3002Spark\u91c7\u7528Scala\u8bed\u8a00[5]\u5b9e\u73b0\uff0c\u63d0\u4f9b\u7c7b\u4f3c\u4e8eDryadLINQ\u7684\u96c6\u6210\u8bed\u8a00\u7f16\u7a0b\u63a5\u53e3[34]\uff0c\u4f7f\u7528\u6237\u53ef\u4ee5\u975e\u5e38\u5bb9\u6613\u5730\u7f16\u5199\u5e76\u884c\u4efb\u52a1\u3002\u6b64\u5916\uff0c\u968f\u7740Scala\u65b0\u7248\u672c\u89e3\u91ca\u5668\u7684\u5b8c\u5584\uff0cSpark\u8fd8\u80fd\u591f\u7528\u4e8e\u4ea4\u4e92\u5f0f\u67e5\u8be2\u5927\u6570\u636e\u96c6\u3002\u6211\u4eec\u76f8\u4fe1Spark\u4f1a\u662f\u7b2c\u4e00\u4e2a\u80fd\u591f\u4f7f\u7528\u6709\u6548\u3001\u901a\u7528\u7f16\u7a0b\u8bed\u8a00\uff0c\u5e76\u5728\u96c6\u7fa4\u4e0a\u5bf9\u5927\u6570\u636e\u96c6\u8fdb\u884c\u4ea4\u4e92\u5f0f\u5206\u6790\u7684\u7cfb\u7edf\u3002</p>\u000a<p>\u6211\u4eec\u901a\u8fc7\u5fae\u57fa\u51c6\u548c\u7528\u6237\u5e94\u7528\u7a0b\u5e8f\u6765\u8bc4\u4f30RDD\u3002\u5b9e\u9a8c\u8868\u660e\uff0c\u5728\u5904\u7406\u8fed\u4ee3\u5f0f\u5e94\u7528\u4e0aSpark\u6bd4Hadoop\u5feb\u9ad8\u8fbe20\u591a\u500d\uff0c\u8ba1\u7b97\u6570\u636e\u5206\u6790\u7c7b\u62a5\u8868\u7684\u6027\u80fd\u63d0\u9ad8\u4e8640\u591a\u500d\uff0c\u540c\u65f6\u80fd\u591f\u57285-7\u79d2\u7684\u5ef6\u65f6\u5185\u4ea4\u4e92\u5f0f\u626b\u63cf1TB\u6570\u636e\u96c6\u3002\u6b64\u5916\uff0c\u6211\u4eec\u8fd8\u5728Spark\u4e4b\u4e0a\u5b9e\u73b0\u4e86Pregel\u548cHaLoop\u7f16\u7a0b\u6a21\u578b\uff08\u5305\u62ec\u5176\u4f4d\u7f6e\u4f18\u5316\u7b56\u7565\uff09\uff0c\u4ee5\u5e93\u7684\u5f62\u5f0f\u5b9e\u73b0\uff08\u5206\u522b\u4f7f\u7528\u4e86100\u548c200\u884cScala\u4ee3\u7801\uff09\u3002\u6700\u540e\uff0c\u5229\u7528RDD\u5185\u5728\u7684\u786e\u5b9a\u6027\u7279\u6027\uff0c\u6211\u4eec\u8fd8\u521b\u5efa\u4e86\u4e00\u79cdSpark\u8c03\u8bd5\u5de5\u5177rddbg\uff0c\u5141\u8bb8\u7528\u6237\u5728\u4efb\u52a1\u671f\u95f4\u5229\u7528Lineage\u91cd\u5efaRDD\uff0c\u7136\u540e\u50cf\u4f20\u7edf\u8c03\u8bd5\u5668\u90a3\u6837\u91cd\u65b0\u6267\u884c\u4efb\u52a1\u3002</p>\u000a<p>\u672c\u6587\u9996\u5148\u5728\u7b2c2\u90e8\u5206\u4ecb\u7ecd\u4e86RDD\u7684\u6982\u5ff5\uff0c\u7136\u540e\u7b2c3\u90e8\u5206\u63cf\u8ff0Spark API\uff0c\u7b2c4\u90e8\u5206\u89e3\u91ca\u5982\u4f55\u4f7f\u7528RDD\u8868\u793a\u51e0\u79cd\u5e76\u884c\u5e94\u7528\uff08\u5305\u62ecPregel\u548cHaLoop\uff09\uff0c\u7b2c5\u90e8\u5206\u8ba8\u8bbaSpark\u4e2dRDD\u7684\u8868\u793a\u65b9\u6cd5\u4ee5\u53ca\u4efb\u52a1\u8c03\u5ea6\u5668\uff0c\u7b2c6\u90e8\u5206\u63cf\u8ff0\u5177\u4f53\u5b9e\u73b0\u548crddbg\uff0c\u7b2c7\u90e8\u5206\u5bf9RDD\u8fdb\u884c\u8bc4\u4f30\uff0c\u7b2c8\u90e8\u5206\u7ed9\u51fa\u4e86\u76f8\u5173\u7814\u7a76\u5de5\u4f5c\uff0c\u6700\u540e\u7b2c9\u90e8\u5206\u603b\u7ed3\u3002</p>\u000a<h2>2.\u5f39\u6027\u5206\u5e03\u5f0f\u6570\u636e\u96c6\uff08RDD\uff09</h2>\u000a<p>\u672c\u90e8\u5206\u63cf\u8ff0RDD\u548c\u7f16\u7a0b\u6a21\u578b\u3002\u9996\u5148\u8ba8\u8bba\u8bbe\u8ba1\u76ee\u6807\uff082.1\uff09\uff0c\u7136\u540e\u5b9a\u4e49RDD\uff082.2\uff09\uff0c\u8ba8\u8bbaSpark\u7684\u7f16\u7a0b\u6a21\u578b\uff082.3\uff09\uff0c\u5e76\u7ed9\u51fa\u4e00\u4e2a\u793a\u4f8b\uff082.4\uff09\uff0c\u6700\u540e\u5bf9\u6bd4RDD\u4e0e\u5206\u5e03\u5f0f\u5171\u4eab\u5185\u5b58\uff082.5\uff09\u3002</p>\u000a<h3>2.1 \u76ee\u6807\u548c\u6982\u8ff0</h3>\u000a<p>\u6211\u4eec\u7684\u76ee\u6807\u662f\u4e3a\u57fa\u4e8e\u5de5\u4f5c\u96c6\u7684\u5e94\u7528\uff08\u5373\u591a\u4e2a\u5e76\u884c\u64cd\u4f5c\u91cd\u7528\u4e2d\u95f4\u7ed3\u679c\u7684\u8fd9\u7c7b\u5e94\u7528\uff09\u63d0\u4f9b\u62bd\u8c61\uff0c\u540c\u65f6\u4fdd\u6301MapReduce\u53ca\u5176\u76f8\u5173\u6a21\u578b\u7684\u4f18\u52bf\u7279\u6027\uff1a\u5373\u81ea\u52a8\u5bb9\u9519\u3001\u4f4d\u7f6e\u611f\u77e5\u6027\u8c03\u5ea6\u548c\u53ef\u4f38\u7f29\u6027\u3002RDD\u6bd4\u6570\u636e\u6d41\u6a21\u578b\u66f4\u6613\u4e8e\u7f16\u7a0b\uff0c\u540c\u65f6\u57fa\u4e8e\u5de5\u4f5c\u96c6\u7684\u8ba1\u7b97\u4e5f\u5177\u6709\u826f\u597d\u7684\u63cf\u8ff0\u80fd\u529b\u3002</p>\u000a<p>\u5728\u8fd9\u4e9b\u7279\u6027\u4e2d\uff0c\u6700\u96be\u5b9e\u73b0\u7684\u662f\u5bb9\u9519\u6027\u3002\u4e00\u822c\u6765\u8bf4\uff0c\u5206\u5e03\u5f0f\u6570\u636e\u96c6\u7684\u5bb9\u9519\u6027\u6709\u4e24\u79cd\u65b9\u5f0f\uff1a\u5373\u6570\u636e\u68c0\u67e5\u70b9\u548c\u8bb0\u5f55\u6570\u636e\u7684\u66f4\u65b0\u3002\u6211\u4eec\u9762\u5411\u7684\u662f\u5927\u89c4\u6a21\u6570\u636e\u5206\u6790\uff0c\u6570\u636e\u68c0\u67e5\u70b9\u64cd\u4f5c\u6210\u672c\u5f88\u9ad8\uff1a\u9700\u8981\u901a\u8fc7\u6570\u636e\u4e2d\u5fc3\u7684\u7f51\u7edc\u8fde\u63a5\u5728\u673a\u5668\u4e4b\u95f4\u590d\u5236\u5e9e\u5927\u7684\u6570\u636e\u96c6\uff0c\u800c\u7f51\u7edc\u5e26\u5bbd\u5f80\u5f80\u6bd4\u5185\u5b58\u5e26\u5bbd\u4f4e\u5f97\u591a\uff0c\u540c\u65f6\u8fd8\u9700\u8981\u6d88\u8017\u66f4\u591a\u7684\u5b58\u50a8\u8d44\u6e90\uff08\u5728\u5185\u5b58\u4e2d\u590d\u5236\u6570\u636e\u53ef\u4ee5\u51cf\u5c11\u9700\u8981\u7f13\u5b58\u7684\u6570\u636e\u91cf\uff0c\u800c\u5b58\u50a8\u5230\u78c1\u76d8\u5219\u4f1a\u62d6\u6162\u5e94\u7528\u7a0b\u5e8f\uff09\u3002\u6240\u4ee5\uff0c\u6211\u4eec\u9009\u62e9\u8bb0\u5f55\u66f4\u65b0\u7684\u65b9\u5f0f\u3002\u4f46\u662f\uff0c\u5982\u679c\u66f4\u65b0\u592a\u591a\uff0c\u90a3\u4e48\u8bb0\u5f55\u66f4\u65b0\u6210\u672c\u4e5f\u4e0d\u4f4e\u3002\u56e0\u6b64\uff0cRDD\u53ea\u652f\u6301\u7c97\u7c92\u5ea6\u8f6c\u6362\uff0c\u5373\u5728\u5927\u91cf\u8bb0\u5f55\u4e0a\u6267\u884c\u7684\u5355\u4e2a\u64cd\u4f5c\u3002\u5c06\u521b\u5efaRDD\u7684\u4e00\u7cfb\u5217\u8f6c\u6362\u8bb0\u5f55\u4e0b\u6765\uff08\u5373Lineage\uff09\uff0c\u4ee5\u4fbf\u6062\u590d\u4e22\u5931\u7684\u5206\u533a\u3002</p>\u000a<p>\u867d\u7136\u53ea\u652f\u6301\u7c97\u7c92\u5ea6\u8f6c\u6362\u9650\u5236\u4e86\u7f16\u7a0b\u6a21\u578b\uff0c\u4f46\u6211\u4eec\u53d1\u73b0RDD\u4ecd\u7136\u53ef\u4ee5\u5f88\u597d\u5730\u9002\u7528\u4e8e\u5f88\u591a\u5e94\u7528\uff0c\u7279\u522b\u662f\u652f\u6301\u6570\u636e\u5e76\u884c\u7684\u6279\u91cf\u5206\u6790\u5e94\u7528\uff0c\u5305\u62ec\u6570\u636e\u6316\u6398\u3001\u673a\u5668\u5b66\u4e60\u3001\u56fe\u7b97\u6cd5\u7b49\uff0c\u56e0\u4e3a\u8fd9\u4e9b\u7a0b\u5e8f\u901a\u5e38\u90fd\u4f1a\u5728\u5f88\u591a\u8bb0\u5f55\u4e0a\u6267\u884c\u76f8\u540c\u7684\u64cd\u4f5c\u3002RDD\u4e0d\u592a\u9002\u5408\u90a3\u4e9b\u5f02\u6b65\u66f4\u65b0\u5171\u4eab\u72b6\u6001\u7684\u5e94\u7528\uff0c\u4f8b\u5982\u5e76\u884cweb\u722c\u884c\u5668\u3002\u56e0\u6b64\uff0c\u6211\u4eec\u7684\u76ee\u6807\u662f\u4e3a\u5927\u591a\u6570\u5206\u6790\u578b\u5e94\u7528\u63d0\u4f9b\u6709\u6548\u7684\u7f16\u7a0b\u6a21\u578b\uff0c\u800c\u5176\u4ed6\u7c7b\u578b\u7684\u5e94\u7528\u4ea4\u7ed9\u4e13\u95e8\u7684\u7cfb\u7edf\u3002</p>\u000a<h3>2.2 RDD\u62bd\u8c61</h3>\u000a<p>RDD\u662f\u53ea\u8bfb\u7684\u3001\u5206\u533a\u8bb0\u5f55\u7684\u96c6\u5408\u3002RDD\u53ea\u80fd\u57fa\u4e8e\u5728\u7a33\u5b9a\u7269\u7406\u5b58\u50a8\u4e2d\u7684\u6570\u636e\u96c6\u548c\u5176\u4ed6\u5df2\u6709\u7684RDD\u4e0a\u6267\u884c\u786e\u5b9a\u6027\u64cd\u4f5c\u6765\u521b\u5efa\u3002\u8fd9\u4e9b\u786e\u5b9a\u6027\u64cd\u4f5c\u79f0\u4e4b\u4e3a\u8f6c\u6362\uff0c\u5982map\u3001filter\u3001groupBy\u3001join\uff08\u8f6c\u6362\u4e0d\u662f\u7a0b\u5f00\u53d1\u4eba\u5458\u5728RDD\u4e0a\u6267\u884c\u7684\u64cd\u4f5c\uff09\u3002</p>\u000a<p>RDD\u4e0d\u9700\u8981\u7269\u5316\u3002RDD\u542b\u6709\u5982\u4f55\u4ece\u5176\u4ed6RDD\u884d\u751f\uff08\u5373\u8ba1\u7b97\uff09\u51fa\u672cRDD\u7684\u76f8\u5173\u4fe1\u606f\uff08\u5373Lineage\uff09\uff0c\u636e\u6b64\u53ef\u4ee5\u4ece\u7269\u7406\u5b58\u50a8\u7684\u6570\u636e\u8ba1\u7b97\u51fa\u76f8\u5e94\u7684RDD\u5206\u533a\u3002</p>\u000a<h3>2.3 \u7f16\u7a0b\u6a21\u578b</h3>\u000a<p>\u5728Spark\u4e2d\uff0cRDD\u88ab\u8868\u793a\u4e3a\u5bf9\u8c61\uff0c\u901a\u8fc7\u8fd9\u4e9b\u5bf9\u8c61\u4e0a\u7684\u65b9\u6cd5\uff08\u6216\u51fd\u6570\uff09\u8c03\u7528\u8f6c\u6362\u3002</p>\u000a<p>\u5b9a\u4e49RDD\u4e4b\u540e\uff0c\u7a0b\u5e8f\u5458\u5c31\u53ef\u4ee5\u5728\u52a8\u4f5c\u4e2d\u4f7f\u7528RDD\u4e86\u3002\u52a8\u4f5c\u662f\u5411\u5e94\u7528\u7a0b\u5e8f\u8fd4\u56de\u503c\uff0c\u6216\u5411\u5b58\u50a8\u7cfb\u7edf\u5bfc\u51fa\u6570\u636e\u7684\u90a3\u4e9b\u64cd\u4f5c\uff0c\u4f8b\u5982\uff0ccount\uff08\u8fd4\u56deRDD\u4e2d\u7684\u5143\u7d20\u4e2a\u6570\uff09\uff0ccollect\uff08\u8fd4\u56de\u5143\u7d20\u672c\u8eab\uff09\uff0csave\uff08\u5c06RDD\u8f93\u51fa\u5230\u5b58\u50a8\u7cfb\u7edf\uff09\u3002\u5728Spark\u4e2d\uff0c\u53ea\u6709\u5728\u52a8\u4f5c\u7b2c\u4e00\u6b21\u4f7f\u7528RDD\u65f6\uff0c\u624d\u4f1a\u8ba1\u7b97RDD\uff08\u5373\u5ef6\u8fdf\u8ba1\u7b97\uff09\u3002\u8fd9\u6837\u5728\u6784\u5efaRDD\u7684\u65f6\u5019\uff0c\u8fd0\u884c\u65f6\u901a\u8fc7\u7ba1\u9053\u7684\u65b9\u5f0f\u4f20\u8f93\u591a\u4e2a\u8f6c\u6362\u3002</p>\u000a<p>\u7a0b\u5e8f\u5458\u8fd8\u53ef\u4ee5\u4ece\u4e24\u4e2a\u65b9\u9762\u63a7\u5236RDD\uff0c\u5373\u7f13\u5b58\u548c\u5206\u533a\u3002\u7528\u6237\u53ef\u4ee5\u8bf7\u6c42\u5c06RDD\u7f13\u5b58\uff0c\u8fd9\u6837\u8fd0\u884c\u65f6\u5c06\u5df2\u7ecf\u8ba1\u7b97\u597d\u7684RDD\u5206\u533a\u5b58\u50a8\u8d77\u6765\uff0c\u4ee5\u52a0\u901f\u540e\u671f\u7684\u91cd\u7528\u3002\u7f13\u5b58\u7684RDD\u4e00\u822c\u5b58\u50a8\u5728\u5185\u5b58\u4e2d\uff0c\u4f46\u5982\u679c\u5185\u5b58\u4e0d\u591f\uff0c\u53ef\u4ee5\u5199\u5230\u78c1\u76d8\u4e0a\u3002</p>\u000a<p>\u53e6\u4e00\u65b9\u9762\uff0cRDD\u8fd8\u5141\u8bb8\u7528\u6237\u6839\u636e\u5173\u952e\u5b57\uff08key\uff09\u6307\u5b9a\u5206\u533a\u987a\u5e8f\uff0c\u8fd9\u662f\u4e00\u4e2a\u53ef\u9009\u7684\u529f\u80fd\u3002\u76ee\u524d\u652f\u6301\u54c8\u5e0c\u5206\u533a\u548c\u8303\u56f4\u5206\u533a\u3002\u4f8b\u5982\uff0c\u5e94\u7528\u7a0b\u5e8f\u8bf7\u6c42\u5c06\u4e24\u4e2aRDD\u6309\u7167\u540c\u6837\u7684\u54c8\u5e0c\u5206\u533a\u65b9\u5f0f\u8fdb\u884c\u5206\u533a\uff08\u5c06\u540c\u4e00\u673a\u5668\u4e0a\u5177\u6709\u76f8\u540c\u5173\u952e\u5b57\u7684\u8bb0\u5f55\u653e\u5728\u4e00\u4e2a\u5206\u533a\uff09\uff0c\u4ee5\u52a0\u901f\u5b83\u4eec\u4e4b\u95f4\u7684join\u64cd\u4f5c\u3002\u5728Pregel\u548cHaLoop\u4e2d\uff0c\u591a\u6b21\u8fed\u4ee3\u4e4b\u95f4\u91c7\u7528\u4e00\u81f4\u6027\u7684\u5206\u533a\u7f6e\u6362\u7b56\u7565\u8fdb\u884c\u4f18\u5316\uff0c\u6211\u4eec\u540c\u6837\u4e5f\u5141\u8bb8\u7528\u6237\u6307\u5b9a\u8fd9\u79cd\u4f18\u5316\u3002</p>\u000a<h3>2.4 \u793a\u4f8b\uff1a\u63a7\u5236\u53f0\u65e5\u5fd7\u6316\u6398</h3>\u000a<p>\u672c\u90e8\u5206\u6211\u4eec\u901a\u8fc7\u4e00\u4e2a\u5177\u4f53\u793a\u4f8b\u6765\u9610\u8ff0RDD\u3002\u5047\u5b9a\u6709\u4e00\u4e2a\u5927\u578b\u7f51\u7ad9\u51fa\u9519\uff0c\u64cd\u4f5c\u5458\u60f3\u8981\u68c0\u67e5Hadoop\u6587\u4ef6\u7cfb\u7edf\uff08HDFS\uff09\u4e2d\u7684\u65e5\u5fd7\u6587\u4ef6\uff08TB\u7ea7\u5927\u5c0f\uff09\u6765\u627e\u51fa\u539f\u56e0\u3002\u901a\u8fc7\u4f7f\u7528Spark\uff0c\u64cd\u4f5c\u5458\u53ea\u9700\u5c06\u65e5\u5fd7\u4e2d\u7684\u9519\u8bef\u4fe1\u606f\u88c5\u8f7d\u5230\u4e00\u7ec4\u8282\u70b9\u7684\u5185\u5b58\u4e2d\uff0c\u7136\u540e\u6267\u884c\u4ea4\u4e92\u5f0f\u67e5\u8be2\u3002\u9996\u5148\uff0c\u9700\u8981\u5728Spark\u89e3\u91ca\u5668\u4e2d\u8f93\u5165\u5982\u4e0bScala\u547d\u4ee4\uff1a</p>\u000a<pre class="brush: scala; title: ; notranslate" title="">\u000alines = spark.textFile(&quot;hdfs://...&quot;)\u000aerrors = lines.filter(_.startsWith(&quot;ERROR&quot;))\u000aerrors.cache()\u000a</pre>\u000a<p>\u7b2c1\u884c\u4eceHDFS\u6587\u4ef6\u5b9a\u4e49\u4e86\u4e00\u4e2aRDD\uff08\u5373\u4e00\u4e2a\u6587\u672c\u884c\u96c6\u5408\uff09\uff0c\u7b2c2\u884c\u83b7\u5f97\u4e00\u4e2a\u8fc7\u6ee4\u540e\u7684RDD\uff0c\u7b2c3\u884c\u8bf7\u6c42\u5c06errors\u7f13\u5b58\u8d77\u6765\u3002\u6ce8\u610f\u5728Scala\u8bed\u6cd5\u4e2dfilter\u7684\u53c2\u6570\u662f\u4e00\u4e2a\u95ed\u5305\u3002</p>\u000a<p>\u8fd9\u65f6\u96c6\u7fa4\u8fd8\u6ca1\u6709\u5f00\u59cb\u6267\u884c\u4efb\u4f55\u4efb\u52a1\u3002\u4f46\u662f\uff0c\u7528\u6237\u5df2\u7ecf\u53ef\u4ee5\u5728\u8fd9\u4e2aRDD\u4e0a\u6267\u884c\u5bf9\u5e94\u7684\u52a8\u4f5c\uff0c\u4f8b\u5982\u7edf\u8ba1\u9519\u8bef\u6d88\u606f\u7684\u6570\u76ee\uff1a</p>\u000a<pre class="brush: scala; title: ; notranslate" title="">\u000a	errors.count()\u000a</pre>\u000a<p>\u7528\u6237\u8fd8\u53ef\u4ee5\u5728RDD\u4e0a\u6267\u884c\u66f4\u591a\u7684\u8f6c\u6362\u64cd\u4f5c\uff0c\u5e76\u4f7f\u7528\u8f6c\u6362\u7ed3\u679c\uff0c\u5982\uff1a</p>\u000a<pre class="brush: scala; title: ; notranslate" title="">\u000a// Count errors mentioning MySQL:\u000aerrors.filter(_.contains(&quot;MySQL&quot;)).count()\u000a// Return the time fields of errors mentioning\u000a// HDFS as an array (assuming time is field\u000a// number 3 in a tab-separated format):\u000aerrors.filter(_.contains(&quot;HDFS&quot;))\u000a	.map(_.split('\u005ct')(3))\u000a	.collect()\u000a</pre>\u000a<p>\u4f7f\u7528errors\u7684\u7b2c\u4e00\u4e2aaction\u8fd0\u884c\u4ee5\u540e\uff0cSpark\u4f1a\u628aerrors\u7684\u5206\u533a\u7f13\u5b58\u5728\u5185\u5b58\u4e2d\uff0c\u6781\u5927\u5730\u52a0\u5feb\u4e86\u540e\u7eed\u8ba1\u7b97\u901f\u5ea6\u3002\u6ce8\u610f\uff0c\u6700\u521d\u7684RDD lines\u4e0d\u4f1a\u88ab\u7f13\u5b58\u3002\u56e0\u4e3a\u9519\u8bef\u4fe1\u606f\u53ef\u80fd\u53ea\u5360\u539f\u6570\u636e\u96c6\u7684\u5f88\u5c0f\u4e00\u90e8\u5206\uff08\u5c0f\u5230\u8db3\u4ee5\u653e\u5165\u5185\u5b58\uff09\u3002<br />\u000a\u6700\u540e\uff0c\u4e3a\u4e86\u8bf4\u660e\u6a21\u578b\u7684\u5bb9\u9519\u6027\uff0c\u56fe1\u7ed9\u51fa\u4e86\u7b2c3\u4e2a\u67e5\u8be2\u7684Lineage\u56fe\u3002\u5728lines RDD\u4e0a\u6267\u884cfilter\u64cd\u4f5c\uff0c\u5f97\u5230errors\uff0c\u7136\u540e\u518dfilter\u3001map\u540e\u5f97\u5230\u65b0\u7684RDD\uff0c\u5728\u8fd9\u4e2aRDD\u4e0a\u6267\u884ccollect\u64cd\u4f5c\u3002Spark\u8c03\u5ea6\u5668\u4ee5\u6d41\u6c34\u7ebf\u7684\u65b9\u5f0f\u6267\u884c\u540e\u4e24\u4e2a\u8f6c\u6362\uff0c\u5411\u62e5\u6709errors\u5206\u533a\u7f13\u5b58\u7684\u8282\u70b9\u53d1\u9001\u4e00\u7ec4\u4efb\u52a1\u3002\u6b64\u5916\uff0c\u5982\u679c\u67d0\u4e2aerrors\u5206\u533a\u4e22\u5931\uff0cSpark\u53ea\u5728\u76f8\u5e94\u7684lines\u5206\u533a\u4e0a\u6267\u884cfilter\u64cd\u4f5c\u6765\u91cd\u5efa\u8be5errors\u5206\u533a\u3002<br />\u000a<img class="alignnone size-full wp-image-748" alt="f1-lineage" src="http://shiyanjuncn.b0.upaiyun.com/wp-content/uploads/2014/03/f1-lineage.png" width="406" height="242" /><br />\u000a<span style="font-size: small;text-indent: 20px"><strong>\u56fe1</strong> \u793a\u4f8b\u4e2d\u7b2c\u4e09\u4e2a\u67e5\u8be2\u7684Lineage\u56fe\u3002\uff08\u65b9\u6846\u8868\u793aRDD\uff0c\u7bad\u5934\u8868\u793a\u8f6c\u6362\uff09</span></p>\u000a<h3>2.5 RDD\u4e0e\u5206\u5e03\u5f0f\u5171\u4eab\u5185\u5b58</h3>\u000a<p>\u4e3a\u4e86\u8fdb\u4e00\u6b65\u7406\u89e3RDD\u662f\u4e00\u79cd\u5206\u5e03\u5f0f\u7684\u5185\u5b58\u62bd\u8c61\uff0c\u88681\u5217\u51fa\u4e86RDD\u4e0e\u5206\u5e03\u5f0f\u5171\u4eab\u5185\u5b58\uff08DSM\uff0cDistributed Shared Memory\uff09[24]\u7684\u5bf9\u6bd4\u3002\u5728DSM\u7cfb\u7edf\u4e2d\uff0c\u5e94\u7528\u53ef\u4ee5\u5411\u5168\u5c40\u5730\u5740\u7a7a\u95f4\u7684\u4efb\u610f\u4f4d\u7f6e\u8fdb\u884c\u8bfb\u5199\u64cd\u4f5c\u3002\uff08\u6ce8\u610f\u8fd9\u91cc\u7684DSM\uff0c\u4e0d\u4ec5\u6307\u4f20\u7edf\u7684\u5171\u4eab\u5185\u5b58\u7cfb\u7edf\uff0c\u8fd8\u5305\u62ec\u90a3\u4e9b\u901a\u8fc7\u5206\u5e03\u5f0f\u54c8\u5e0c\u8868\u6216\u5206\u5e03\u5f0f\u6587\u4ef6\u7cfb\u7edf\u8fdb\u884c\u6570\u636e\u5171\u4eab\u7684\u7cfb\u7edf\uff0c\u6bd4\u5982Piccolo[28]\uff09DSM\u662f\u4e00\u79cd\u901a\u7528\u7684\u62bd\u8c61\uff0c\u4f46\u8fd9\u79cd\u901a\u7528\u6027\u540c\u65f6\u4e5f\u4f7f\u5f97\u5728\u5546\u7528\u96c6\u7fa4\u4e0a\u5b9e\u73b0\u6709\u6548\u7684\u5bb9\u9519\u6027\u66f4\u52a0\u56f0\u96be\u3002</p>\u000a<p>RDD\u4e0eDSM\u4e3b\u8981\u533a\u522b\u5728\u4e8e\uff0c\u4e0d\u4ec5\u53ef\u4ee5\u901a\u8fc7\u6279\u91cf\u8f6c\u6362\u521b\u5efa\uff08\u5373\u201c\u5199\u201d\uff09RDD\uff0c\u8fd8\u53ef\u4ee5\u5bf9\u4efb\u610f\u5185\u5b58\u4f4d\u7f6e\u8bfb\u5199\u3002\u4e5f\u5c31\u662f\u8bf4\uff0cRDD\u9650\u5236\u5e94\u7528\u6267\u884c\u6279\u91cf\u5199\u64cd\u4f5c\uff0c\u8fd9\u6837\u6709\u5229\u4e8e\u5b9e\u73b0\u6709\u6548\u7684\u5bb9\u9519\u3002\u7279\u522b\u5730\uff0cRDD\u6ca1\u6709\u68c0\u67e5\u70b9\u5f00\u9500\uff0c\u56e0\u4e3a\u53ef\u4ee5\u4f7f\u7528Lineage\u6765\u6062\u590dRDD\u3002\u800c\u4e14\uff0c\u5931\u6548\u65f6\u53ea\u9700\u8981\u91cd\u65b0\u8ba1\u7b97\u4e22\u5931\u7684\u90a3\u4e9bRDD\u5206\u533a\uff0c\u53ef\u4ee5\u5728\u4e0d\u540c\u8282\u70b9\u4e0a\u5e76\u884c\u6267\u884c\uff0c\u800c\u4e0d\u9700\u8981\u56de\u6eda\u6574\u4e2a\u7a0b\u5e8f\u3002</p>\u000a<table style="border: solid thin #868686" width="100%" border="1" cellspacing="0" cellpadding="2">\u000a<caption style="text-align:center"><strong>\u88681</strong> RDD\u4e0eDSM\u5bf9\u6bd4</caption>\u000a<tbody>\u000a<tr>\u000a<td style="width: 68.62px;text-align: center;border: solid thin #868686" valign="top"><b>\u5bf9\u6bd4\u9879\u76ee</b></td>\u000a<td style="width: 60.21px;text-align: center;border: solid thin #868686" valign="top"><b>RDD</b></td>\u000a<td style="width: 60.21px;text-align: center;border: solid thin #868686" valign="top"><b>\u5206\u5e03\u5f0f\u5171\u4eab\u5185\u5b58\uff08DSM\uff09</b></td>\u000a</tr>\u000a<tr>\u000a<td style="width: 68.62px;border: solid thin #868686" valign="top">\u8bfb</td>\u000a<td style="width: 60.21px;border: solid thin #868686" valign="top">\u6279\u91cf\u6216\u7ec6\u7c92\u5ea6\u64cd\u4f5c</td>\u000a<td style="width: 60.21px;border: solid thin #868686" valign="top">\u7ec6\u7c92\u5ea6\u64cd\u4f5c</td>\u000a</tr>\u000a<tr>\u000a<td style="width: 68.62px;border: solid thin #868686" valign="top">\u5199</td>\u000a<td style="width: 60.21px;border: solid thin #868686" valign="top">\u6279\u91cf\u8f6c\u6362\u64cd\u4f5c</td>\u000a<td style="width: 60.21px;border: solid thin #868686" valign="top">\u7ec6\u7c92\u5ea6\u64cd\u4f5c</td>\u000a</tr>\u000a<tr>\u000a<td style="width: 68.62px;border: solid thin #868686" valign="top">\u4e00\u81f4\u6027</td>\u000a<td style="width: 60.21px;border: solid thin #868686" valign="top">\u4e0d\u91cd\u8981\uff08RDD\u662f\u4e0d\u53ef\u66f4\u6539\u7684\uff09</td>\u000a<td style="width: 60.21px;border: solid thin #868686" valign="top">\u53d6\u51b3\u4e8e\u5e94\u7528\u7a0b\u5e8f\u6216\u8fd0\u884c\u65f6</td>\u000a</tr>\u000a<tr>\u000a<td style="width: 68.62px;border: solid thin #868686" valign="top">\u5bb9\u9519\u6027</td>\u000a<td style="width: 60.21px;border: solid thin #868686" valign="top">\u7ec6\u7c92\u5ea6\uff0c\u4f4e\u5f00\u9500\uff08\u4f7f\u7528Lineage\uff09</td>\u000a<td style="width: 60.21px;border: solid thin #868686" valign="top">\u9700\u8981\u68c0\u67e5\u70b9\u64cd\u4f5c\u548c\u7a0b\u5e8f\u56de\u6eda</td>\u000a</tr>\u000a<tr>\u000a<td style="width: 68.62px;border: solid thin #868686" valign="top">\u843d\u540e\u4efb\u52a1\u7684\u5904\u7406</td>\u000a<td style="width: 60.21px;border: solid thin #868686" valign="top">\u4efb\u52a1\u5907\u4efd</td>\u000a<td style="width: 60.21px;border: solid thin #868686" valign="top">\u5f88\u96be\u5904\u7406</td>\u000a</tr>\u000a<tr>\u000a<td style="width: 68.62px;border: solid thin #868686" valign="top">\u4efb\u52a1\u5b89\u6392</td>\u000a<td style="width: 60.21px;border: solid thin #868686" valign="top">\u57fa\u4e8e\u6570\u636e\u5b58\u653e\u7684\u4f4d\u7f6e\u81ea\u52a8\u5b9e\u73b0</td>\u000a<td style="width: 60.21px;border: solid thin #868686" valign="top">\u53d6\u51b3\u4e8e\u5e94\u7528\u7a0b\u5e8f\uff08\u901a\u8fc7\u8fd0\u884c\u65f6\u5b9e\u73b0\u900f\u660e\u6027\uff09</td>\u000a</tr>\u000a<tr>\u000a<td style="width: 68.62px;border: solid thin #868686" valign="top">\u5982\u679c\u5185\u5b58\u4e0d\u591f</td>\u000a<td style="width: 60.21px;border: solid thin #868686" valign="top">\u4e0e\u5df2\u6709\u7684\u6570\u636e\u6d41\u7cfb\u7edf\u7c7b\u4f3c</td>\u000a<td style="width: 60.21px;border: solid thin #868686" valign="top">\u6027\u80fd\u8f83\u5dee\uff08\u4ea4\u6362\uff1f\uff09</td>\u000a</tr>\u000a</tbody>\u000a</table>\u000a<p>\u6ce8\u610f\uff0c\u901a\u8fc7\u5907\u4efd\u4efb\u52a1\u7684\u62f7\u8d1d\uff0cRDD\u8fd8\u53ef\u4ee5\u5904\u7406\u843d\u540e\u4efb\u52a1\uff08\u5373\u8fd0\u884c\u5f88\u6162\u7684\u8282\u70b9\uff09\uff0c\u8fd9\u70b9\u4e0eMapReduce[12]\u7c7b\u4f3c\u3002\u800cDSM\u5219\u96be\u4ee5\u5b9e\u73b0\u5907\u4efd\u4efb\u52a1\uff0c\u56e0\u4e3a\u4efb\u52a1\u53ca\u5176\u526f\u672c\u90fd\u9700\u8981\u8bfb\u5199\u540c\u4e00\u4e2a\u5185\u5b58\u4f4d\u7f6e\u3002</p>\u000a<p>\u4e0eDSM\u76f8\u6bd4\uff0cRDD\u6a21\u578b\u6709\u4e24\u4e2a\u597d\u5904\u3002\u7b2c\u4e00\uff0c\u5bf9\u4e8eRDD\u4e2d\u7684\u6279\u91cf\u64cd\u4f5c\uff0c\u8fd0\u884c\u65f6\u5c06\u6839\u636e\u6570\u636e\u5b58\u653e\u7684\u4f4d\u7f6e\u6765\u8c03\u5ea6\u4efb\u52a1\uff0c\u4ece\u800c\u63d0\u9ad8\u6027\u80fd\u3002\u7b2c\u4e8c\uff0c\u5bf9\u4e8e\u57fa\u4e8e\u626b\u63cf\u7684\u64cd\u4f5c\uff0c\u5982\u679c\u5185\u5b58\u4e0d\u8db3\u4ee5\u7f13\u5b58\u6574\u4e2aRDD\uff0c\u5c31\u8fdb\u884c\u90e8\u5206\u7f13\u5b58\u3002\u628a\u5185\u5b58\u653e\u4e0d\u4e0b\u7684\u5206\u533a\u5b58\u50a8\u5230\u78c1\u76d8\u4e0a\uff0c\u6b64\u65f6\u6027\u80fd\u4e0e\u73b0\u6709\u7684\u6570\u636e\u6d41\u7cfb\u7edf\u5dee\u4e0d\u591a\u3002</p>\u000a<p>\u6700\u540e\u770b\u4e00\u4e0b\u8bfb\u64cd\u4f5c\u7684\u7c92\u5ea6\u3002RDD\u4e0a\u7684\u5f88\u591a\u52a8\u4f5c\uff08\u5982count\u548ccollect\uff09\u90fd\u662f\u6279\u91cf\u8bfb\u64cd\u4f5c\uff0c\u5373\u626b\u63cf\u6574\u4e2a\u6570\u636e\u96c6\uff0c\u53ef\u4ee5\u5c06\u4efb\u52a1\u5206\u914d\u5230\u8ddd\u79bb\u6570\u636e\u6700\u8fd1\u7684\u8282\u70b9\u4e0a\u3002\u540c\u65f6\uff0cRDD\u4e5f\u652f\u6301\u7ec6\u7c92\u5ea6\u64cd\u4f5c\uff0c\u5373\u5728\u54c8\u5e0c\u6216\u8303\u56f4\u5206\u533a\u7684RDD\u4e0a\u6267\u884c\u5173\u952e\u5b57\u67e5\u627e\u3002</p>\u000a<h2>3. Spark\u7f16\u7a0b\u63a5\u53e3</h2>\u000a<p>Spark\u7528Scala[5]\u8bed\u8a00\u5b9e\u73b0\u4e86RDD\u7684API\u3002Scala\u662f\u4e00\u79cd\u57fa\u4e8eJVM\u7684\u9759\u6001\u7c7b\u578b\u3001\u51fd\u6570\u5f0f\u3001\u9762\u5411\u5bf9\u8c61\u7684\u8bed\u8a00\u3002\u6211\u4eec\u9009\u62e9Scala\u662f\u56e0\u4e3a\u5b83\u7b80\u6d01\uff08\u7279\u522b\u9002\u5408\u4ea4\u4e92\u5f0f\u4f7f\u7528\uff09\u3001\u6709\u6548\uff08\u56e0\u4e3a\u662f\u9759\u6001\u7c7b\u578b\uff09\u3002\u4f46\u662f\uff0cRDD\u62bd\u8c61\u5e76\u4e0d\u5c40\u9650\u4e8e\u51fd\u6570\u5f0f\u8bed\u8a00\uff0c\u4e5f\u53ef\u4ee5\u4f7f\u7528\u5176\u4ed6\u8bed\u8a00\u6765\u5b9e\u73b0RDD\uff0c\u6bd4\u5982\u50cfHadoop[2]\u90a3\u6837\u7528\u7c7b\u8868\u793a\u7528\u6237\u51fd\u6570\u3002</p>\u000a<p>\u8981\u4f7f\u7528Spark\uff0c\u5f00\u53d1\u8005\u9700\u8981\u7f16\u5199\u4e00\u4e2adriver\u7a0b\u5e8f\uff0c\u8fde\u63a5\u5230\u96c6\u7fa4\u4ee5\u8fd0\u884cWorker\uff0c\u5982\u56fe2\u6240\u793a\u3002Driver\u5b9a\u4e49\u4e86\u4e00\u4e2a\u6216\u591a\u4e2aRDD\uff0c\u5e76\u8c03\u7528RDD\u4e0a\u7684\u52a8\u4f5c\u3002Worker\u662f\u957f\u65f6\u95f4\u8fd0\u884c\u7684\u8fdb\u7a0b\uff0c\u5c06RDD\u5206\u533a\u4ee5Java\u5bf9\u8c61\u7684\u5f62\u5f0f\u7f13\u5b58\u5728\u5185\u5b58\u4e2d\u3002<br />\u000a<img class="alignnone size-full wp-image-749" alt="f2-spark-runtime" src="http://shiyanjuncn.b0.upaiyun.com/wp-content/uploads/2014/03/f2-spark-runtime.png" width="440" height="267" /><br />\u000a<span style="font-size: small;text-indent: 20px"><strong>\u56fe2</strong> Spark\u7684\u8fd0\u884c\u65f6\u3002\u7528\u6237\u7684driver\u7a0b\u5e8f\u542f\u52a8\u591a\u4e2aworker\uff0cworker\u4ece\u5206\u5e03\u5f0f\u6587\u4ef6\u7cfb\u7edf\u4e2d\u8bfb\u53d6\u6570\u636e\u5757\uff0c\u5e76\u5c06\u8ba1\u7b97\u540e\u7684RDD\u5206\u533a\u7f13\u5b58\u5728\u5185\u5b58\u4e2d\u3002</span></p>\u000a<p>\u518d\u770b\u770b2.4\u4e2d\u7684\u4f8b\u5b50\uff0c\u7528\u6237\u6267\u884cRDD\u64cd\u4f5c\u65f6\u4f1a\u63d0\u4f9b\u53c2\u6570\uff0c\u6bd4\u5982map\u4f20\u9012\u4e00\u4e2a\u95ed\u5305\uff08closure\uff0c\u51fd\u6570\u5f0f\u7f16\u7a0b\u4e2d\u7684\u6982\u5ff5\uff09\u3002Scala\u5c06\u95ed\u5305\u8868\u793a\u4e3aJava\u5bf9\u8c61\uff0c\u5982\u679c\u4f20\u9012\u7684\u53c2\u6570\u662f\u95ed\u5305\uff0c\u5219\u8fd9\u4e9b\u5bf9\u8c61\u88ab\u5e8f\u5217\u5316\uff0c\u901a\u8fc7\u7f51\u7edc\u4f20\u8f93\u5230\u5176\u4ed6\u8282\u70b9\u4e0a\u8fdb\u884c\u88c5\u8f7d\u3002Scala\u5c06\u95ed\u5305\u5185\u7684\u53d8\u91cf\u4fdd\u5b58\u4e3aJava\u5bf9\u8c61\u7684\u5b57\u6bb5\u3002\u4f8b\u5982\uff0cvar x = 5; rdd.map(_ + x) \u8fd9\u6bb5\u4ee3\u7801\u5c06RDD\u4e2d\u7684\u6bcf\u4e2a\u5143\u7d20\u52a05\u3002\u603b\u7684\u6765\u8bf4\uff0cSpark\u7684\u8bed\u8a00\u96c6\u6210\u7c7b\u4f3c\u4e8eDryadLINQ\u3002</p>\u000a<p>RDD\u672c\u8eab\u662f\u9759\u6001\u7c7b\u578b\u5bf9\u8c61\uff0c\u7531\u53c2\u6570\u6307\u5b9a\u5176\u5143\u7d20\u7c7b\u578b\u3002\u4f8b\u5982\uff0cRDD[int]\u662f\u4e00\u4e2a\u6574\u578bRDD\u3002\u4e0d\u8fc7\uff0c\u6211\u4eec\u4e3e\u7684\u4f8b\u5b50\u51e0\u4e4e\u90fd\u7701\u7565\u4e86\u8fd9\u4e2a\u7c7b\u578b\u53c2\u6570\uff0c\u56e0\u4e3aScala\u652f\u6301\u7c7b\u578b\u63a8\u65ad\u3002</p>\u000a<p>\u867d\u7136\u5728\u6982\u5ff5\u4e0a\u4f7f\u7528Scala\u5b9e\u73b0RDD\u5f88\u7b80\u5355\uff0c\u4f46\u8fd8\u662f\u8981\u5904\u7406\u4e00\u4e9bScala\u95ed\u5305\u5bf9\u8c61\u7684\u53cd\u5c04\u95ee\u9898\u3002\u5982\u4f55\u901a\u8fc7Scala\u89e3\u91ca\u5668\u6765\u4f7f\u7528Spark\u8fd8\u9700\u8981\u66f4\u591a\u5de5\u4f5c\uff0c\u8fd9\u70b9\u6211\u4eec\u5c06\u5728\u7b2c6\u90e8\u5206\u8ba8\u8bba\u3002\u4e0d\u7ba1\u600e\u6837\uff0c\u6211\u4eec\u90fd\u4e0d\u9700\u8981\u4fee\u6539Scala\u7f16\u8bd1\u5668\u3002</p>\u000a<h3>3.1 Spark\u4e2d\u7684RDD\u64cd\u4f5c</h3>\u000a<p>\u88682\u5217\u51fa\u4e86Spark\u4e2d\u7684RDD\u8f6c\u6362\u548c\u52a8\u4f5c\u3002\u6bcf\u4e2a\u64cd\u4f5c\u90fd\u7ed9\u51fa\u4e86\u6807\u8bc6\uff0c\u5176\u4e2d\u65b9\u62ec\u53f7\u8868\u793a\u7c7b\u578b\u53c2\u6570\u3002\u524d\u9762\u8bf4\u8fc7\u8f6c\u6362\u662f\u5ef6\u8fdf\u64cd\u4f5c\uff0c\u7528\u4e8e\u5b9a\u4e49\u65b0\u7684RDD\uff1b\u800c\u52a8\u4f5c\u542f\u52a8\u8ba1\u7b97\u64cd\u4f5c\uff0c\u5e76\u5411\u7528\u6237\u7a0b\u5e8f\u8fd4\u56de\u503c\u6216\u5411\u5916\u90e8\u5b58\u50a8\u5199\u6570\u636e\u3002</p>\u000a<table style="border: solid thin #868686" width="100%" border="1" cellspacing="0" cellpadding="2">\u000a<caption style="text-align:center"><strong>\u88683</strong> Spark\u4e2d\u652f\u6301\u7684RDD\u8f6c\u6362\u548c\u52a8\u4f5c</caption>\u000a<tbody>\u000a<tr>\u000a<td style="width: 20.62px;border: solid thin #868686" valign="top">\u8f6c\u6362</td>\u000a<td style="width: 117.21px;border: solid thin #868686" valign="top">map(f : T ) U) : RDD[T] ) RDD[U]<br />\u000afilter(f : T ) Bool) : RDD[T] ) RDD[T]<br />\u000aflatMap(f : T ) Seq[U]) : RDD[T] ) RDD[U]<br />\u000asample(fraction : Float) : RDD[T] ) RDD[T] (Deterministic sampling)<br />\u000agroupByKey() : RDD[(K, V)] ) RDD[(K, Seq[V])]<br />\u000areduceByKey(f : (V; V) ) V) : RDD[(K, V)] ) RDD[(K, V)]<br />\u000aunion() : (RDD[T]; RDD[T]) ) RDD[T]<br />\u000ajoin() : (RDD[(K, V)]; RDD[(K, W)]) ) RDD[(K, (V, W))]<br />\u000acogroup() : (RDD[(K, V)]; RDD[(K, W)]) ) RDD[(K, (Seq[V], Seq[W]))]<br />\u000acrossProduct() : (RDD[T]; RDD[U]) ) RDD[(T, U)]<br />\u000amapValues(f : V ) W) : RDD[(K, V)] ) RDD[(K, W)] (Preserves partitioning)<br />\u000asort(c : Comparator[K]) : RDD[(K, V)] ) RDD[(K, V)]<br />\u000apartitionBy(p : Partitioner[K]) : RDD[(K, V)] ) RDD[(K, V)]</td>\u000a</tr>\u000a<tr>\u000a<td style="width: 20.62px;border: solid thin #868686" valign="top">\u52a8\u4f5c</td>\u000a<td style="width: 117.21px;border: solid thin #868686" valign="top">count() : RDD[T] ) Long<br />\u000acollect() : RDD[T] ) Seq[T]<br />\u000areduce(f : (T; T) ) T) : RDD[T] ) T<br />\u000alookup(k : K) : RDD[(K, V)] ) Seq[V] (On hash/range partitioned RDDs)<br />\u000asave(path : String) : Outputs RDD to a storage system, e.g., HDFS</td>\u000a</tr>\u000a</tbody>\u000a</table>\u000a<p>\u6ce8\u610f\uff0c\u6709\u4e9b\u64cd\u4f5c\u53ea\u5bf9\u952e\u503c\u5bf9\u53ef\u7528\uff0c\u6bd4\u5982join\u3002\u53e6\u5916\uff0c\u51fd\u6570\u540d\u4e0eScala\u53ca\u5176\u4ed6\u51fd\u6570\u5f0f\u8bed\u8a00\u4e2d\u7684API\u5339\u914d\uff0c\u4f8b\u5982map\u662f\u4e00\u5bf9\u4e00\u7684\u6620\u5c04\uff0c\u800cflatMap\u662f\u5c06\u6bcf\u4e2a\u8f93\u5165\u6620\u5c04\u4e3a\u4e00\u4e2a\u6216\u591a\u4e2a\u8f93\u51fa\uff08\u4e0eMapReduce\u4e2d\u7684map\u7c7b\u4f3c\uff09\u3002</p>\u000a<p>\u9664\u4e86\u8fd9\u4e9b\u64cd\u4f5c\u4ee5\u5916\uff0c\u7528\u6237\u8fd8\u53ef\u4ee5\u8bf7\u6c42\u5c06RDD\u7f13\u5b58\u8d77\u6765\u3002\u800c\u4e14\uff0c\u7528\u6237\u8fd8\u53ef\u4ee5\u901a\u8fc7Partitioner\u7c7b\u83b7\u53d6RDD\u7684\u5206\u533a\u987a\u5e8f\uff0c\u7136\u540e\u5c06\u53e6\u4e00\u4e2aRDD\u6309\u7167\u540c\u6837\u7684\u65b9\u5f0f\u5206\u533a\u3002\u6709\u4e9b\u64cd\u4f5c\u4f1a\u81ea\u52a8\u4ea7\u751f\u4e00\u4e2a\u54c8\u5e0c\u6216\u8303\u56f4\u5206\u533a\u7684RDD\uff0c\u50cfgroupByKey\uff0creduceByKey\u548csort\u7b49\u3002</p>\u000a<h2>4. \u5e94\u7528\u7a0b\u5e8f\u793a\u4f8b</h2>\u000a<p>\u73b0\u5728\u6211\u4eec\u8bb2\u8ff0\u5982\u4f55\u4f7f\u7528RDD\u8868\u793a\u51e0\u79cd\u57fa\u4e8e\u6570\u636e\u5e76\u884c\u7684\u5e94\u7528\u3002\u9996\u5148\u8ba8\u8bba\u4e00\u4e9b\u8fed\u4ee3\u5f0f\u673a\u5668\u5b66\u4e60\u5e94\u7528\uff084.1\uff09\uff0c\u7136\u540e\u770b\u770b\u5982\u4f55\u4f7f\u7528RDD\u63cf\u8ff0\u51e0\u79cd\u5df2\u6709\u7684\u96c6\u7fa4\u7f16\u7a0b\u6a21\u578b\uff0c\u5373MapReduce\uff084.2\uff09\uff0cPregel\uff084.3\uff09\uff0c\u548cHadoop\uff084.4\uff09\u3002\u6700\u540e\u8ba8\u8bba\u4e00\u4e0bRDD\u4e0d\u9002\u5408\u54ea\u4e9b\u5e94\u7528\uff084.5\uff09\u3002</p>\u000a<h3>4.1 \u8fed\u4ee3\u5f0f\u673a\u5668\u5b66\u4e60</h3>\u000a<p>\u5f88\u591a\u673a\u5668\u5b66\u4e60\u7b97\u6cd5\u90fd\u5177\u6709\u8fed\u4ee3\u7279\u6027\uff0c\u8fd0\u884c\u8fed\u4ee3\u4f18\u5316\u65b9\u6cd5\u6765\u4f18\u5316\u67d0\u4e2a\u76ee\u6807\u51fd\u6570\uff0c\u4f8b\u5982\u68af\u5ea6\u4e0b\u964d\u65b9\u6cd5\u3002\u5982\u679c\u8fd9\u4e9b\u7b97\u6cd5\u7684\u5de5\u4f5c\u96c6\u80fd\u591f\u653e\u5165\u5185\u5b58\uff0c\u5c06\u6781\u5927\u5730\u52a0\u901f\u7a0b\u5e8f\u8fd0\u884c\u3002\u800c\u4e14\uff0c\u8fd9\u4e9b\u7b97\u6cd5\u901a\u5e38\u91c7\u7528\u6279\u91cf\u64cd\u4f5c\uff0c\u4f8b\u5982\u6620\u5c04\u548c\u6c42\u548c\uff0c\u8fd9\u6837\u66f4\u5bb9\u6613\u4f7f\u7528RDD\u6765\u8868\u793a\u3002</p>\u000a<p>\u4f8b\u5982\u4e0b\u9762\u7684\u7a0b\u5e8f\u662f\u903b\u8f91\u56de\u5f52[15]\u7684\u5b9e\u73b0\u3002\u903b\u8f91\u56de\u5f52\u662f\u4e00\u79cd\u5e38\u89c1\u7684\u5206\u7c7b\u7b97\u6cd5\uff0c\u5373\u5bfb\u627e\u4e00\u4e2a\u6700\u4f73\u5206\u5272\u4e24\u7ec4\u70b9\uff08\u5373\u5783\u573e\u90ae\u4ef6\u548c\u975e\u5783\u573e\u90ae\u4ef6\uff09\u7684\u8d85\u5e73\u9762w\u3002\u7b97\u6cd5\u91c7\u7528\u68af\u5ea6\u4e0b\u964d\u7684\u65b9\u6cd5\uff1a\u5f00\u59cb\u65f6w\u4e3a\u968f\u673a\u503c\uff0c\u5728\u6bcf\u4e00\u6b21\u8fed\u4ee3\u7684\u8fc7\u7a0b\u4e2d\uff0c\u5bf9w\u7684\u51fd\u6570\u6c42\u548c\uff0c\u7136\u540e\u671d\u7740\u4f18\u5316\u7684\u65b9\u5411\u79fb\u52a8w\u3002</p>\u000a<pre class="brush: scala; title: ; notranslate" title="">\u000aval points = spark.textFile(...)\u000a     .map(parsePoint).persist()\u000avar w = // random initial vector\u000afor (i &lt;- 1 to ITERATIONS) {\u000a     val gradient = points.map{ p =&gt;\u000a          p.x * (1/(1+exp(-p.y*(w dot p.x)))-1)*p.y\u000a     }.reduce((a,b) =&gt; a+b)\u000a     w -= gradient\u000a}\u000a</pre>\u000a<p>\u9996\u5148\u5b9a\u4e49\u4e00\u4e2a\u540d\u4e3apoints\u7684\u7f13\u5b58RDD\uff0c\u8fd9\u662f\u5728\u6587\u672c\u6587\u4ef6\u4e0a\u6267\u884cmap\u8f6c\u6362\u4e4b\u540e\u5f97\u5230\u7684\uff0c\u5373\u5c06\u6bcf\u4e2a\u6587\u672c\u884c\u89e3\u6790\u4e3a\u4e00\u4e2aPoint\u5bf9\u8c61\u3002\u7136\u540e\u5728points\u4e0a\u53cd\u590d\u6267\u884cmap\u548creduce\u64cd\u4f5c\uff0c\u6bcf\u6b21\u8fed\u4ee3\u65f6\u901a\u8fc7\u5bf9\u5f53\u524dw\u7684\u51fd\u6570\u8fdb\u884c\u6c42\u548c\u6765\u8ba1\u7b97\u68af\u5ea6\u30027.1\u5c0f\u8282\u6211\u4eec\u5c06\u770b\u5230\u8fd9\u79cd\u5728\u5185\u5b58\u4e2d\u7f13\u5b58points\u7684\u65b9\u5f0f\uff0c\u6bd4\u6bcf\u6b21\u8fed\u4ee3\u90fd\u4ece\u78c1\u76d8\u6587\u4ef6\u88c5\u8f7d\u6570\u636e\u5e76\u8fdb\u884c\u89e3\u6790\u8981\u5feb\u5f97\u591a\u3002</p>\u000a<p>\u5df2\u7ecf\u5728Spark\u4e2d\u5b9e\u73b0\u7684\u8fed\u4ee3\u5f0f\u673a\u5668\u5b66\u4e60\u7b97\u6cd5\u8fd8\u6709\uff1akmeans\uff08\u50cf\u903b\u8f91\u56de\u5f52\u4e00\u6837\u6bcf\u6b21\u8fed\u4ee3\u65f6\u6267\u884c\u4e00\u5bf9map\u548creduce\u64cd\u4f5c\uff09\uff0c\u671f\u671b\u6700\u5927\u5316\u7b97\u6cd5\uff08EM\uff0c\u4e24\u4e2a\u4e0d\u540c\u7684map/reduce\u6b65\u9aa4\u4ea4\u66ff\u6267\u884c\uff09\uff0c\u4ea4\u66ff\u6700\u5c0f\u4e8c\u4e58\u77e9\u9635\u5206\u89e3\u548c\u534f\u540c\u8fc7\u6ee4\u7b97\u6cd5\u3002Chu\u7b49\u4eba\u63d0\u51fa\u8fed\u4ee3\u5f0fMapReduce\u4e5f\u53ef\u4ee5\u7528\u6765\u5b9e\u73b0\u5e38\u7528\u7684\u5b66\u4e60\u7b97\u6cd5[11]\u3002</p>\u000a<h3>4.2 \u4f7f\u7528RDD\u5b9e\u73b0MapReduce</h3>\u000a<p>MapReduce\u6a21\u578b[12]\u5f88\u5bb9\u6613\u4f7f\u7528RDD\u8fdb\u884c\u63cf\u8ff0\u3002\u5047\u8bbe\u6709\u4e00\u4e2a\u8f93\u5165\u6570\u636e\u96c6\uff08\u5176\u5143\u7d20\u7c7b\u578b\u4e3aT\uff09\uff0c\u548c\u4e24\u4e2a\u51fd\u6570myMap: T =&gt; List[(Ki, Vi)] \u548c myReduce: (Ki; List[Vi]) ) List[R]\uff0c\u4ee3\u7801\u5982\u4e0b\uff1a</p>\u000a<pre class="brush: scala; title: ; notranslate" title="">\u000adata.flatMap(myMap)\u000a	.groupByKey()\u000a	.map((k, vs) =&gt; myReduce(k, vs))\u000a</pre>\u000a<p>\u5982\u679c\u4efb\u52a1\u5305\u542bcombiner\uff0c\u5219\u76f8\u5e94\u7684\u4ee3\u7801\u4e3a\uff1a</p>\u000a<pre class="brush: scala; title: ; notranslate" title="">\u000adata.flatMap(myMap)\u000a	.reduceByKey(myCombiner)\u000a	.map((k, v) =&gt; myReduce(k, v))\u000a</pre>\u000a<p>ReduceByKey\u64cd\u4f5c\u5728mapper\u8282\u70b9\u4e0a\u6267\u884c\u90e8\u5206\u805a\u96c6\uff0c\u4e0eMapReduce\u7684combiner\u7c7b\u4f3c\u3002</p>\u000a<h3>4.3 \u4f7f\u7528RDD\u5b9e\u73b0Pregel</h3>\u000a<p>Pregel[21]\u662f\u9762\u5411\u56fe\u7b97\u6cd5\u7684\u57fa\u4e8eBSP\u8303\u5f0f[32]\u7684\u7f16\u7a0b\u6a21\u578b\u3002\u7a0b\u5e8f\u7531\u4e00\u7cfb\u5217\u8d85\u6b65\uff08Superstep\uff09\u534f\u8c03\u8fed\u4ee3\u8fd0\u884c\u3002\u5728\u6bcf\u4e2a\u8d85\u6b65\u4e2d\uff0c\u5404\u4e2a\u9876\u70b9\u6267\u884c\u7528\u6237\u51fd\u6570\uff0c\u5e76\u66f4\u65b0\u76f8\u5e94\u7684\u9876\u70b9\u72b6\u6001\uff0c\u53d8\u5f02\u56fe\u62d3\u6251\uff0c\u7136\u540e\u5411\u4e0b\u4e00\u4e2a\u8d85\u6b65\u7684\u9876\u70b9\u96c6\u53d1\u9001\u6d88\u606f\u3002\u8fd9\u79cd\u6a21\u578b\u80fd\u591f\u63cf\u8ff0\u5f88\u591a\u56fe\u7b97\u6cd5\uff0c\u5305\u62ec\u6700\u77ed\u8def\u5f84\uff0c\u53cc\u8fb9\u5339\u914d\u548cPageRank\u7b49\u3002</p>\u000a<p>\u4ee5PageRank\u4e3a\u4f8b\u4ecb\u7ecd\u4e00\u4e0bPregel\u7684\u5b9e\u73b0\u3002\u5f53\u524dPageRank[7]\u8bb0\u4e3ar\uff0c\u9876\u70b9\u8868\u793a\u72b6\u6001\u3002\u5728\u6bcf\u4e2a\u8d85\u6b65\u4e2d\uff0c\u5404\u4e2a\u9876\u70b9\u5411\u5176\u6240\u6709\u90bb\u5c45\u53d1\u9001\u8d21\u732e\u503cr/n\uff0c\u8fd9\u91ccn\u662f\u90bb\u5c45\u7684\u6570\u76ee\u3002\u4e0b\u4e00\u4e2a\u8d85\u6b65\u5f00\u59cb\u65f6\uff0c\u6bcf\u4e2a\u9876\u70b9\u5c06\u5176\u5206\u503c\uff08rank\uff09\u66f4\u65b0\u4e3a \u03b1/N + (1 - \u03b1) * \u03a3ci\uff0c\u8fd9\u91cc\u7684\u6c42\u548c\u662f\u5404\u4e2a\u9876\u70b9\u6536\u5230\u7684\u6240\u6709\u8d21\u732e\u503c\u7684\u548c\uff0cN\u662f\u9876\u70b9\u7684\u603b\u6570\u3002</p>\u000a<p>Pregel\u5c06\u8f93\u5165\u7684\u56fe\u5212\u5206\u5230\u5404\u4e2aworker\u4e0a\uff0c\u5e76\u5b58\u50a8\u5728\u5176\u5185\u5b58\u4e2d\u3002\u5728\u6bcf\u4e2a\u8d85\u6b65\u4e2d\uff0c\u5404\u4e2aworker\u901a\u8fc7\u4e00\u79cd\u7c7b\u4f3cMapReduce\u7684Shuffle\u64cd\u4f5c\u4ea4\u6362\u6d88\u606f\u3002</p>\u000a<p>Pregel\u7684\u901a\u4fe1\u6a21\u5f0f\u53ef\u4ee5\u7528RDD\u6765\u63cf\u8ff0\uff0c\u5982\u56fe3\u3002\u4e3b\u8981\u601d\u60f3\u662f\uff1a\u5c06\u6bcf\u4e2a\u8d85\u6b65\u4e2d\u7684\u9876\u70b9\u72b6\u6001\u548c\u8981\u53d1\u9001\u7684\u6d88\u606f\u5b58\u50a8\u4e3aRDD\uff0c\u7136\u540e\u6839\u636e\u9876\u70b9ID\u5206\u7ec4\uff0c\u8fdb\u884cShuffle\u901a\u4fe1\uff08\u5373cogroup\u64cd\u4f5c\uff09\u3002\u7136\u540e\u5bf9\u6bcf\u4e2a\u9876\u70b9ID\u4e0a\u7684\u72b6\u6001\u548c\u6d88\u606f\u5e94\u7528\u7528\u6237\u51fd\u6570\uff08\u5373mapValues\u64cd\u4f5c\uff09\uff0c\u4ea7\u751f\u4e00\u4e2a\u65b0\u7684RDD\uff0c\u5373(VertexID, (NewState, OutgoingMessages))\u3002\u7136\u540e\u6267\u884cmap\u64cd\u4f5c\u5206\u79bb\u51fa\u4e0b\u4e00\u6b21\u8fed\u4ee3\u7684\u9876\u70b9\u72b6\u6001\u548c\u6d88\u606f\uff08\u5373mapValues\u548cflatMap\u64cd\u4f5c\uff09\u3002\u4ee3\u7801\u5982\u4e0b\uff1a</p>\u000a<pre class="brush: scala; title: ; notranslate" title="">\u000aval vertices = // RDD of (ID, State) pairs\u000aval messages = // RDD of (ID, Message) pairs\u000aval grouped = vertices.cogroup(messages)\u000aval newData = grouped.mapValues {\u000a	(vert, msgs) =&gt; userFunc(vert, msgs)\u000a	// returns (newState, outgoingMsgs)\u000a}.cache()\u000aval newVerts = newData.mapValues((v,ms) =&gt; v)\u000aval newMsgs = newData.flatMap((id,(v,ms)) =&gt; ms)\u000a</pre>\u000a<p><img class="alignnone size-full wp-image-750" alt="f3-iteration-pregel-using_rdd" src="http://shiyanjuncn.b0.upaiyun.com/wp-content/uploads/2014/03/f3-iteration-pregel-using_rdd.png" width="378" height="284" /><br />\u000a<span style="font-size: small;text-indent: 20px"><strong>\u56fe3</strong> \u4f7f\u7528RDD\u5b9e\u73b0Pregel\u65f6\uff0c\u4e00\u6b65\u8fed\u4ee3\u7684\u6570\u636e\u6d41\u3002\uff08\u65b9\u6846\u8868\u793aRDD\uff0c\u7bad\u5934\u8868\u793a\u8f6c\u6362\uff09</span><br />\u000a\u9700\u8981\u6ce8\u610f\u7684\u662f\uff0c\u8fd9\u79cd\u5b9e\u73b0\u65b9\u6cd5\u4e2d\uff0cRDD grouped\uff0cnewData\u548cnewVerts\u7684\u5206\u533a\u65b9\u6cd5\u4e0e\u8f93\u5165RDD vertices\u4e00\u6837\u3002\u6240\u4ee5\uff0c\u9876\u70b9\u72b6\u6001\u4e00\u76f4\u5b58\u5728\u4e8e\u5b83\u4eec\u5f00\u59cb\u6267\u884c\u7684\u673a\u5668\u4e0a\uff0c\u8fd9\u8ddf\u539fPregel\u4e00\u6837\uff0c\u8fd9\u6837\u5c31\u51cf\u5c11\u4e86\u901a\u4fe1\u6210\u672c\u3002\u56e0\u4e3acogroup\u548cmapValues\u4fdd\u6301\u4e86\u4e0e\u8f93\u5165RDD\u76f8\u540c\u7684\u5206\u533a\u65b9\u6cd5\uff0c\u6240\u4ee5\u5206\u533a\u662f\u81ea\u52a8\u8fdb\u884c\u7684\u3002</p>\u000a<p>\u5b8c\u6574\u7684Pregel\u7f16\u7a0b\u6a21\u578b\u8fd8\u5305\u62ec\u5176\u4ed6\u5de5\u5177\uff0c\u6bd4\u5982combiner\uff0c\u9644\u5f55A\u8ba8\u8bba\u4e86\u5b83\u4eec\u7684\u5b9e\u73b0\u3002\u4e0b\u9762\u5c06\u8ba8\u8bbaPregel\u7684\u5bb9\u9519\u6027\uff0c\u4ee5\u53ca\u5982\u4f55\u5728\u5b9e\u73b0\u76f8\u540c\u5bb9\u9519\u6027\u7684\u540c\u65f6\u51cf\u5c11\u9700\u8981\u6267\u884c\u68c0\u67e5\u70b9\u64cd\u4f5c\u7684\u6570\u636e\u91cf\u3002</p>\u000a<p>\u6211\u4eec\u5dee\u4e0d\u591a\u7528\u4e86100\u884cScala\u4ee3\u7801\u5728Spark\u4e0a\u5b9e\u73b0\u4e86\u4e00\u4e2a\u7c7bPregel\u7684API\u30027.2\u5c0f\u8282\u5c06\u4f7f\u7528PageRank\u7b97\u6cd5\u8bc4\u4f30\u5b83\u7684\u6027\u80fd\u3002</p>\u000a<h4>4.3.1 Pregel\u5bb9\u9519</h4>\u000a<p>\u5f53\u524d\uff0cPregel\u57fa\u4e8e\u68c0\u67e5\u70b9\u673a\u5236\u6765\u4e3a\u9876\u70b9\u72b6\u6001\u53ca\u5176\u6d88\u606f\u5b9e\u73b0\u5bb9\u9519[21]\u3002\u7136\u800c\u4f5c\u8005\u662f\u8fd9\u6837\u63cf\u8ff0\u7684\uff1a\u901a\u8fc7\u5728\u5176\u5b83\u7684\u8282\u70b9\u4e0a\u8bb0\u5f55\u5df2\u53d1\u6d88\u606f\u65e5\u5fd7\uff0c\u7136\u540e\u5355\u72ec\u91cd\u5efa\u4e22\u5931\u7684\u5206\u533a\uff0c\u53ea\u9700\u8981\u6062\u590d\u5c40\u90e8\u6570\u636e\u5373\u53ef\u3002\u4e0a\u9762\u63d0\u5230\u8fd9\u4e24\u79cd\u65b9\u5f0f\uff0cRDD\u90fd\u80fd\u591f\u5f88\u597d\u5730\u652f\u6301\u3002</p>\u000a<p>\u901a\u8fc74.3\u5c0f\u8282\u7684\u5b9e\u73b0\uff0cSpark\u603b\u662f\u80fd\u591f\u57fa\u4e8eLineage\u5b9e\u73b0\u9876\u70b9\u548c\u6d88\u606fRDD\u7684\u91cd\u5efa\uff0c\u4f46\u662f\u7531\u4e8e\u8fc7\u957f\u7684Lineage\u94fe\uff0c\u6062\u590d\u53ef\u80fd\u4f1a\u4ed8\u51fa\u9ad8\u6602\u7684\u4ee3\u4ef7\u3002\u56e0\u4e3a\u8fed\u4ee3RDD\u4f9d\u8d56\u4e8e\u4e0a\u4e00\u4e2aRDD\uff0c\u5bf9\u4e8e\u90e8\u5206\u5206\u533a\u6765\u8bf4\uff0c\u8282\u70b9\u6545\u969c\u53ef\u80fd\u4f1a\u5bfc\u81f4\u8fd9\u4e9b\u5206\u533a\u72b6\u6001\u7684\u6240\u6709\u8fed\u4ee3\u7248\u672c\u4e22\u5931\uff0c\u8fd9\u5c31\u8981\u6c42\u4f7f\u7528\u4e00\u79cd\u201c\u7ea7\u8054-\u91cd\u65b0\u6267\u884c\u201d[20]\u7684\u65b9\u5f0f\u53bb\u4f9d\u6b21\u91cd\u5efa\u6bcf\u4e00\u4e2a\u4e22\u5931\u7684\u5206\u533a\u3002\u4e3a\u4e86\u907f\u514d\u8fd9\u4e2a\u95ee\u9898\uff0c\u7528\u6237\u53ef\u4ee5\u5468\u671f\u6027\u5730\u5728\u9876\u70b9\u548c\u6d88\u606fRDD\u4e0a\u6267\u884csave\u64cd\u4f5c\uff0c\u5c06\u72b6\u6001\u4fe1\u606f\u4fdd\u5b58\u5230\u6301\u4e45\u5b58\u50a8\u4e2d\u3002\u7136\u540e\uff0cSpark\u80fd\u591f\u5728\u5931\u8d25\u7684\u65f6\u5019\u81ea\u52a8\u5730\u91cd\u65b0\u8ba1\u7b97\u8fd9\u4e9b\u4e22\u5931\u7684\u5206\u533a\uff08\u800c\u4e0d\u662f\u56de\u6eda\u6574\u4e2a\u7a0b\u5e8f\uff09\u3002</p>\u000a<p>\u6700\u540e\uff0c\u6211\u4eec\u610f\u8bc6\u5230\uff0cRDD\u4e5f\u80fd\u591f\u5b9e\u73b0\u68c0\u67e5\u70b9\u6570\u636e\u7684reduce\u64cd\u4f5c\uff0c\u8fd9\u8981\u6c42\u901a\u8fc7\u4e00\u79cd\u9ad8\u6548\u7684\u68c0\u67e5\u70b9\u65b9\u6848\u6765\u8868\u8fbe\u68c0\u67e5\u70b9\u6570\u636e\u3002\u5728\u5f88\u591aPregel\u4f5c\u4e1a\u4e2d\uff0c\u9876\u70b9\u72b6\u6001\u90fd\u5305\u62ec\u53ef\u53d8\u4e0e\u4e0d\u53ef\u53d8\u7684\u7ec4\u4ef6\uff0c\u4f8b\u5982\uff0c\u5728PageRank\u4e2d\uff0c\u4e0e\u4e00\u4e2a\u9876\u70b9\u76f8\u90bb\u7684\u9876\u70b9\u5217\u8868\u662f\u4e0d\u53ef\u53d8\u7684\uff0c\u4f46\u662f\u5b83\u4eec\u7684\u6392\u540d\u662f\u53ef\u53d8\u7684\uff0c\u5728\u8fd9\u79cd\u60c5\u51b5\u4e0b\uff0c\u6211\u4eec\u53ef\u4ee5\u4f7f\u7528\u4e00\u4e2a\u6765\u81ea\u53ef\u53d8\u6570\u636e\u7684\u5355\u72ecRDD\u6765\u66ff\u6362\u4e0d\u53ef\u53d8RDD\uff0c\u57fa\u4e8e\u8fd9\u6837\u4e00\u4e2a\u8f83\u77ed\u7684Lineage\u94fe\uff0c\u68c0\u67e5\u70b9\u4ec5\u4ec5\u662f\u53ef\u53d8\u72b6\u6001\uff0c\u56fe4\u89e3\u91ca\u4e86\u8fd9\u79cd\u65b9\u5f0f\u3002<br />\u000a<img class="alignnone size-full wp-image-751" alt="f4-data-flow-of-pregel-using-rdd" src="http://shiyanjuncn.b0.upaiyun.com/wp-content/uploads/2014/03/f4-data-flow-of-pregel-using-rdd.png" width="468" height="347" /><br />\u000a<span style="font-size: small;text-indent: 20px"><strong>\u56fe4</strong> \u7ecf\u8fc7\u4f18\u5316\u7684Pregel\u4f7f\u7528RDD\u7684\u6570\u636e\u6d41\u3002\u53ef\u53d8\u72b6\u6001RDD\u5fc5\u987b\u8bbe\u7f6e\u68c0\u67e5\u70b9\uff0c\u4e0d\u53ef\u53d8\u72b6\u6001\u624d\u53ef\u88ab\u5feb\u901f\u91cd\u5efa\u3002</span><br />\u000a\u5728PageRank\u4e2d\uff0c\u4e0d\u53ef\u53d8\u72b6\u6001\uff08\u76f8\u90bb\u9876\u70b9\u5217\u8868\uff09\u8fdc\u5927\u4e8e\u53ef\u53d8\u72b6\u6001\uff08\u6d6e\u70b9\u503c\uff09\uff0c\u6240\u4ee5\u8fd9\u79cd\u65b9\u5f0f\u80fd\u591f\u6781\u5927\u5730\u964d\u4f4e\u5f00\u9500\u3002</p>\u000a<h3>4.4 \u4f7f\u7528RDD\u5b9e\u73b0HaLoop</h3>\u000a<p>HaLoop[8]\u662fHadoop\u7684\u4e00\u4e2a\u6269\u5c55\u7248\u672c\uff0c\u5b83\u80fd\u591f\u6539\u5584\u5177\u6709\u8fed\u4ee3\u7279\u6027\u7684MapReduce\u7a0b\u5e8f\u7684\u6027\u80fd\u3002\u57fa\u4e8eHaLoop\u7f16\u7a0b\u6a21\u578b\u7684\u5e94\u7528\uff0c\u4f7f\u7528reduce\u9636\u6bb5\u7684\u8f93\u51fa\u4f5c\u4e3amap\u9636\u6bb5\u4e0b\u4e00\u8f6e\u8fed\u4ee3\u7684\u8f93\u5165\u3002\u5b83\u7684\u5faa\u73af\u611f\u77e5\u4efb\u52a1\u8c03\u5ea6\u5668\u80fd\u591f\u4fdd\u8bc1\uff0c\u5728\u6bcf\u4e00\u8f6e\u8fed\u4ee3\u4e2d\u5904\u7406\u540c\u4e00\u4e2a\u5206\u533a\u6570\u636e\u7684\u8fde\u7eedmap\u548creduce\u4efb\u52a1\uff0c\u4e00\u5b9a\u80fd\u591f\u5728\u540c\u4e00\u53f0\u7269\u7406\u673a\u4e0a\u6267\u884c\u3002\u786e\u4fdd\u8fed\u4ee3\u95f4locality\u7279\u6027\uff0creduce\u6570\u636e\u5728\u7269\u7406\u8282\u70b9\u4e4b\u95f4\u4f20\u8f93\uff0c\u5e76\u4e14\u5141\u8bb8\u6570\u636e\u7f13\u5b58\u5728\u672c\u5730\u78c1\u76d8\u800c\u80fd\u591f\u88ab\u540e\u7eed\u8fed\u4ee3\u91cd\u7528\u3002</p>\u000a<p>\u4f7f\u7528RDD\u6765\u4f18\u5316HaLoop\uff0c\u6211\u4eec\u5728Spark\u4e0a\u5b9e\u73b0\u4e86\u4e00\u4e2a\u7c7b\u4f3cHaLoop\u7684API\uff0c\u8fd9\u4e2a\u5e93\u53ea\u4f7f\u7528\u4e86200\u884cScala\u4ee3\u7801\u3002\u901a\u8fc7partitionBy\u80fd\u591f\u4fdd\u8bc1\u8de8\u8fed\u4ee3\u7684\u5206\u533a\u7684\u4e00\u81f4\u6027\uff0c\u6bcf\u4e00\u4e2a\u9636\u6bb5\u7684\u8f93\u5165\u548c\u8f93\u51fa\u88ab\u7f13\u5b58\u4ee5\u7528\u4e8e\u540e\u7eed\u8fed\u4ee3\u3002</p>\u000a<h3>4.5 \u4e0d\u9002\u5408\u4f7f\u7528RDD\u7684\u5e94\u7528</h3>\u000a<p>\u57282.1\u8282\u6211\u4eec\u8ba8\u8bba\u8fc7\uff0cRDD\u9002\u7528\u4e8e\u5177\u6709\u6279\u91cf\u8f6c\u6362\u9700\u6c42\u7684\u5e94\u7528\uff0c\u5e76\u4e14\u76f8\u540c\u7684\u64cd\u4f5c\u4f5c\u7528\u4e8e\u6570\u636e\u96c6\u7684\u6bcf\u4e00\u4e2a\u5143\u7d20\u4e0a\u3002\u5728\u8fd9\u79cd\u60c5\u51b5\u4e0b\uff0cRDD\u80fd\u591f\u8bb0\u4f4f\u6bcf\u4e2a\u8f6c\u6362\u64cd\u4f5c\uff0c\u5bf9\u5e94\u4e8eLineage\u56fe\u4e2d\u7684\u4e00\u4e2a\u6b65\u9aa4\uff0c\u6062\u590d\u4e22\u5931\u5206\u533a\u6570\u636e\u65f6\u4e0d\u9700\u8981\u5199\u65e5\u5fd7\u8bb0\u5f55\u5927\u91cf\u6570\u636e\u3002RDD\u4e0d\u9002\u5408\u90a3\u4e9b\u901a\u8fc7\u5f02\u6b65\u7ec6\u7c92\u5ea6\u5730\u66f4\u65b0\u6765\u5171\u4eab\u72b6\u6001\u7684\u5e94\u7528\uff0c\u4f8b\u5982Web\u5e94\u7528\u4e2d\u7684\u5b58\u50a8\u7cfb\u7edf\uff0c\u6216\u8005\u589e\u91cf\u6293\u53d6\u548c\u7d22\u5f15Web\u6570\u636e\u7684\u7cfb\u7edf\uff0c\u8fd9\u6837\u7684\u5e94\u7528\u66f4\u9002\u5408\u4f7f\u7528\u4e00\u4e9b\u4f20\u7edf\u7684\u65b9\u6cd5\uff0c\u4f8b\u5982\u6570\u636e\u5e93\u3001RAMCloud[26]\u3001Percolator[27]\u548cPiccolo[28]\u3002\u6211\u4eec\u7684\u76ee\u6807\u662f\uff0c\u9762\u5411\u6279\u91cf\u5206\u6790\u5e94\u7528\u7684\u8fd9\u7c7b\u7279\u5b9a\u7cfb\u7edf\uff0c\u63d0\u4f9b\u4e00\u79cd\u9ad8\u6548\u7684\u7f16\u7a0b\u6a21\u578b\uff0c\u800c\u4e0d\u662f\u4e00\u4e9b\u5f02\u6b65\u5e94\u7528\u7a0b\u5e8f\u3002</p>\u000a<h2>5. RDD\u7684\u63cf\u8ff0\u53ca\u4f5c\u4e1a\u8c03\u5ea6</h2>\u000a<p>\u6211\u4eec\u5e0c\u671b\u5728\u4e0d\u4fee\u6539\u8c03\u5ea6\u5668\u7684\u524d\u63d0\u4e0b\uff0c\u652f\u6301RDD\u4e0a\u7684\u5404\u79cd\u8f6c\u6362\u64cd\u4f5c\uff0c\u540c\u65f6\u80fd\u591f\u4ece\u8fd9\u4e9b\u8f6c\u6362\u83b7\u53d6Lineage\u4fe1\u606f\u3002\u4e3a\u6b64\uff0c\u6211\u4eec\u4e3aRDD\u8bbe\u8ba1\u4e86\u4e00\u7ec4\u5c0f\u578b\u901a\u7528\u7684\u5185\u90e8\u63a5\u53e3\u3002</p>\u000a<p>\u7b80\u5355\u5730\u8bf4\uff0c\u6bcf\u4e2aRDD\u90fd\u5305\u542b\uff1a\uff081\uff09\u4e00\u7ec4RDD\u5206\u533a\uff08partition\uff0c\u5373\u6570\u636e\u96c6\u7684\u539f\u5b50\u7ec4\u6210\u90e8\u5206\uff09\uff1b\uff082\uff09\u5bf9\u7236RDD\u7684\u4e00\u7ec4\u4f9d\u8d56\uff0c\u8fd9\u4e9b\u4f9d\u8d56\u63cf\u8ff0\u4e86RDD\u7684Lineage\uff1b\uff083\uff09\u4e00\u4e2a\u51fd\u6570\uff0c\u5373\u5728\u7236RDD\u4e0a\u6267\u884c\u4f55\u79cd\u8ba1\u7b97\uff1b\uff084\uff09\u5143\u6570\u636e\uff0c\u63cf\u8ff0\u5206\u533a\u6a21\u5f0f\u548c\u6570\u636e\u5b58\u653e\u7684\u4f4d\u7f6e\u3002\u4f8b\u5982\uff0c\u4e00\u4e2a\u8868\u793aHDFS\u6587\u4ef6\u7684RDD\u5305\u542b\uff1a\u5404\u4e2a\u6570\u636e\u5757\u7684\u4e00\u4e2a\u5206\u533a\uff0c\u5e76\u77e5\u9053\u5404\u4e2a\u6570\u636e\u5757\u653e\u5728\u54ea\u4e9b\u8282\u70b9\u4e0a\u3002\u800c\u4e14\u8fd9\u4e2aRDD\u4e0a\u7684map\u64cd\u4f5c\u7ed3\u679c\u4e5f\u5177\u6709\u540c\u6837\u7684\u5206\u533a\uff0cmap\u51fd\u6570\u662f\u5728\u7236\u6570\u636e\u4e0a\u6267\u884c\u7684\u3002\u88683\u603b\u7ed3\u4e86RDD\u7684\u5185\u90e8\u63a5\u53e3\u3002</p>\u000a<table style="border: solid thin #868686" width="100%" border="1" cellspacing="0" cellpadding="2">\u000a<caption style="text-align:center"><strong>\u88683</strong> Spark\u4e2dRDD\u7684\u5185\u90e8\u63a5\u53e3</caption>\u000a<tbody>\u000a<tr>\u000a<td style="width: 68.62px;text-align: center;border: solid thin #868686" valign="top"><b>\u64cd\u4f5c</b></td>\u000a<td style="width: 117.21px;text-align: center;border: solid thin #868686" valign="top"><b>\u542b\u4e49</b></td>\u000a</tr>\u000a<tr>\u000a<td style="width: 68.62px;border: solid thin #868686" valign="top">partitions()</td>\u000a<td style="width: 117.21px;border: solid thin #868686" valign="top">\u8fd4\u56de\u4e00\u7ec4Partition\u5bf9\u8c61</td>\u000a</tr>\u000a<tr>\u000a<td style="width: 68.62px;border: solid thin #868686" valign="top">preferredLocations(p)</td>\u000a<td style="width: 117.21px;border: solid thin #868686" valign="top">\u6839\u636e\u6570\u636e\u5b58\u653e\u7684\u4f4d\u7f6e\uff0c\u8fd4\u56de\u5206\u533ap\u5728\u54ea\u4e9b\u8282\u70b9\u8bbf\u95ee\u66f4\u5feb</td>\u000a</tr>\u000a<tr>\u000a<td style="width: 68.62px;border: solid thin #868686" valign="top">dependencies()</td>\u000a<td style="width: 117.21px;border: solid thin #868686" valign="top">\u8fd4\u56de\u4e00\u7ec4\u4f9d\u8d56</td>\u000a</tr>\u000a<tr>\u000a<td style="width: 68.62px;border: solid thin #868686" valign="top">iterator(p, parentIters)</td>\u000a<td style="width: 117.21px;border: solid thin #868686" valign="top">\u6309\u7167\u7236\u5206\u533a\u7684\u8fed\u4ee3\u5668\uff0c\u9010\u4e2a\u8ba1\u7b97\u5206\u533ap\u7684\u5143\u7d20</td>\u000a</tr>\u000a<tr>\u000a<td style="width: 68.62px;border: solid thin #868686" valign="top">partitioner()</td>\u000a<td style="width: 117.21px;border: solid thin #868686" valign="top">\u8fd4\u56deRDD\u662f\u5426hash/range\u5206\u533a\u7684\u5143\u6570\u636e\u4fe1\u606f</td>\u000a</tr>\u000a</tbody>\u000a</table>\u000a<p>\u8bbe\u8ba1\u63a5\u53e3\u7684\u4e00\u4e2a\u5173\u952e\u95ee\u9898\u5c31\u662f\uff0c\u5982\u4f55\u8868\u793aRDD\u4e4b\u95f4\u7684\u4f9d\u8d56\u3002\u6211\u4eec\u53d1\u73b0RDD\u4e4b\u95f4\u7684\u4f9d\u8d56\u5173\u7cfb\u53ef\u4ee5\u5206\u4e3a\u4e24\u7c7b\uff0c\u5373\uff1a\uff081\uff09\u7a84\u4f9d\u8d56\uff08narrow dependencies\uff09\uff1a\u5b50RDD\u7684\u6bcf\u4e2a\u5206\u533a\u4f9d\u8d56\u4e8e\u5e38\u6570\u4e2a\u7236\u5206\u533a\uff08\u5373\u4e0e\u6570\u636e\u89c4\u6a21\u65e0\u5173\uff09\uff1b\uff082\uff09\u5bbd\u4f9d\u8d56\uff08wide dependencies\uff09\uff1a\u5b50RDD\u7684\u6bcf\u4e2a\u5206\u533a\u4f9d\u8d56\u4e8e\u6240\u6709\u7236RDD\u5206\u533a\u3002\u4f8b\u5982\uff0cmap\u4ea7\u751f\u7a84\u4f9d\u8d56\uff0c\u800cjoin\u5219\u662f\u5bbd\u4f9d\u8d56\uff08\u9664\u975e\u7236RDD\u88ab\u54c8\u5e0c\u5206\u533a\uff09\u3002\u53e6\u4e00\u4e2a\u4f8b\u5b50\u89c1\u56fe5\u3002<br />\u000a<img class="alignnone size-full wp-image-752" alt="f5-rdd-narrow-and-wide-dependencies" src="http://shiyanjuncn.b0.upaiyun.com/wp-content/uploads/2014/03/f5-rdd-narrow-and-wide-dependencies.png" width="465" height="306" /><br />\u000a<span style="font-size: small;text-indent: 20px"><strong>\u56fe5</strong> \u7a84\u4f9d\u8d56\u548c\u5bbd\u4f9d\u8d56\u7684\u4f8b\u5b50\u3002\uff08\u65b9\u6846\u8868\u793aRDD\uff0c\u5b9e\u5fc3\u77e9\u5f62\u8868\u793a\u5206\u533a\uff09</span><br />\u000a\u533a\u5206\u8fd9\u4e24\u79cd\u4f9d\u8d56\u5f88\u6709\u7528\u3002\u9996\u5148\uff0c\u7a84\u4f9d\u8d56\u5141\u8bb8\u5728\u4e00\u4e2a\u96c6\u7fa4\u8282\u70b9\u4e0a\u4ee5\u6d41\u6c34\u7ebf\u7684\u65b9\u5f0f\uff08pipeline\uff09\u8ba1\u7b97\u6240\u6709\u7236\u5206\u533a\u3002\u4f8b\u5982\uff0c\u9010\u4e2a\u5143\u7d20\u5730\u6267\u884cmap\u3001\u7136\u540efilter\u64cd\u4f5c\uff1b\u800c\u5bbd\u4f9d\u8d56\u5219\u9700\u8981\u9996\u5148\u8ba1\u7b97\u597d\u6240\u6709\u7236\u5206\u533a\u6570\u636e\uff0c\u7136\u540e\u5728\u8282\u70b9\u4e4b\u95f4\u8fdb\u884cShuffle\uff0c\u8fd9\u4e0eMapReduce\u7c7b\u4f3c\u3002\u7b2c\u4e8c\uff0c\u7a84\u4f9d\u8d56\u80fd\u591f\u66f4\u6709\u6548\u5730\u8fdb\u884c\u5931\u6548\u8282\u70b9\u7684\u6062\u590d\uff0c\u5373\u53ea\u9700\u91cd\u65b0\u8ba1\u7b97\u4e22\u5931RDD\u5206\u533a\u7684\u7236\u5206\u533a\uff0c\u800c\u4e14\u4e0d\u540c\u8282\u70b9\u4e4b\u95f4\u53ef\u4ee5\u5e76\u884c\u8ba1\u7b97\uff1b\u800c\u5bf9\u4e8e\u4e00\u4e2a\u5bbd\u4f9d\u8d56\u5173\u7cfb\u7684Lineage\u56fe\uff0c\u5355\u4e2a\u8282\u70b9\u5931\u6548\u53ef\u80fd\u5bfc\u81f4\u8fd9\u4e2aRDD\u7684\u6240\u6709\u7956\u5148\u4e22\u5931\u90e8\u5206\u5206\u533a\uff0c\u56e0\u800c\u9700\u8981\u6574\u4f53\u91cd\u65b0\u8ba1\u7b97\u3002</p>\u000a<p>\u901a\u8fc7RDD\u63a5\u53e3\uff0cSpark\u53ea\u9700\u8981\u4e0d\u8d85\u8fc720\u884c\u4ee3\u7801\u5b9e\u73b0\u4fbf\u53ef\u4ee5\u5b9e\u73b0\u5927\u591a\u6570\u8f6c\u6362\u30025.1\u5c0f\u8282\u7ed9\u51fa\u4e86\u4f8b\u5b50\uff0c\u7136\u540e\u6211\u4eec\u8ba8\u8bba\u4e86\u600e\u6837\u4f7f\u7528RDD\u63a5\u53e3\u8fdb\u884c\u8c03\u5ea6\uff085.2\uff09\uff0c\u6700\u540e\u8ba8\u8bba\u4e00\u4e0b\u57fa\u4e8eRDD\u7684\u7a0b\u5e8f\u4f55\u65f6\u9700\u8981\u6570\u636e\u68c0\u67e5\u70b9\u64cd\u4f5c\uff085.3\uff09\u3002</p>\u000a<h3>5.1 RDD\u5b9e\u73b0\u4e3e\u4f8b</h3>\u000a<p><strong><i>HDFS\u6587\u4ef6</i></strong>\uff1a\u76ee\u524d\u4e3a\u6b62\u6211\u4eec\u7ed9\u7684\u4f8b\u5b50\u4e2d\u8f93\u5165RDD\u90fd\u662fHDFS\u6587\u4ef6\uff0c\u5bf9\u8fd9\u4e9bRDD\u53ef\u4ee5\u6267\u884c\uff1apartitions\u64cd\u4f5c\u8fd4\u56de\u5404\u4e2a\u6570\u636e\u5757\u7684\u4e00\u4e2a\u5206\u533a\uff08\u6bcf\u4e2aPartition\u5bf9\u8c61\u4e2d\u4fdd\u5b58\u6570\u636e\u5757\u7684\u504f\u79fb\uff09\uff0cpreferredLocations\u64cd\u4f5c\u8fd4\u56de\u6570\u636e\u5757\u6240\u5728\u7684\u8282\u70b9\u5217\u8868\uff0citerator\u64cd\u4f5c\u5bf9\u6570\u636e\u5757\u8fdb\u884c\u8bfb\u53d6\u3002</p>\u000a<p><strong><i>map</i></strong>\uff1a\u4efb\u4f55RDD\u4e0a\u90fd\u53ef\u4ee5\u6267\u884cmap\u64cd\u4f5c\uff0c\u8fd4\u56de\u4e00\u4e2aMappedRDD\u5bf9\u8c61\u3002\u8be5\u64cd\u4f5c\u4f20\u9012\u4e00\u4e2a\u51fd\u6570\u53c2\u6570\u7ed9map\uff0c\u5bf9\u7236RDD\u4e0a\u7684\u8bb0\u5f55\u6309\u7167iterator\u7684\u65b9\u5f0f\u6267\u884c\u8fd9\u4e2a\u51fd\u6570\uff0c\u5e76\u8fd4\u56de\u4e00\u7ec4\u7b26\u5408\u6761\u4ef6\u7684\u7236RDD\u5206\u533a\u53ca\u5176\u4f4d\u7f6e\u3002</p>\u000a<p><strong><i>union</i></strong>\uff1a\u5728\u4e24\u4e2aRDD\u4e0a\u6267\u884cunion\u64cd\u4f5c\uff0c\u8fd4\u56de\u4e24\u4e2a\u7236RDD\u5206\u533a\u7684\u5e76\u96c6\u3002\u901a\u8fc7\u76f8\u5e94\u7236RDD\u4e0a\u7684\u7a84\u4f9d\u8d56\u5173\u7cfb\u8ba1\u7b97\u6bcf\u4e2a\u5b50RDD\u5206\u533a\uff08\u6ce8\u610funion\u64cd\u4f5c\u4e0d\u4f1a\u8fc7\u6ee4\u91cd\u590d\u503c\uff0c\u76f8\u5f53\u4e8eSQL\u4e2d\u7684UNION ALL\uff09\u3002</p>\u000a<p><strong><i>sample</i></strong>\uff1a\u62bd\u6837\u4e0e\u6620\u5c04\u7c7b\u4f3c\uff0c\u4f46\u662fsample\u64cd\u4f5c\u4e2d\uff0cRDD\u9700\u8981\u5b58\u50a8\u4e00\u4e2a\u968f\u673a\u6570\u4ea7\u751f\u5668\u7684\u79cd\u5b50\uff0c\u8fd9\u6837\u6bcf\u4e2a\u5206\u533a\u80fd\u591f\u786e\u5b9a\u54ea\u4e9b\u7236RDD\u8bb0\u5f55\u88ab\u62bd\u6837\u3002</p>\u000a<p><strong>join</strong>\uff1a\u5bf9\u4e24\u4e2aRDD\u6267\u884cjoin\u64cd\u4f5c\u53ef\u80fd\u4ea7\u751f\u7a84\u4f9d\u8d56\uff08\u5982\u679c\u8fd9\u4e24\u4e2aRDD\u62e5\u6709\u76f8\u540c\u7684\u54c8\u5e0c\u5206\u533a\u6216\u8303\u56f4\u5206\u533a\uff09\uff0c\u53ef\u80fd\u662f\u5bbd\u4f9d\u8d56\uff0c\u4e5f\u53ef\u80fd\u4e24\u79cd\u4f9d\u8d56\u90fd\u6709\uff08\u6bd4\u5982\u4e00\u4e2a\u7236RDD\u6709\u5206\u533a\uff0c\u800c\u53e6\u4e00\u7236RDD\u6ca1\u6709\uff09\u3002</p>\u000a<h3>5.2 Spark\u4efb\u52a1\u8c03\u5ea6\u5668</h3>\u000a<p>\u8c03\u5ea6\u5668\u6839\u636eRDD\u7684\u7ed3\u6784\u4fe1\u606f\u4e3a\u6bcf\u4e2a\u52a8\u4f5c\u786e\u5b9a\u6709\u6548\u7684\u6267\u884c\u8ba1\u5212\u3002\u8c03\u5ea6\u5668\u7684\u63a5\u53e3\u662frunJob\u51fd\u6570\uff0c\u53c2\u6570\u4e3aRDD\u53ca\u5176\u5206\u533a\u96c6\uff0c\u548c\u4e00\u4e2aRDD\u5206\u533a\u4e0a\u7684\u51fd\u6570\u3002\u8be5\u63a5\u53e3\u8db3\u4ee5\u8868\u793aSpark\u4e2d\u7684\u6240\u6709\u52a8\u4f5c\uff08\u5373count\u3001collect\u3001save\u7b49\uff09\u3002</p>\u000a<p>\u603b\u7684\u6765\u8bf4\uff0c\u6211\u4eec\u7684\u8c03\u5ea6\u5668\u8ddfDryad\u7c7b\u4f3c\uff0c\u4f46\u6211\u4eec\u8fd8\u8003\u8651\u4e86\u54ea\u4e9bRDD\u5206\u533a\u662f\u7f13\u5b58\u5728\u5185\u5b58\u4e2d\u7684\u3002\u8c03\u5ea6\u5668\u6839\u636e\u76ee\u6807RDD\u7684Lineage\u56fe\u521b\u5efa\u4e00\u4e2a\u7531stage\u6784\u6210\u7684\u65e0\u56de\u8def\u6709\u5411\u56fe\uff08DAG\uff09\u3002\u6bcf\u4e2astage\u5185\u90e8\u5c3d\u53ef\u80fd\u591a\u5730\u5305\u542b\u4e00\u7ec4\u5177\u6709\u7a84\u4f9d\u8d56\u5173\u7cfb\u7684\u8f6c\u6362\uff0c\u5e76\u5c06\u5b83\u4eec\u6d41\u6c34\u7ebf\u5e76\u884c\u5316\uff08pipeline\uff09\u3002stage\u7684\u8fb9\u754c\u6709\u4e24\u79cd\u60c5\u51b5\uff1a\u4e00\u662f\u5bbd\u4f9d\u8d56\u4e0a\u7684Shuffle\u64cd\u4f5c\uff1b\u4e8c\u662f\u5df2\u7f13\u5b58\u5206\u533a\uff0c\u5b83\u53ef\u4ee5\u7f29\u77ed\u7236RDD\u7684\u8ba1\u7b97\u8fc7\u7a0b\u3002\u4f8b\u5982\u56fe6\u3002\u7236RDD\u5b8c\u6210\u8ba1\u7b97\u540e\uff0c\u53ef\u4ee5\u5728stage\u5185\u542f\u52a8\u4e00\u7ec4\u4efb\u52a1\u8ba1\u7b97\u4e22\u5931\u7684\u5206\u533a\u3002<br />\u000a<img class="alignnone size-full wp-image-753" alt="f6-spark-compute-stage" src="http://shiyanjuncn.b0.upaiyun.com/wp-content/uploads/2014/03/f6-spark-compute-stage.png" width="452" height="313" /><br />\u000a<span style="font-size: small;text-indent: 20px"><strong>\u56fe6</strong> Spark\u600e\u6837\u5212\u5206\u4efb\u52a1\u9636\u6bb5\uff08stage\uff09\u7684\u4f8b\u5b50\u3002\u5b9e\u7ebf\u65b9\u6846\u8868\u793aRDD\uff0c\u5b9e\u5fc3\u77e9\u5f62\u8868\u793a\u5206\u533a\uff08\u9ed1\u8272\u8868\u793a\u8be5\u5206\u533a\u88ab\u7f13\u5b58\uff09\u3002\u8981\u5728RDD G\u4e0a\u6267\u884c\u4e00\u4e2a\u52a8\u4f5c\uff0c\u8c03\u5ea6\u5668\u6839\u636e\u5bbd\u4f9d\u8d56\u521b\u5efa\u4e00\u7ec4stage\uff0c\u5e76\u5728\u6bcf\u4e2astage\u5185\u90e8\u5c06\u5177\u6709\u7a84\u4f9d\u8d56\u7684\u8f6c\u6362\u6d41\u6c34\u7ebf\u5316\uff08pipeline\uff09\u3002 \u672c\u4f8b\u4e0d\u7528\u518d\u6267\u884cstage 1\uff0c\u56e0\u4e3aB\u5df2\u7ecf\u5b58\u5728\u4e8e\u7f13\u5b58\u4e2d\u4e86\uff0c\u6240\u4ee5\u53ea\u9700\u8981\u8fd0\u884c2\u548c3\u3002</span></p>\u000a<p>\u8c03\u5ea6\u5668\u6839\u636e\u6570\u636e\u5b58\u653e\u7684\u4f4d\u7f6e\u5206\u914d\u4efb\u52a1\uff0c\u4ee5\u6700\u5c0f\u5316\u901a\u4fe1\u5f00\u9500\u3002\u5982\u679c\u67d0\u4e2a\u4efb\u52a1\u9700\u8981\u5904\u7406\u4e00\u4e2a\u5df2\u7f13\u5b58\u5206\u533a\uff0c\u5219\u76f4\u63a5\u5c06\u4efb\u52a1\u5206\u914d\u7ed9\u62e5\u6709\u8fd9\u4e2a\u5206\u533a\u7684\u8282\u70b9\u3002\u5426\u5219\uff0c\u5982\u679c\u9700\u8981\u5904\u7406\u7684\u5206\u533a\u4f4d\u4e8e\u591a\u4e2a\u53ef\u80fd\u7684\u4f4d\u7f6e\uff08\u4f8b\u5982\uff0c\u7531HDFS\u7684\u6570\u636e\u5b58\u653e\u4f4d\u7f6e\u51b3\u5b9a\uff09\uff0c\u5219\u5c06\u4efb\u52a1\u5206\u914d\u7ed9\u8fd9\u4e00\u7ec4\u8282\u70b9\u3002</p>\u000a<p>\u5bf9\u4e8e\u5bbd\u4f9d\u8d56\uff08\u4f8b\u5982\u9700\u8981Shuffle\u7684\u4f9d\u8d56\uff09\uff0c\u76ee\u524d\u7684\u5b9e\u73b0\u65b9\u5f0f\u662f\uff0c\u5728\u62e5\u6709\u7236\u5206\u533a\u7684\u8282\u70b9\u4e0a\u5c06\u4e2d\u95f4\u7ed3\u679c\u7269\u5316\uff0c\u7b80\u5316\u5bb9\u9519\u5904\u7406\uff0c\u8fd9\u8ddfMapReduce\u4e2d\u7269\u5316map\u8f93\u51fa\u5f88\u50cf\u3002</p>\u000a<p>\u5982\u679c\u67d0\u4e2a\u4efb\u52a1\u5931\u6548\uff0c\u53ea\u8981stage\u4e2d\u7684\u7236RDD\u5206\u533a\u53ef\u7528\uff0c\u5219\u53ea\u9700\u5728\u53e6\u4e00\u4e2a\u8282\u70b9\u4e0a\u91cd\u65b0\u8fd0\u884c\u8fd9\u4e2a\u4efb\u52a1\u5373\u53ef\u3002\u5982\u679c\u67d0\u4e9bstage\u4e0d\u53ef\u7528\uff08\u4f8b\u5982\uff0cShuffle\u65f6\u67d0\u4e2amap\u8f93\u51fa\u4e22\u5931\uff09\uff0c\u5219\u9700\u8981\u91cd\u65b0\u63d0\u4ea4\u8fd9\u4e2astage\u4e2d\u7684\u6240\u6709\u4efb\u52a1\u6765\u8ba1\u7b97\u4e22\u5931\u7684\u5206\u533a\u3002</p>\u000a<p>\u6700\u540e\uff0clookup\u52a8\u4f5c\u5141\u8bb8\u7528\u6237\u4ece\u4e00\u4e2a\u54c8\u5e0c\u6216\u8303\u56f4\u5206\u533a\u7684RDD\u4e0a\uff0c\u6839\u636e\u5173\u952e\u5b57\u8bfb\u53d6\u4e00\u4e2a\u6570\u636e\u5143\u7d20\u3002\u8fd9\u91cc\u6709\u4e00\u4e2a\u8bbe\u8ba1\u95ee\u9898\u3002Driver\u7a0b\u5e8f\u8c03\u7528lookup\u65f6\uff0c\u53ea\u9700\u8981\u4f7f\u7528\u5f53\u524d\u8c03\u5ea6\u5668\u63a5\u53e3\u8ba1\u7b97\u5173\u952e\u5b57\u6240\u5728\u7684\u90a3\u4e2a\u5206\u533a\u3002\u5f53\u7136\u4efb\u52a1\u4e5f\u53ef\u4ee5\u5728\u96c6\u7fa4\u4e0a\u8c03\u7528lookup\uff0c\u8fd9\u65f6\u53ef\u4ee5\u5c06RDD\u89c6\u4e3a\u4e00\u4e2a\u5927\u7684\u5206\u5e03\u5f0f\u54c8\u5e0c\u8868\u3002\u8fd9\u79cd\u60c5\u51b5\u4e0b\uff0c\u4efb\u52a1\u548c\u88ab\u67e5\u8be2\u7684RDD\u4e4b\u95f4\u7684\u5e76\u6ca1\u6709\u660e\u786e\u7684\u4f9d\u8d56\u5173\u7cfb\uff08\u56e0\u4e3aworker\u6267\u884c\u7684\u662flookup\uff09\uff0c\u5982\u679c\u6240\u6709\u8282\u70b9\u4e0a\u90fd\u6ca1\u6709\u76f8\u5e94\u7684\u7f13\u5b58\u5206\u533a\uff0c\u90a3\u4e48\u4efb\u52a1\u9700\u8981\u544a\u8bc9\u8c03\u5ea6\u5668\u8ba1\u7b97\u54ea\u4e9bRDD\u6765\u5b8c\u6210\u67e5\u627e\u64cd\u4f5c\u3002</p>\u000a<h3>5.3 \u68c0\u67e5\u70b9</h3>\u000a<p>\u5c3d\u7ba1RDD\u4e2d\u7684Lineage\u4fe1\u606f\u53ef\u4ee5\u7528\u6765\u6545\u969c\u6062\u590d\uff0c\u4f46\u5bf9\u4e8e\u90a3\u4e9bLineage\u94fe\u8f83\u957f\u7684RDD\u6765\u8bf4\uff0c\u8fd9\u79cd\u6062\u590d\u53ef\u80fd\u5f88\u8017\u65f6\u3002\u4f8b\u59824.3\u5c0f\u8282\u4e2d\u7684Pregel\u4efb\u52a1\uff0c\u6bcf\u6b21\u8fed\u4ee3\u7684\u9876\u70b9\u72b6\u6001\u548c\u6d88\u606f\u90fd\u8ddf\u524d\u4e00\u6b21\u8fed\u4ee3\u6709\u5173\uff0c\u6240\u4ee5Lineage\u94fe\u5f88\u957f\u3002\u5982\u679c\u5c06Lineage\u94fe\u5b58\u5230\u7269\u7406\u5b58\u50a8\u4e2d\uff0c\u518d\u5b9a\u671f\u5bf9RDD\u6267\u884c\u68c0\u67e5\u70b9\u64cd\u4f5c\u5c31\u5f88\u6709\u6548\u3002</p>\u000a<p>\u4e00\u822c\u6765\u8bf4\uff0cLineage\u94fe\u8f83\u957f\u3001\u5bbd\u4f9d\u8d56\u7684RDD\u9700\u8981\u91c7\u7528\u68c0\u67e5\u70b9\u673a\u5236\u3002\u8fd9\u79cd\u60c5\u51b5\u4e0b\uff0c\u96c6\u7fa4\u7684\u8282\u70b9\u6545\u969c\u53ef\u80fd\u5bfc\u81f4\u6bcf\u4e2a\u7236RDD\u7684\u6570\u636e\u5757\u4e22\u5931\uff0c\u56e0\u6b64\u9700\u8981\u5168\u90e8\u91cd\u65b0\u8ba1\u7b97[20]\u3002\u5c06\u7a84\u4f9d\u8d56\u7684RDD\u6570\u636e\u5b58\u5230\u7269\u7406\u5b58\u50a8\u4e2d\u53ef\u4ee5\u5b9e\u73b0\u4f18\u5316\uff0c\u4f8b\u5982\u524d\u97624.1\u5c0f\u8282\u903b\u8f91\u56de\u5f52\u7684\u4f8b\u5b50\uff0c\u5c06\u6570\u636e\u70b9\u548c\u4e0d\u53d8\u7684\u9876\u70b9\u72b6\u6001\u5b58\u50a8\u8d77\u6765\uff0c\u5c31\u4e0d\u518d\u9700\u8981\u68c0\u67e5\u70b9\u64cd\u4f5c\u3002</p>\u000a<p>\u5f53\u524dSpark\u7248\u672c\u63d0\u4f9b\u68c0\u67e5\u70b9API\uff0c\u4f46\u7531\u7528\u6237\u51b3\u5b9a\u662f\u5426\u9700\u8981\u6267\u884c\u68c0\u67e5\u70b9\u64cd\u4f5c\u3002\u4eca\u540e\u6211\u4eec\u5c06\u5b9e\u73b0\u81ea\u52a8\u68c0\u67e5\u70b9\uff0c\u6839\u636e\u6210\u672c\u6548\u76ca\u5206\u6790\u786e\u5b9aRDD Lineage\u56fe\u4e2d\u7684\u6700\u4f73\u68c0\u67e5\u70b9\u4f4d\u7f6e\u3002</p>\u000a<p>\u503c\u5f97\u6ce8\u610f\u7684\u662f\uff0c\u56e0\u4e3aRDD\u662f\u53ea\u8bfb\u7684\uff0c\u6240\u4ee5\u4e0d\u9700\u8981\u4efb\u4f55\u4e00\u81f4\u6027\u7ef4\u62a4\uff08\u4f8b\u5982\u5199\u590d\u5236\u7b56\u7565\uff0c\u5206\u5e03\u5f0f\u5feb\u7167\u6216\u8005\u7a0b\u5e8f\u6682\u505c\u7b49\uff09\u5e26\u6765\u7684\u5f00\u9500\uff0c\u540e\u53f0\u6267\u884c\u68c0\u67e5\u70b9\u64cd\u4f5c\u3002</p>\u000a<p>\u6211\u4eec\u4f7f\u752810000\u884cScala\u4ee3\u7801\u5b9e\u73b0\u4e86Spark\u3002\u7cfb\u7edf\u53ef\u4ee5\u4f7f\u7528\u4efb\u4f55Hadoop\u6570\u636e\u6e90\uff08\u5982HDFS\uff0cHbase\uff09\u4f5c\u4e3a\u8f93\u5165\uff0c\u8fd9\u6837\u5f88\u5bb9\u6613\u4e0eHadoop\u73af\u5883\u96c6\u6210\u3002Spark\u4ee5\u5e93\u7684\u5f62\u5f0f\u5b9e\u73b0\uff0c\u4e0d\u9700\u8981\u4fee\u6539Scala\u7f16\u8bd1\u5668\u3002</p>\u000a<p>\u8fd9\u91cc\u8ba8\u8bba\u5173\u4e8e\u5b9e\u73b0\u7684\u4e09\u65b9\u9762\u95ee\u9898\uff1a\uff081\uff09\u4fee\u6539Scala\u89e3\u91ca\u5668\uff0c\u5141\u8bb8\u4ea4\u4e92\u6a21\u5f0f\u4f7f\u7528Spark\uff086.1\uff09\uff1b\uff082\uff09\u7f13\u5b58\u7ba1\u7406\uff086.2\uff09\uff1b\uff083\uff09\u8c03\u8bd5\u5de5\u5177rddbg\uff086.3\uff09\u3002</p>\u000a<h2>6. \u5b9e\u73b0</h2>\u000a<h3>6.1 \u89e3\u91ca\u5668\u7684\u96c6\u6210</h3>\u000a<p>\u50cfRuby\u548cPython\u4e00\u6837\uff0cScala\u4e5f\u6709\u4e00\u4e2a\u4ea4\u4e92\u5f0fshell\u3002\u57fa\u4e8e\u5185\u5b58\u7684\u6570\u636e\u53ef\u4ee5\u5b9e\u73b0\u4f4e\u5ef6\u65f6\uff0c\u6211\u4eec\u5e0c\u671b\u5141\u8bb8\u7528\u6237\u4ece\u89e3\u91ca\u5668\u4ea4\u4e92\u5f0f\u5730\u8fd0\u884cSpark\uff0c\u4ece\u800c\u5728\u5927\u6570\u636e\u96c6\u4e0a\u5b9e\u73b0\u5927\u89c4\u6a21\u5e76\u884c\u6570\u636e\u6316\u6398\u3002</p>\u000a<p>Scala\u89e3\u91ca\u5668\u901a\u5e38\u6839\u636e\u5c06\u7528\u6237\u8f93\u5165\u7684\u4ee3\u7801\u884c\uff0c\u6765\u5bf9\u7c7b\u8fdb\u884c\u7f16\u8bd1\uff0c\u63a5\u7740\u88c5\u8f7d\u5230JVM\u4e2d\uff0c\u7136\u540e\u8c03\u7528\u7c7b\u7684\u51fd\u6570\u3002\u8fd9\u4e2a\u7c7b\u662f\u4e00\u4e2a\u5305\u542b\u8f93\u5165\u884c\u53d8\u91cf\u6216\u51fd\u6570\u7684\u5355\u4f8b\u5bf9\u8c61\uff0c\u5e76\u5728\u4e00\u4e2a\u521d\u59cb\u5316\u51fd\u6570\u4e2d\u8fd0\u884c\u8fd9\u884c\u4ee3\u7801\u3002\u4f8b\u5982\uff0c\u5982\u679c\u7528\u6237\u8f93\u5165\u4ee3\u7801var x = 5\uff0c\u63a5\u7740\u53c8\u8f93\u5165println(x)\uff0c\u5219\u89e3\u91ca\u5668\u4f1a\u5b9a\u4e49\u4e00\u4e2a\u5305\u542bx\u7684Line1\u7c7b\uff0c\u5e76\u5c06\u7b2c2\u884c\u7f16\u8bd1\u4e3aprintln(Line1.getInstance().x)\u3002</p>\u000a<p>\u5728Spark\u4e2d\u6211\u4eec\u5bf9\u89e3\u91ca\u5668\u505a\u4e86\u4e24\u70b9\u6539\u52a8\uff1a</p>\u000a<ol>\u000a<li>\u7c7b\u4f20\u8f93\uff1a\u89e3\u91ca\u5668\u80fd\u591f\u652f\u6301\u57fa\u4e8eHTTP\u4f20\u8f93\u7c7b\u5b57\u8282\u7801\uff0c\u8fd9\u6837worker\u8282\u70b9\u5c31\u80fd\u83b7\u53d6\u8f93\u5165\u6bcf\u884c\u4ee3\u7801\u5bf9\u5e94\u7684\u7c7b\u7684\u5b57\u8282\u7801\u3002</li>\u000a<li>\u6539\u8fdb\u7684\u4ee3\u7801\u751f\u6210\u903b\u8f91\uff1a\u901a\u5e38\u6bcf\u884c\u4e0a\u521b\u5efa\u7684\u5355\u6001\u5bf9\u8c61\u901a\u8fc7\u5bf9\u5e94\u7c7b\u4e0a\u7684\u9759\u6001\u65b9\u6cd5\u8fdb\u884c\u8bbf\u95ee\u3002\u4e5f\u5c31\u662f\u8bf4\uff0c\u5982\u679c\u8981\u5e8f\u5217\u5316\u4e00\u4e2a\u95ed\u5305\uff0c\u5b83\u5f15\u7528\u4e86\u524d\u9762\u4ee3\u7801\u884c\u4e2d\u53d8\u91cf\uff0c\u6bd4\u5982\u4e0a\u9762\u7684\u4f8b\u5b50Line1.x\uff0cJava\u4e0d\u4f1a\u6839\u636e\u5bf9\u8c61\u5173\u7cfb\u4f20\u8f93\u5305\u542bx\u7684Line1\u5b9e\u4f8b\u3002\u6240\u4ee5worker\u8282\u70b9\u4e0d\u4f1a\u6536\u5230x\u3002\u6211\u4eec\u5c06\u8fd9\u79cd\u4ee3\u7801\u751f\u6210\u903b\u8f91\u6539\u4e3a\u76f4\u63a5\u5f15\u7528\u5404\u4e2a\u884c\u5bf9\u8c61\u7684\u5b9e\u4f8b\u3002\u56fe7\u8bf4\u660e\u4e86\u89e3\u91ca\u5668\u5982\u4f55\u5c06\u7528\u6237\u8f93\u5165\u7684\u4e00\u7ec4\u4ee3\u7801\u884c\u89e3\u91ca\u4e3aJava\u5bf9\u8c61\u3002</li>\u000a</ol>\u000a<p><img class="alignnone size-full wp-image-754" alt="f7-spark-interpreter-translation" src="http://shiyanjuncn.b0.upaiyun.com/wp-content/uploads/2014/03/f7-spark-interpreter-translation.png" width="490" height="302" /><br />\u000a<span style="font-size: small;text-indent: 20px"><strong>\u56fe7</strong> Spark\u89e3\u91ca\u5668\u5982\u4f55\u5c06\u7528\u6237\u8f93\u5165\u7684\u4e24\u884c\u4ee3\u7801\u89e3\u91ca\u4e3aJava\u5bf9\u8c61</span><br />\u000aSpark\u89e3\u91ca\u5668\u4fbf\u4e8e\u8ddf\u8e2a\u5904\u7406\u5927\u91cf\u5bf9\u8c61\u5173\u7cfb\u5f15\u7528\uff0c\u5e76\u4e14\u4fbf\u5229\u4e86HDFS\u6570\u636e\u96c6\u7684\u7814\u7a76\u3002\u6211\u4eec\u8ba1\u5212\u4ee5Spark\u89e3\u91ca\u5668\u4e3a\u57fa\u7840\uff0c\u5f00\u53d1\u63d0\u4f9b\u9ad8\u7ea7\u6570\u636e\u5206\u6790\u8bed\u8a00\u652f\u6301\u7684\u4ea4\u4e92\u5f0f\u5de5\u5177\uff0c\u6bd4\u5982\u7c7b\u4f3cSQL\u548cMatlab\u3002</p>\u000a<h3>6.2 \u7f13\u5b58\u7ba1\u7406</h3>\u000a<p>Worker\u8282\u70b9\u5c06RDD\u5206\u533a\u4ee5Java\u5bf9\u8c61\u7684\u5f62\u5f0f\u7f13\u5b58\u5728\u5185\u5b58\u4e2d\u3002\u7531\u4e8e\u5927\u90e8\u5206\u64cd\u4f5c\u662f\u57fa\u4e8e\u626b\u63cf\u7684\uff0c\u91c7\u53d6RDD\u7ea7\u7684LRU\uff08\u6700\u8fd1\u6700\u5c11\u4f7f\u7528\uff09\u66ff\u6362\u7b56\u7565\uff08\u5373\u4e0d\u4f1a\u4e3a\u4e86\u88c5\u8f7d\u4e00\u4e2aRDD\u5206\u533a\u800c\u5c06\u540c\u4e00RDD\u7684\u5176\u4ed6\u5206\u533a\u66ff\u6362\u51fa\u53bb\uff09\u3002\u76ee\u524d\u8fd9\u79cd\u7b80\u5355\u7684\u7b56\u7565\u9002\u5408\u5927\u591a\u6570\u7528\u6237\u5e94\u7528\u3002\u53e6\u5916\uff0c\u4f7f\u7528\u5e26\u53c2\u6570\u7684cache\u64cd\u4f5c\u53ef\u4ee5\u8bbe\u5b9aRDD\u7684\u7f13\u5b58\u4f18\u5148\u7ea7\u3002</p>\u000a<h3>6.3 rddbg\uff1aRDD\u7a0b\u5e8f\u7684\u8c03\u8bd5\u5de5\u5177</h3>\u000a<p>RDD\u7684\u521d\u8877\u662f\u4e3a\u4e86\u5b9e\u73b0\u5bb9\u9519\u4ee5\u80fd\u591f\u518d\u8ba1\u7b97\uff08re-computation\uff09\uff0c\u8fd9\u4e2a\u7279\u6027\u4f7f\u5f97\u8c03\u8bd5\u66f4\u5bb9\u6613\u3002\u6211\u4eec\u521b\u5efa\u4e86\u4e00\u4e2a\u540d\u4e3arddbg\u7684\u8c03\u8bd5\u5de5\u5177\uff0c\u5b83\u662f\u901a\u8fc7\u57fa\u4e8e\u7a0b\u5e8f\u8bb0\u5f55\u7684Lineage\u4fe1\u606f\u6765\u5b9e\u73b0\u7684\uff0c\u5141\u8bb8\u7528\u6237\uff1a\uff081\uff09\u91cd\u5efa\u4efb\u4f55\u7531\u7a0b\u5e8f\u521b\u5efa\u7684RDD\uff0c\u5e76\u6267\u884c\u4ea4\u4e92\u5f0f\u67e5\u8be2\uff1b\uff082\uff09\u4f7f\u7528\u4e00\u4e2a\u5355\u8fdb\u7a0bJava\u8c03\u8bd5\u5668\uff08\u5982jdb\uff09\u4f20\u5165\u8ba1\u7b97\u597d\u7684RDD\u5206\u533a\uff0c\u80fd\u591f\u91cd\u65b0\u8fd0\u884c\u4f5c\u4e1a\u4e2d\u7684\u4efb\u4f55\u4efb\u52a1\u3002</p>\u000a<p>\u6211\u4eec\u5f3a\u8c03\u4e00\u4e0b\uff0crddbg\u4e0d\u662f\u4e00\u4e2a\u5b8c\u5168\u91cd\u653e\u7684\u8c03\u8bd5\u5668\uff1a\u7279\u522b\u662f\u4e0d\u5bf9\u975e\u786e\u5b9a\u6027\u7684\u4ee3\u7801\u6216\u52a8\u4f5c\u8fdb\u884c\u91cd\u653e\u3002\u4f46\u5982\u679c\u67d0\u4e2a\u4efb\u52a1\u4e00\u76f4\u8fd0\u884c\u5f88\u6162\uff08\u6bd4\u5982\u7531\u4e8e\u6570\u636e\u5206\u5e03\u4e0d\u5747\u5300\u6216\u8005\u5f02\u5e38\u8f93\u5165\u7b49\u539f\u56e0\uff09\uff0c\u4ecd\u7136\u53ef\u4ee5\u7528\u5b83\u6765\u5e2e\u52a9\u627e\u5230\u5176\u4e2d\u7684\u903b\u8f91\u9519\u8bef\u548c\u6027\u80fd\u95ee\u9898\u3002</p>\u000a<p>\u4e3e\u4e2a\u4f8b\u5b50\uff0c\u6211\u4eec\u4f7f\u7528rddbg\u53bb\u89e3\u51b3\u7528\u6237Spam\u5206\u7c7b\u4f5c\u4e1a\u4e2d\u7684\u4e00\u4e2abug\uff0c\u8fd9\u4e2a\u4f5c\u4e1a\u4e2d\u7684\u6bcf\u6b21\u8fed\u4ee3\u90fd\u4ea7\u751f0\u503c\u3002\u5728\u8c03\u8bd5\u5668\u4e2d\u91cd\u65b0\u6267\u884creduce\u4efb\u52a1\uff0c\u5f88\u5feb\u5c31\u80fd\u53d1\u73b0\uff0c\u8f93\u5165\u7684\u6743\u91cd\u5411\u91cf\uff08\u5b58\u50a8\u5728\u4e00\u4e2a\u7528\u6237\u81ea\u5b9a\u4e49\u7684\u5411\u91cf\u7c7b\u4e2d\uff09\u7adf\u7136\u662f\u7a7a\u503c\u3002\u7531\u4e8e\u4ece\u4e00\u4e2a\u672a\u521d\u59cb\u5316\u7684\u7a00\u758f\u5411\u91cf\u4e2d\u8bfb\u53d6\u603b\u662f\u8fd4\u56de0\uff0c\u8fd0\u884c\u65f6\u4e5f\u4e0d\u4f1a\u629b\u51fa\u5f02\u5e38\u3002\u5728\u8fd9\u4e2a\u5411\u91cf\u7c7b\u4e2d\u8bbe\u7f6e\u4e00\u4e2a\u65ad\u70b9\uff0c\u7136\u540e\u8fd0\u884c\u8fd9\u4e2a\u4efb\u52a1\uff0c\u5f15\u5bfc\u7a0b\u5e8f\u5f88\u5feb\u5c31\u8fd0\u884c\u5230\u8bbe\u7f6e\u7684\u65ad\u70b9\u5904\uff0c\u6211\u4eec\u53d1\u73b0\u5411\u91cf\u7c7b\u7684\u4e00\u4e2a\u6570\u7ec4\u5b57\u6bb5\u7684\u503c\u4e3a\u7a7a\uff0c\u6211\u4eec\u8bca\u65ad\u51fa\u4e86\u8fd9\u4e2abug\uff1a\u7a00\u758f\u5411\u91cf\u7c7b\u4e2d\u7684\u6570\u636e\u5b57\u6bb5\u88ab\u9519\u8bef\u5730\u4f7f\u7528transient\u6765\u4fee\u9970\uff0c\u5bfc\u81f4\u5e8f\u5217\u5316\u65f6\u5ffd\u7565\u4e86\u8be5\u5b57\u6bb5\u7684\u6570\u636e\u3002</p>\u000a<p>rddbg\u7ed9\u7a0b\u5e8f\u6267\u884c\u5e26\u6765\u7684\u5f00\u9500\u5f88\u5c0f\u3002\u7a0b\u5e8f\u672c\u6765\u5c31\u9700\u8981\u5c06\u5404\u4e2aRDD\u4e2d\u7684\u6240\u6709\u95ed\u5305\u5e8f\u5217\u5316\u5e76\u901a\u8fc7\u7f51\u7edc\u4f20\u9001\uff0c\u53ea\u4e0d\u8fc7\u4f7f\u7528rddbg\u540c\u65f6\u8fd8\u8981\u5c06\u8fd9\u4e9b\u95ed\u96c6\u8bb0\u5f55\u5230\u78c1\u76d8\u3002</p>\u000a<h2>7. \u8bc4\u4f30</h2>\u000a<p>\u6211\u4eec\u5728Amazon EC2[1]\u4e0a\u8fdb\u884c\u4e86\u4e00\u7cfb\u5217\u5b9e\u9a8c\u6765\u8bc4\u4f30Spark\u53caRDD\u7684\u6027\u80fd\uff0c\u5e76\u4e0eHadoop\u53ca\u5176\u4ed6\u5e94\u7528\u7a0b\u5e8f\u7684\u57fa\u51c6\u8fdb\u884c\u4e86\u5bf9\u6bd4\u3002\u603b\u7684\u8bf4\u6765\uff0c\u7ed3\u679c\u5982\u4e0b\uff1a<br />\u000a\uff081\uff09\u5bf9\u4e8e\u8fed\u4ee3\u5f0f\u673a\u5668\u5b66\u4e60\u5e94\u7528\uff0cSpark\u6bd4Hadoop\u5feb20\u591a\u500d\u3002\u8fd9\u79cd\u52a0\u901f\u6bd4\u662f\u56e0\u4e3a\uff1a\u6570\u636e\u5b58\u50a8\u5728\u5185\u5b58\u4e2d\uff0c\u540c\u65f6Java\u5bf9\u8c61\u7f13\u5b58\u907f\u514d\u4e86\u53cd\u5e8f\u5217\u5316\u64cd\u4f5c\u3002<br />\u000a\uff082\uff09\u7528\u6237\u7f16\u5199\u7684\u5e94\u7528\u7a0b\u5e8f\u6267\u884c\u7ed3\u679c\u5f88\u597d\u3002\u4f8b\u5982\uff0cSpark\u5206\u6790\u62a5\u8868\u6bd4Hadoop\u5feb40\u591a\u500d\u3002<br />\u000a\uff083\uff09\u5982\u679c\u8282\u70b9\u53d1\u751f\u5931\u6548\uff0c\u901a\u8fc7\u91cd\u5efa\u90a3\u4e9b\u4e22\u5931\u7684RDD\u5206\u533a\uff0cSpark\u80fd\u591f\u5b9e\u73b0\u5feb\u901f\u6062\u590d\u3002<br />\u000a\uff084\uff09Spark\u80fd\u591f\u57285-7s\u5ef6\u65f6\u8303\u56f4\u5185\uff0c\u4ea4\u4e92\u5f0f\u5730\u67e5\u8be21TB\u5927\u5c0f\u7684\u6570\u636e\u96c6\u3002<br />\u000a\u6211\u4eec\u57fa\u51c6\u6d4b\u8bd5\u9996\u5148\u4ece\u4e00\u4e2a\u8fd0\u884c\u5728Hadoop\u4e0a\u7684\u5177\u6709\u8fed\u4ee3\u7279\u5f81\u7684\u673a\u5668\u5b66\u4e60\u5e94\u7528\uff087.1\uff09\u548cPageRank\uff087.2\uff09\u5f00\u59cb\uff0c\u7136\u540e\u8bc4\u4f30\u5728Spark\u4e2d\u5f53\u5de5\u4f5c\u96c6\u4e0d\u80fd\u9002\u5e94\u7f13\u5b58\uff087.4\uff09\u65f6\u7cfb\u7edf\u5bb9\u9519\u6062\u590d\u80fd\u529b\uff087.3\uff09\uff0c\u6700\u540e\u8ba8\u8bba\u7528\u6237\u5e94\u7528\u7a0b\u5e8f\uff087.5\uff09\u548c\u4ea4\u4e92\u5f0f\u6570\u636e\u6316\u6398\uff087.6\uff09\u7684\u7ed3\u679c\u3002<br />\u000a\u9664\u975e\u7279\u6b8a\u8bf4\u660e\uff0c\u6211\u4eec\u7684\u5b9e\u9a8c\u4f7f\u7528m1.xlarge EC2 \u8282\u70b9\uff0c4\u683815GB\u5185\u5b58\uff0c\u4f7f\u7528HDFS\u4f5c\u4e3a\u6301\u4e45\u5b58\u50a8\uff0c\u5757\u5927\u5c0f\u4e3a256M\u3002\u5728\u6bcf\u4e2a\u4f5c\u4e1a\u8fd0\u884c\u6267\u884c\u65f6\uff0c\u4e3a\u4e86\u4fdd\u8bc1\u78c1\u76d8\u8bfb\u65f6\u95f4\u66f4\u52a0\u7cbe\u786e\uff0c\u6211\u4eec\u6e05\u7406\u4e86\u96c6\u7fa4\u4e2d\u6bcf\u4e2a\u8282\u70b9\u7684\u64cd\u4f5c\u7cfb\u7edf\u7f13\u5b58\u3002</p>\u000a<h3>7.1 \u53ef\u8fed\u4ee3\u7684\u673a\u5668\u5b66\u4e60\u5e94\u7528</h3>\u000a<p>\u6211\u4eec\u5b9e\u73b0\u4e862\u4e2a\u8fed\u4ee3\u5f0f\u673a\u5668\u5b66\u4e60\uff08ML\uff09\u5e94\u7528\uff0cLogistic\u56de\u5f52\u548cK-means\u7b97\u6cd5\uff0c\u4e0e\u5982\u4e0b\u7cfb\u7edf\u8fdb\u884c\u6027\u80fd\u5bf9\u6bd4\uff1a</p>\u000a<ul>\u000a<li><i>Hadoop</i>\uff1aHadoop 0.20.0\u7a33\u5b9a\u7248\u3002</li>\u000a<li><i>HadoopBinMem</i>\uff1a\u5728\u9996\u8f6e\u8fed\u4ee3\u4e2d\u6267\u884c\u9884\u5904\u7406\uff0c\u901a\u8fc7\u5c06\u8f93\u5165\u6570\u636e\u8f6c\u6362\u6210\u4e3a\u5f00\u9500\u8f83\u4f4e\u7684\u4e8c\u8fdb\u5236\u683c\u5f0f\u6765\u51cf\u5c11\u540e\u7eed\u8fed\u4ee3\u8fc7\u7a0b\u4e2d\u6587\u672c\u89e3\u6790\u7684\u5f00\u9500\uff0c\u5728HDFS\u4e2d\u52a0\u8f7d\u5230\u5185\u5b58\u3002</li>\u000a<li><i>Spark</i>\uff1a\u57fa\u4e8eRDD\u7684\u7cfb\u7edf\uff0c\u5728\u9996\u8f6e\u8fed\u4ee3\u4e2d\u7f13\u5b58Java\u5bf9\u8c61\u4ee5\u51cf\u5c11\u540e\u7eed\u8fed\u4ee3\u8fc7\u7a0b\u4e2d\u89e3\u6790\u3001\u53cd\u5e8f\u5217\u5316\u7684\u5f00\u9500\u3002</li>\u000a</ul>\u000a<p>\u6211\u4eec\u4f7f\u7528\u540c\u4e00\u6570\u636e\u96c6\u5728\u76f8\u540c\u6761\u4ef6\u4e0b\u8fd0\u884cLogistic\u56de\u5f52\u548cK-means\u7b97\u6cd5\uff1a\u4f7f\u7528400\u4e2a\u4efb\u52a1\uff08\u6bcf\u4e2a\u4efb\u52a1\u5904\u7406\u7684\u8f93\u5165\u6570\u636e\u5757\u5927\u5c0f\u4e3a256M\uff09\uff0c\u572825-100\u53f0\u673a\u5668\uff0c\u6267\u884c10\u6b21\u8fed\u4ee3\u5904\u7406100G\u8f93\u5165\u6570\u636e\u96c6\uff08\u88684\uff09\u3002\u4e24\u4e2a\u4f5c\u4e1a\u7684\u5173\u952e\u533a\u522b\u5728\u4e8e\u6bcf\u8f6e\u8fed\u4ee3\u5355\u4e2a\u5b57\u8282\u7684\u8ba1\u7b97\u91cf\u4e0d\u540c\u3002K-means\u7684\u8fed\u4ee3\u65f6\u95f4\u53d6\u51b3\u4e8e\u66f4\u65b0\u805a\u7c7b\u5750\u6807\u8017\u65f6\uff0cLogistic\u56de\u5f52\u662f\u975e\u8ba1\u7b97\u5bc6\u96c6\u578b\u7684\uff0c\u4f46\u662f\u5728\u5e8f\u5217\u5316\u548c\u89e3\u6790\u8fc7\u7a0b\u4e2d\u975e\u5e38\u8017\u65f6\u3002<br />\u000a\u7531\u4e8e\u5178\u578b\u7684\u673a\u5668\u5b66\u4e60\u7b97\u6cd5\u9700\u8981\u657010\u8f6e\u8fed\u4ee3\uff0c\u7136\u540e\u518d\u5408\u5e76\uff0c\u6211\u4eec\u5206\u522b\u7edf\u8ba1\u4e86\u9996\u8f6e\u8fed\u4ee3\u548c\u540e\u7eed\u8fed\u4ee3\u8ba1\u7b97\u7684\u8017\u65f6\uff0c\u5e76\u4ece\u4e2d\u53d1\u73b0\uff0c\u5728\u5185\u5b58\u4e2d\u7f13\u5b58RDD\u6781\u5927\u5730\u52a0\u5feb\u4e86\u540e\u7eed\u8fed\u4ee3\u7684\u901f\u5ea6\u3002</p>\u000a<table style="border: solid thin #868686" width="100%" border="1" cellspacing="0" cellpadding="2">\u000a<caption style="text-align:center"><strong>\u88684</strong> \u7528\u4e8eSpark\u57fa\u51c6\u7a0b\u5e8f\u7684\u6570\u636e</caption>\u000a<tbody>\u000a<tr>\u000a<td style="width: 68.62px;text-align: center;border: solid thin #868686" valign="top"><b>\u5e94\u7528</b></td>\u000a<td style="width: 60.21px;text-align: center;border: solid thin #868686" valign="top"><b>\u6570\u636e\u63cf\u8ff0</b></td>\u000a<td style="width: 60.21px;text-align: center;border: solid thin #868686" valign="top"><b>\u5927\u5c0f</b></td>\u000a</tr>\u000a<tr>\u000a<td style="width: 68.62px;border: solid thin #868686" valign="top">Logistic\u56de\u5f52</td>\u000a<td style="width: 60.21px;border: solid thin #868686" valign="top">10\u4ebf9\u7ef4\u70b9\u6570\u636e</td>\u000a<td style="width: 60.21px;border: solid thin #868686" valign="top">100G</td>\u000a</tr>\u000a<tr>\u000a<td style="width: 68.62px;border: solid thin #868686" valign="top">K-means</td>\u000a<td style="width: 60.21px;border: solid thin #868686" valign="top">10\u4ebf10\u7ef4\u70b9\u6570\u636e\uff08k=10\uff09</td>\u000a<td style="width: 60.21px;border: solid thin #868686" valign="top">100G</td>\u000a</tr>\u000a<tr>\u000a<td style="width: 68.62px;border: solid thin #868686" valign="top">PageRank</td>\u000a<td style="width: 60.21px;border: solid thin #868686" valign="top">400\u4e07Wikipedia\u6587\u7ae0\u8d85\u94fe\u63a5\u56fe</td>\u000a<td style="width: 60.21px;border: solid thin #868686" valign="top">49G</td>\u000a</tr>\u000a<tr>\u000a<td style="width: 68.62px;border: solid thin #868686" valign="top">\u4ea4\u4e92\u5f0f\u6570\u636e\u6316\u6398</td>\u000a<td style="width: 60.21px;border: solid thin #868686" valign="top">Wikipedia\u6d4f\u89c8\u65e5\u5fd7\uff082008-10~2009-4\uff09</td>\u000a<td style="width: 60.21px;border: solid thin #868686" valign="top">1TB</td>\u000a</tr>\u000a</tbody>\u000a</table>\u000a<p><strong>\u9996\u8f6e\u8fed\u4ee3</strong>\u3002\u5728\u9996\u8f6e\u8fed\u4ee3\u8fc7\u7a0b\u4e2d\uff0c\u4e09\u4e2a\u7cfb\u7edf\u90fd\u662f\u4eceHDFS\u4e2d\u8bfb\u53d6\u6587\u672c\u6570\u636e\u4f5c\u4e3a\u8f93\u5165\u3002\u56fe9\u4e2d\u201cFirst Iteration\u201d\u663e\u793a\u4e86\u9996\u8f6e\u8fed\u4ee3\u7684\u67f1\u72b6\u56fe\uff0c\u5b9e\u9a8c\u4e2dSpark\u5feb\u4e8eHadoop\uff0c\u4e3b\u8981\u662f\u56e0\u4e3aHadoop\u4e2d\u7684\u5404\u4e2a\u5206\u5e03\u5f0f\u7ec4\u4ef6\u57fa\u4e8e\u5fc3\u8df3\u534f\u8bae\u6765\u53d1\u9001\u4fe1\u53f7\u5e26\u6765\u4e86\u5f00\u9500\u3002HadoopBinMem\u662f\u6700\u6162\u7684\uff0c\u56e0\u4e3a\u5b83\u901a\u8fc7\u4e00\u4e2a\u989d\u5916\u7684MapReduce\u4f5c\u4e1a\u5c06\u6570\u636e\u8f6c\u6362\u6210\u4e8c\u8fdb\u5236\u683c\u5f0f\u3002<br />\u000a<img class="alignnone size-full wp-image-755" alt="f8-first-iteration-bars" src="http://shiyanjuncn.b0.upaiyun.com/wp-content/uploads/2014/03/f8-first-iteration-bars.png" width="476" height="280" /><br />\u000a<span style="font-size: small;text-indent: 20px"><strong>\u56fe8</strong> \u9996\u8f6e\u8fed\u4ee3\u540eHadoop\u3001HadoopBinMen\u3001Spark\u8fd0\u884c\u65f6\u95f4\u5bf9\u6bd4</span></p>\u000a<p><strong>\u540e\u7eed\u8fed\u4ee3</strong>\u3002\u56fe9\u663e\u793a\u4e86\u540e\u7eed\u8fed\u4ee3\u7684\u5e73\u5747\u8017\u65f6\uff0c\u56fe8\u5bf9\u6bd4\u4e86\u4e0d\u540c\u805a\u7c7b\u5927\u5c0f\u6761\u4ef6\u4e0b\u8017\u65f6\u60c5\u51b5\uff0c\u6211\u4eec\u53d1\u73b0\u5728100\u4e2a\u8282\u70b9\u4e0a\u8fd0\u884cLogistic\u56de\u5f52\u7a0b\u5e8f\uff0cSpark\u6bd4Hadoop\u3001HadoopBinMem\u5206\u522b\u5feb25.3\u300120.7\u500d\u3002\u4ece\u56fe8\uff08b\uff09\u53ef\u4ee5\u770b\u5230\uff0cSpark\u4ec5\u4ec5\u6bd4Hadoop\u3001HadoopBinMem\u5206\u522b\u5feb1.9\u30013.2\u500d\uff0c\u8fd9\u662f\u56e0\u4e3aK-means\u7a0b\u5e8f\u7684\u5f00\u9500\u53d6\u51b3\u4e8e\u8ba1\u7b97\uff08\u7528\u66f4\u591a\u7684\u8282\u70b9\u6709\u52a9\u4e8e\u63d0\u9ad8\u8ba1\u7b97\u901f\u5ea6\u7684\u500d\u6570\uff09\u3002</p>\u000a<p>\u540e\u7eed\u8fed\u4ee3\u4e2d\uff0cHadoop\u4ecd\u7136\u4eceHDFS\u8bfb\u53d6\u6587\u672c\u6570\u636e\u4f5c\u4e3a\u8f93\u5165\uff0c\u6240\u4ee5\u4ece\u9996\u8f6e\u8fed\u4ee3\u5f00\u59cbHadoop\u7684\u8fed\u4ee3\u65f6\u95f4\u5e76\u6ca1\u6709\u660e\u663e\u7684\u6539\u5584\u3002\u4f7f\u7528\u9884\u5148\u8f6c\u6362\u7684SequenceFile\u6587\u4ef6\uff08Hadoop\u5185\u5efa\u7684\u4e8c\u8fdb\u5236\u6587\u4ef6\u683c\u5f0f\uff09\uff0cHadoopBinMem\u5728\u540e\u7eed\u8fed\u4ee3\u4e2d\u8282\u7701\u4e86\u89e3\u6790\u7684\u4ee3\u4ef7\uff0c\u4f46\u662f\u4ecd\u7136\u5e26\u6765\u7684\u5176\u4ed6\u7684\u5f00\u9500\uff0c\u5982\u4eceHDFS\u8bfbSequenceFile\u6587\u4ef6\u5e76\u8f6c\u6362\u6210Java\u5bf9\u8c61\u3002\u56e0\u4e3aSpark\u76f4\u63a5\u8bfb\u53d6\u7f13\u5b58\u4e8eRDD\u4e2d\u7684Java\u5bf9\u8c61\uff0c\u968f\u7740\u805a\u7c7b\u5c3a\u5bf8\u7684\u7ebf\u6027\u589e\u957f\uff0c\u8fed\u4ee3\u65f6\u95f4\u5927\u5e45\u4e0b\u964d\u3002<br />\u000a<img class="alignnone size-full wp-image-756" alt="f9-length-of-first-and-later-iterations" src="http://shiyanjuncn.b0.upaiyun.com/wp-content/uploads/2014/03/f9-length-of-first-and-later-iterations.png" width="453" height="197" /><br />\u000a<span style="font-size: small;text-indent: 20px">\u56fe9\uff1a\u9996\u8f6e\u53ca\u5176\u540e\u7eed\u8fed\u4ee3\u5e73\u5747\u65f6\u95f4\u5bf9\u6bd4</span><br />\u000a<strong>\u7406\u89e3\u901f\u5ea6\u63d0\u5347</strong>\u3002\u6211\u4eec\u975e\u5e38\u60ca\u5947\u5730\u53d1\u73b0\uff0cSpark\u751a\u81f3\u80dc\u8fc7\u4e86\u57fa\u4e8e\u5185\u5b58\u5b58\u50a8\u4e8c\u8fdb\u5236\u6570\u636e\u7684Hadoop\uff08HadoopBinMem\uff09\uff0c\u5e45\u5ea6\u9ad8\u8fbe20\u500d\u4e4b\u591a\uff0cHadoop\u8fd0\u884c\u6162\u662f\u7531\u4e8e\u5982\u4e0b\u51e0\u4e2a\u539f\u56e0\uff1a</p>\u000a<ol>\u000a<li>Hadoop\u8f6f\u4ef6\u6808\u7684\u6700\u5c0f\u5f00\u9500</li>\u000a<li>\u8bfb\u6570\u636e\u65f6HDFS\u6808\u7684\u5f00\u9500</li>\u000a<li>\u5c06\u4e8c\u8fdb\u5236\u8bb0\u5f55\u8f6c\u6362\u6210\u5185\u5b58Java\u5bf9\u8c61\u7684\u4ee3\u4ef7</li>\u000a</ol>\u000a<p>\u4e3a\u4e86\u4f30\u6d4b1\uff0c\u6211\u4eec\u8fd0\u884c\u7a7a\u7684Hadoop\u4f5c\u4e1a\uff0c\u4ec5\u4ec5\u6267\u884c\u4f5c\u4e1a\u7684\u521d\u59cb\u5316\u3001\u542f\u52a8\u4efb\u52a1\u3001\u6e05\u7406\u5de5\u4f5c\u5c31\u81f3\u5c11\u8017\u65f625\u79d2\u3002\u5bf9\u4e8e2\uff0c\u6211\u4eec\u53d1\u73b0\u4e3a\u4e86\u670d\u52a1\u6bcf\u4e00\u4e2aHDFS\u6570\u636e\u5757\uff0cHDFS\u8fdb\u884c\u4e86\u591a\u6b21\u590d\u5236\u4ee5\u53ca\u8ba1\u7b97\u6821\u9a8c\u548c\u64cd\u4f5c\u3002</p>\u000a<p>\u4e3a\u4e86\u4f30\u6d4b3\uff0c\u6211\u4eec\u5728\u5355\u4e2a\u8282\u70b9\u4e0a\u8fd0\u884c\u4e86\u5fae\u57fa\u51c6\u7a0b\u5e8f\uff0c\u5728\u8f93\u5165\u7684256M\u6570\u636e\u4e0a\u8ba1\u7b97Logistic\u56de\u5f52\uff0c\u7ed3\u679c\u5982\u88685\u6240\u793a\u3002\u9996\u5148\uff0c\u5728\u5185\u5b58\u4e2d\u7684HDFS\u6587\u4ef6\u548c\u672c\u5730\u6587\u4ef6\u7684\u4e0d\u540c\u5bfc\u81f4\u901a\u8fc7HDFS\u63a5\u53e3\u8bfb\u53d6\u8017\u65f62\u79d2\uff0c\u751a\u81f3\u6570\u636e\u5c31\u5728\u672c\u5730\u5185\u5b58\u4e2d\u3002\u5176\u6b21\uff0c\u6587\u672c\u548c\u4e8c\u8fdb\u5236\u683c\u5f0f\u8f93\u5165\u7684\u4e0d\u540c\u9020\u6210\u4e86\u89e3\u6790\u8017\u65f67\u79d2\u7684\u5f00\u9500\u3002\u6700\u540e\uff0c\u9884\u89e3\u6790\u7684\u4e8c\u8fdb\u5236\u6587\u4ef6\u8f6c\u6362\u4e3a\u5185\u5b58\u4e2d\u7684Java\u5bf9\u8c61\uff0c\u8017\u65f63\u79d2\u3002\u6bcf\u4e2a\u8282\u70b9\u5904\u7406\u591a\u4e2a\u5757\u65f6\u8fd9\u4e9b\u5f00\u9500\u90fd\u4f1a\u7d2f\u79ef\u8d77\u6765\uff0c\u7136\u800c\u901a\u8fc7\u7f13\u5b58RDD\u4f5c\u4e3a\u5185\u5b58\u4e2d\u7684Java\u5bf9\u8c61\uff0cSpark\u53ea\u9700\u8981\u8017\u65f63\u79d2\u3002</p>\u000a<table style="border: solid thin #868686" border="1" cellpadding="2" cellspacing="0" width="100%">\u000a<caption style="text-align:center"><strong>\u88685</strong> Logistic\u56de\u5f52\u8fed\u4ee3\u65f6\u95f4</caption>\u000a<tbody>\u000a<tr>\u000a<td style="width: 45.62px;text-align: center;border: solid thin #868686" valign="top">\u000a		<b> </b>\u000a	</td>\u000a<td style="width: 45.21px;text-align: center;border: solid thin #868686" valign="top">\u000a		<b>\u5185\u5b58\u4e2d\u7684HDFS\u6587\u4ef6</b>\u000a	</td>\u000a<td style="width: 45.62px;text-align: center;border: solid thin #868686" valign="top">\u000a		<b>\u5185\u5b58\u4e2d\u7684\u672c\u5730\u6587\u4ef6</b>\u000a	</td>\u000a<td style="width: 45.21px;text-align: center;border: solid thin #868686" valign="top">\u000a		<b>\u7f13\u5b58\u7684RDD</b>\u000a	</td>\u000a</tr>\u000a<tr>\u000a<td style="width: 45.62px;border: solid thin #868686" valign="top">\u000a		\u6587\u672c\u8f93\u5165</br><br />\u000a		\u4e8c\u8fdb\u5236\u8f93\u5165\u000a	</td>\u000a<td style="width: 45.21px;border: solid thin #868686" valign="top">\u000a		15.38 (0.26)</br><br />\u000a		8.38 (0.10)\u000a	</td>\u000a<td style="width: 45.62px;border: solid thin #868686" valign="top">\u000a		13.13 (0.26)</br><br />\u000a		6.86 (0.02)\u000a	</td>\u000a<td style="width: 45.21px;border: solid thin #868686" valign="top">\u000a		2.93 (0.31)</br><br />\u000a		2.93 (0.31)\u000a	</td>\u000a</tr>\u000a</tbody>\u000a</table>\u000a<h3>7.2 PageRank</h3>\u000a<p>\u901a\u8fc7\u4f7f\u7528\u5b58\u50a8\u5728HDFS\u4e0a\u768449G Wikipedia\u5bfc\u51fa\u6570\u636e\uff0c\u6211\u4eec\u6bd4\u8f83\u4e86\u4f7f\u7528RDD\u5b9e\u73b0\u7684Pregel\u4e0e\u4f7f\u7528Hadoop\u8ba1\u7b97PageRank\u7684\u6027\u80fd\u3002PageRank\u7b97\u6cd5\u901a\u8fc710\u8f6e\u8fed\u4ee3\u5904\u7406\u4e86\u5927\u7ea6400\u4e07\u6587\u7ae0\u7684\u94fe\u63a5\u56fe\u6570\u636e\uff0c\u56fe10\u663e\u793a\u4e86\u572830\u4e2a\u8282\u70b9\u4e0a\uff0cSpark\u5904\u7406\u901f\u5ea6\u662fHadoop\u76842\u500d\u591a\uff0c\u6539\u8fdb\u540e\u5bf9\u8f93\u5165\u8fdb\u884cHash\u5206\u533a\u901f\u5ea6\u63d0\u5347\u52302.6\u500d\uff0c\u4f7f\u7528Combiner\u540e\u63d0\u5347\u52303.6\u500d\uff0c\u8fd9\u4e9b\u7ed3\u679c\u6570\u636e\u4e5f\u968f\u7740\u8282\u70b9\u6269\u5c55\u523060\u4e2a\u65f6\u540c\u6b65\u653e\u5927\u3002<br />\u000a<img class="alignnone size-full wp-image-757" alt="f10-compare-spark-and-hadoop" src="http://shiyanjuncn.b0.upaiyun.com/wp-content/uploads/2014/03/f10-compare-spark-and-hadoop.png" width="444" height="212" /><br />\u000a<span style="font-size: small;text-indent: 20px"><strong>\u56fe10</strong> \u8fed\u4ee3\u65f6\u95f4\u5bf9\u6bd4</span></p>\u000a<h3>7.3 \u5bb9\u9519\u6062\u590d</h3>\u000a<p>\u57fa\u4e8eK-means\u7b97\u6cd5\u5e94\u7528\u7a0b\u5e8f\uff0c\u6211\u4eec\u8bc4\u4f30\u4e86\u5728\u5355\u70b9\u6545\u969c\uff08SPOF\uff09\u65f6\u4f7f\u7528Lneage\u4fe1\u606f\u521b\u5efaRDD\u5206\u533a\u7684\u5f00\u9500\u3002\u56fe11\u663e\u793a\u4e86\uff0cK-means\u5e94\u7528\u7a0b\u5e8f\u8fd0\u884c\u572875\u4e2a\u8282\u70b9\u7684\u96c6\u7fa4\u4e2d\u8fdb\u884c\u4e8610\u8f6e\u8fed\u4ee3\uff0c\u6211\u4eec\u5728\u6b63\u5e38\u64cd\u4f5c\u548c\u8fdb\u884c\u7b2c6\u8f6e\u8fed\u4ee3\u5f00\u59cb\u65f6\u4e00\u4e2a\u8282\u70b9\u53d1\u751f\u6545\u969c\u7684\u60c5\u51b5\u4e0b\u5bf9\u8017\u65f6\u8fdb\u884c\u4e86\u5bf9\u6bd4\u3002\u6ca1\u6709\u4efb\u4f55\u5931\u8d25\uff0c\u6bcf\u8f6e\u8fed\u4ee3\u542f\u52a8\u4e86400\u4e2a\u4efb\u52a1\u5904\u7406100G\u6570\u636e\u3002<br />\u000a<img class="alignnone size-full wp-image-758" alt="f11-iteration-k-means-spof" src="http://shiyanjuncn.b0.upaiyun.com/wp-content/uploads/2014/03/f11-iteration-k-means-spof.png" width="455" height="213" /><br />\u000a<span style="font-size: small;text-indent: 20px"><strong>\u56fe11</strong> SPOF\u65f6K-means\u5e94\u7528\u7a0b\u5e8f\u8fed\u4ee3\u65f6\u95f4</span><br />\u000a\u7b2c5\u8f6e\u8fed\u4ee3\u7ed3\u675f\u65f6\u5927\u7ea6\u8017\u65f658\u79d2\uff0c\u7b2c6\u8f6e\u8fed\u4ee3\u65f6Kill\u6389\u4e00\u4e2a\u8282\u70b9\uff0c\u8be5\u8282\u70b9\u4e0a\u7684\u4efb\u52a1\u90fd\u88ab\u7ec8\u6b62\uff08\u5305\u62ec\u7f13\u5b58\u7684\u5206\u533a\u6570\u636e\uff09\u3002Spark\u8c03\u5ea6\u5668\u8c03\u5ea6\u8fd9\u4e9b\u4efb\u52a1\u5728\u5176\u4ed6\u8282\u70b9\u4e0a\u91cd\u65b0\u5e76\u884c\u8fd0\u884c\uff0c\u5e76\u4e14\u91cd\u65b0\u8bfb\u53d6\u57fa\u4e8eLineage\u4fe1\u606f\u91cd\u5efa\u7684RDD\u8f93\u5165\u6570\u636e\u5e76\u8fdb\u884c\u7f13\u5b58\uff0c\u8fd9\u4f7f\u5f97\u8fed\u4ee3\u8ba1\u7b97\u8017\u65f6\u589e\u52a0\u523080\u79d2\u3002\u4e00\u65e6\u4e22\u5931\u7684RDD\u5206\u533a\u88ab\u91cd\u5efa\uff0c\u5e73\u5747\u8fed\u4ee3\u65f6\u95f4\u53c8\u56de\u843d\u523058\u79d2\u3002</p>\u000a<h3>7.4 \u5185\u5b58\u4e0d\u8db3\u65f6\u8868\u73b0</h3>\u000a<p>\u5230\u73b0\u5728\u4e3a\u6b62\uff0c\u6211\u4eec\u80fd\u4fdd\u8bc1\u96c6\u7fa4\u4e2d\u7684\u6bcf\u4e2a\u8282\u70b9\u90fd\u6709\u8db3\u591f\u7684\u5185\u5b58\u53bb\u7f13\u5b58\u8fed\u4ee3\u8fc7\u7a0b\u4e2d\u4f7f\u7528\u7684RDD\uff0c\u5982\u679c\u6ca1\u6709\u8db3\u591f\u7684\u5185\u5b58\u6765\u7f13\u5b58\u4e00\u4e2a\u4f5c\u4e1a\u7684\u5de5\u4f5c\u96c6\uff0cSpark\u53c8\u662f\u5982\u4f55\u8fd0\u884c\u7684\u5462\uff1f\u5728\u5b9e\u9a8c\u4e2d\uff0c\u6211\u4eec\u901a\u8fc7\u5728\u6bcf\u4e2a\u8282\u70b9\u4e0a\u9650\u5236\u7f13\u5b58RDD\u6240\u9700\u8981\u7684\u5185\u5b58\u8d44\u6e90\u6765\u914d\u7f6eSpark\uff0c\u5728\u4e0d\u540c\u7684\u7f13\u5b58\u914d\u7f6e\u6761\u4ef6\u4e0b\u6267\u884cLogistic\u56de\u5f52\uff0c\u7ed3\u679c\u5982\u56fe12\u3002\u6211\u4eec\u53ef\u4ee5\u770b\u51fa\uff0c\u968f\u7740\u7f13\u5b58\u7684\u51cf\u5c0f\uff0c\u6027\u80fd\u5e73\u7f13\u5730\u4e0b\u964d\u3002<br />\u000a<img class="alignnone size-full wp-image-759" alt="f12-spark-performance-limit-cache-size-of-rdd" src="http://shiyanjuncn.b0.upaiyun.com/wp-content/uploads/2014/03/f12-spark-performance-limit-cache-size-of-rdd.png" width="395" height="199" /><br />\u000a<span style="font-size: small;text-indent: 20px"><strong>\u56fe12</strong> Spark\u4e0a\u8fd0\u884cLogistic\u56de\u5f52\u7684\u6027\u80fd\u8868\u73b0</span></p>\u000a<h3>7.5 \u57fa\u4e8eSpark\u6784\u5efa\u7684\u7528\u6237\u5e94\u7528\u7a0b\u5e8f</h3>\u000a<p><strong>In-Memory\u5206\u6790</strong>\u3002\u89c6\u9891\u5206\u53d1\u516c\u53f8Conviva\u4f7f\u7528Spark\u6781\u5927\u5730\u63d0\u5347\u4e86\u4e3a\u5ba2\u6237\u5904\u7406\u5206\u6790\u62a5\u544a\u7684\u901f\u5ea6\uff0c\u4ee5\u524d\u57fa\u4e8eHadoop\u4f7f\u7528\u5927\u7ea620\u4e2aHive[3]\u67e5\u8be2\u6765\u5b8c\u6210\uff0c\u8fd9\u4e9b\u67e5\u8be2\u4f5c\u7528\u5728\u76f8\u540c\u7684\u6570\u636e\u5b50\u96c6\u4e0a\uff08\u6ee1\u8db3\u7528\u6237\u63d0\u4f9b\u7684\u6761\u4ef6\uff09\uff0c\u4f46\u662f\u5728\u4e0d\u540c\u5206\u7ec4\u7684\u5b57\u6bb5\u4e0a\u6267\u884c\u805a\u5408\u64cd\u4f5c\uff08SUM\u3001AVG\u3001COUNT DISTINCT\u7b49\uff09\u9700\u8981\u4f7f\u7528\u5355\u72ec\u7684MapReduce\u4f5c\u4e1a\u3002\u8be5\u516c\u53f8\u4f7f\u7528Spark\u53ea\u9700\u8981\u5c06\u76f8\u5173\u6570\u636e\u52a0\u8f7d\u5230\u5185\u5b58\u4e2d\u4e00\u6b21\uff0c\u7136\u540e\u8fd0\u884c\u4e0a\u8ff0\u805a\u5408\u64cd\u4f5c\uff0c\u5728Hadoop\u96c6\u7fa4\u4e0a\u5904\u7406200G\u538b\u7f29\u6570\u636e\u5e76\u751f\u6210\u62a5\u8017\u65f620\u5c0f\u65f6\uff0c\u800c\u4f7f\u7528Spark\u57fa\u4e8e96G\u5185\u5b58\u76842\u4e2a\u8282\u70b9\u8017\u65f630\u5206\u949f\u5373\u53ef\u5b8c\u6210\uff0c\u901f\u5ea6\u63d0\u534740\u500d\uff0c\u4e3b\u8981\u662f\u56e0\u4e3a\u4e0d\u9700\u8981\u518d\u5bf9\u6bcf\u4e2a\u4f5c\u4e1a\u91cd\u590d\u5730\u6267\u884c\u89e3\u538b\u7f29\u548c\u8fc7\u6ee4\u64cd\u4f5c\u3002</p>\u000a<p><strong>\u57ce\u5e02\u4ea4\u901a\u5efa\u6a21</strong>\u3002\u5728Berkeley\u7684Mobile Millennium\u9879\u76ee[17]\u4e2d\uff0c\u57fa\u4e8e\u4e00\u7cfb\u5217\u5206\u6563\u7684\u6c7d\u8f66GPS\u76d1\u6d4b\u6570\u636e\uff0c\u7814\u7a76\u4eba\u5458\u4f7f\u7528\u5e76\u884c\u5316\u673a\u5668\u5b66\u4e60\u7b97\u6cd5\u6765\u63a8\u7b97\u516c\u8def\u4ea4\u901a\u62e5\u5835\u72b6\u51b5\u3002\u6570\u636e\u6765\u81ea\u5e02\u533a10000\u4e2a\u4e92\u8054\u7684\u516c\u8def\u7ebf\u8def\u7f51\uff0c\u8fd8\u6709600000\u4e2a\u7531\u6c7d\u8f66GPS\u88c5\u7f6e\u91c7\u96c6\u5230\u7684\u6837\u672c\u6570\u636e\uff0c\u8fd9\u4e9b\u6570\u636e\u8bb0\u5f55\u4e86\u6c7d\u8f66\u5728\u4e24\u4e2a\u5730\u70b9\u4e4b\u95f4\u884c\u9a76\u7684\u65f6\u95f4\uff08\u6bcf\u4e00\u6761\u8def\u7ebf\u7684\u884c\u9a76\u65f6\u95f4\u53ef\u80fd\u8de8\u591a\u4e2a\u516c\u8def\u7ebf\u8def\u7f51\uff09\u3002\u4f7f\u7528\u4e00\u4e2a\u4ea4\u901a\u6a21\u578b\uff0c\u901a\u8fc7\u63a8\u7b97\u8de8\u591a\u4e2a\u516c\u8def\u7f51\u884c\u9a76\u8017\u65f6\u9884\u671f\uff0c\u7cfb\u7edf\u80fd\u591f\u4f30\u7b97\u62e5\u5835\u72b6\u51b5\u3002\u7814\u7a76\u4eba\u5458\u4f7f\u7528Spark\u5b9e\u73b0\u4e86\u4e00\u4e2a\u53ef\u8fed\u4ee3\u7684EM\u7b97\u6cd5\uff0c\u5176\u4e2d\u5305\u62ec\u5411Worker\u8282\u70b9\u5e7f\u64ad\u8def\u7ebf\u7f51\u7edc\u4fe1\u606f\uff0c\u5728E\u548cM\u9636\u6bb5\u4e4b\u95f4\u6267\u884creduceByKey\u64cd\u4f5c\uff0c\u5e94\u7528\u4ece20\u4e2a\u8282\u70b9\u6269\u5c55\u523080\u4e2a\u8282\u70b9\uff08\u6bcf\u4e2a\u8282\u70b94\u6838\uff09\uff0c\u5982\u56fe13\uff08a\uff09\u6240\u793a\uff1a<br />\u000a<img class="alignnone size-full wp-image-760" alt="f13-run-time-of-per-iteration" src="http://shiyanjuncn.b0.upaiyun.com/wp-content/uploads/2014/03/f13-run-time-of-per-iteration.png" width="526" height="251" /><br />\u000a<span style="font-size: small;text-indent: 20px"><strong>\u56fe13</strong> \u6bcf\u8f6e\u8fed\u4ee3\u8fd0\u884c\u65f6\u95f4\uff08a\uff09\u4ea4\u901a\u5efa\u6a21\u5e94\u7528\u7a0b\u5e8f\uff08b\uff09\u57fa\u4e8eSpark\u7684\u793e\u4ea4\u7f51\u7edc\u7684Spam\u5206\u7c7b</span><br />\u000a<strong>\u793e\u4ea4\u7f51\u7edcSpam\u5206\u7c7b</strong>\u3002Berkeley\u7684Monarch\u9879\u76ee[31]\u4f7f\u7528Spark\u8bc6\u522bTwitter\u6d88\u606f\u4e0a\u7684Spam\u94fe\u63a5\u3002\u4ed6\u4eec\u5728Spark\u4e0a\u5b9e\u73b0\u4e86\u4e00\u4e2a\u7c7b\u4f3c7.1\u5c0f\u8282\u4e2d\u793a\u4f8b\u7684Logistic\u56de\u5f52\u5206\u7c7b\u5668\uff0c\u4e0d\u540c\u7684\u662f\u4f7f\u7528\u5206\u5e03\u5f0f\u7684reduceByKey\u64cd\u4f5c\u5e76\u884c\u5bf9\u68af\u5ea6\u5411\u91cf\u6c42\u548c\u3002\u56fe13\uff08b\uff09\u663e\u793a\u4e86\u57fa\u4e8e50G\u6570\u636e\u5b50\u96c6\u8bad\u7ec3\u8bad\u7ec3\u5206\u7c7b\u5668\u7684\u7ed3\u679c\uff0c\u6574\u4e2a\u6570\u636e\u96c6\u662f250000\u7684URL\u3001\u81f3\u5c1110^7\u4e2a\u4e0e\u7f51\u7edc\u76f8\u5173\u7684\u7279\u5f81/\u7ef4\u5ea6\uff0c\u5185\u5bb9\u3001\u8bcd\u6027\u4e0e\u8bbf\u95ee\u4e00\u4e2aURL\u7684\u9875\u9762\u76f8\u5173\u3002\u968f\u7740\u8282\u70b9\u7684\u589e\u52a0\uff0c\u8fd9\u5e76\u4e0d\u50cf\u4ea4\u901a\u5e94\u7528\u7a0b\u5e8f\u90a3\u6837\u8fd1\u4f3c\u7ebf\u6027\uff0c\u4e3b\u8981\u662f\u56e0\u4e3a\u6bcf\u8f6e\u8fed\u4ee3\u7684\u56fa\u5b9a\u901a\u4fe1\u4ee3\u4ef7\u8f83\u9ad8\u3002</p>\u000a<h3>7.6 \u4ea4\u4e92\u5f0f\u6570\u636e\u6316\u6398</h3>\u000a<p>\u4e3a\u4e86\u5c55\u793aSpark\u4ea4\u4e92\u5f0f\u5904\u7406\u5927\u6570\u636e\u96c6\u7684\u80fd\u529b\uff0c\u6211\u4eec\u5728100\u4e2am2.4xlarge EC2\u5b9e\u4f8b\uff088\u683868G\u5185\u5b58\uff09\u4e0a\u4f7f\u7528Spark\u5206\u67901TB\u4ece2008-10\u52302009-4\u8fd9\u6bb5\u65f6\u95f4\u7684Wikipedia\u9875\u9762\u6d4f\u89c8\u65e5\u5fd7\u6570\u636e\uff0c\u5728\u6574\u4e2a\u8f93\u5165\u6570\u636e\u96c6\u4e0a\u7b80\u5355\u5730\u67e5\u8be2\u5982\u4e0b\u5185\u5bb9\u4ee5\u83b7\u53d6\u9875\u9762\u6d4f\u89c8\u603b\u6570\uff1a\uff081\uff09\u5168\u90e8\u9875\u9762\uff1b\uff082\uff09\u9875\u9762\u7684\u6807\u9898\u80fd\u7cbe\u786e\u5339\u914d\u7ed9\u5b9a\u7684\u5173\u952e\u8bcd\uff1b\uff083\uff09\u9875\u9762\u7684\u6807\u9898\u80fd\u90e8\u5206\u5339\u914d\u7ed9\u5b9a\u7684\u5173\u952e\u8bcd\u3002<br />\u000a<img class="alignnone size-full wp-image-761" alt="f14-response-time-of-interactive-queries" src="http://shiyanjuncn.b0.upaiyun.com/wp-content/uploads/2014/03/f14-response-time-of-interactive-queries.png" width="369" height="218" /><br />\u000a<span style="font-size: small;text-indent: 20px"><strong>\u56fe14</strong> \u663e\u793a\u4e86\u5206\u522b\u5728\u6574\u4e2a\u30011/2\u30011/10\u7684\u6570\u636e\u4e0a\u67e5\u8be2\u7684\u54cd\u5e94\u65f6\u95f4\uff0c\u751a\u81f31TB\u6570\u636e\u5728Spark\u4e0a\u67e5\u8be2\u4ec5\u8017\u65f65-7\u79d2\uff0c\u8fd9\u6bd4\u76f4\u63a5\u64cd\u4f5c\u78c1\u76d8\u6570\u636e\u5feb\u51e0\u4e2a\u6570\u91cf\u7ea7\u3002\u4f8b\u5982\uff0c\u4ece\u78c1\u76d8\u4e0a\u67e5\u8be21TB\u6570\u636e\u8017\u65f6170\u79d2\uff0c\u8fd9\u8868\u660e\u4e86RDD\u7f13\u5b58\u4f7f\u5f97Spark\u6210\u4e3a\u4e00\u4e2a\u4ea4\u4e92\u5f0f\u6570\u636e\u6316\u6398\u7684\u5f3a\u5927\u5de5\u5177\u3002</span></p>\u000a<h2>8. \u76f8\u5173\u5de5\u4f5c</h2>\u000a<p><strong>\u5206\u5e03\u5f0f\u5171\u4eab\u5185\u5b58\uff08DSM\uff09</strong>\u3002RDD\u53ef\u4ee5\u770b\u6210\u662f\u4e00\u4e2a\u57fa\u4e8eDSM\u7814\u7a76[24]\u5f97\u5230\u7684\u62bd\u8c61\u3002\u57282.5\u8282\u6211\u4eec\u8ba8\u8bba\u8fc7\uff0cRDD\u63d0\u4f9b\u4e86\u4e00\u4e2a\u6bd4DSM\u9650\u5236\u66f4\u4e25\u683c\u7684\u7f16\u7a0b\u6a21\u578b\uff0c\u5e76\u80fd\u5728\u8282\u70b9\u5931\u6548\u65f6\u9ad8\u6548\u5730\u91cd\u5efa\u6570\u636e\u96c6\u3002DSM\u901a\u8fc7\u68c0\u67e5\u70b9[19]\u5b9e\u73b0\u5bb9\u9519\uff0c\u800cSpark\u4f7f\u7528Lineage\u91cd\u5efaRDD\u5206\u533a\uff0c\u8fd9\u4e9b\u5206\u533a\u53ef\u4ee5\u5728\u4e0d\u540c\u7684\u8282\u70b9\u4e0a\u91cd\u65b0\u5e76\u884c\u5904\u7406\uff0c\u800c\u4e0d\u9700\u8981\u5c06\u6574\u4e2a\u7a0b\u5e8f\u56de\u9000\u5230\u68c0\u67e5\u70b9\u518d\u91cd\u65b0\u8fd0\u884c\u3002RDD\u80fd\u591f\u50cfMapReduce\u4e00\u6837\u5c06\u8ba1\u7b97\u63a8\u5411\u6570\u636e[12]\uff0c\u5e76\u901a\u8fc7\u63a8\u6d4b\u6267\u884c\u6765\u89e3\u51b3\u67d0\u4e9b\u4efb\u52a1\u8ba1\u7b97\u8fdb\u5ea6\u843d\u540e\u7684\u95ee\u9898\uff0c\u63a8\u6d4b\u6267\u884c\u5728\u4e00\u822c\u7684DSM\u7cfb\u7edf\u4e0a\u662f\u5f88\u96be\u5b9e\u73b0\u7684\u3002</p>\u000a<p><strong>In-Memory\u96c6\u7fa4\u8ba1\u7b97</strong>\u3002Piccolo[28]\u662f\u4e00\u4e2a\u57fa\u4e8e\u53ef\u53d8\u7684\u3001In-Memory\u7684\u5206\u5e03\u5f0f\u8868\u7684\u96c6\u7fa4\u7f16\u7a0b\u6a21\u578b\u3002\u56e0\u4e3aPiccolo\u5141\u8bb8\u8bfb\u5199\u8868\u4e2d\u7684\u8bb0\u5f55\uff0c\u5b83\u5177\u6709\u4e0eDSM\u7c7b\u4f3c\u7684\u6062\u590d\u673a\u5236\uff0c\u9700\u8981\u68c0\u67e5\u70b9\u548c\u56de\u6eda\uff0c\u4f46\u662f\u4e0d\u80fd\u63a8\u6d4b\u6267\u884c\uff0c\u4e5f\u6ca1\u6709\u63d0\u4f9b\u7c7b\u4f3cgroupBy\u3001sort\u7b49\u66f4\u9ad8\u7ea7\u522b\u7684\u6570\u636e\u6d41\u7b97\u5b50\uff0c\u7528\u6237\u53ea\u80fd\u76f4\u63a5\u8bfb\u53d6\u8868\u5355\u5143\u6570\u636e\u6765\u5b9e\u73b0\u3002\u53ef\u89c1\uff0cPiccolo\u662f\u6bd4Spark\u66f4\u4f4e\u7ea7\u522b\u7684\u7f16\u7a0b\u6a21\u578b\uff0c\u4f46\u662f\u6bd4DSM\u8981\u9ad8\u7ea7\u3002</p>\u000a<p>RAMClouds[26]\u9002\u5408\u4f5c\u4e3aWeb\u5e94\u7528\u7684\u5b58\u50a8\u7cfb\u7edf\uff0c\u5b83\u540c\u6837\u63d0\u4f9b\u4e86\u7ec6\u7c92\u5ea6\u8bfb\u5199\u64cd\u4f5c\uff0c\u6240\u4ee5\u9700\u8981\u901a\u8fc7\u8bb0\u5f55\u65e5\u5fd7\u6765\u5b9e\u73b0\u5bb9\u9519\u3002</p>\u000a<p><strong>\u6570\u636e\u6d41\u7cfb\u7edf</strong>\u3002RDD\u501f\u9274\u4e86DryadLINQ[34]\u3001Pig[25]\u548cFlumeJava[9]\u7684\u201c\u5e76\u884c\u6536\u96c6\u201d\u7f16\u7a0b\u6a21\u578b\uff0c\u901a\u8fc7\u5141\u8bb8\u7528\u6237\u663e\u5f0f\u5730\u5c06\u672a\u5e8f\u5217\u5316\u7684\u5bf9\u8c61\u4fdd\u5b58\u5728\u5185\u5b58\u4e2d\uff0c\u4ee5\u6b64\u6765\u63a7\u5236\u5206\u533a\u548c\u57fa\u4e8ekey\u968f\u673a\u67e5\u627e\uff0c\u4ece\u800c\u6709\u6548\u5730\u652f\u6301\u57fa\u4e8e\u5de5\u4f5c\u96c6\u7684\u5e94\u7528\u3002RDD\u4fdd\u7559\u4e86\u90a3\u4e9b\u6570\u636e\u6d41\u7cfb\u7edf\u66f4\u9ad8\u7ea7\u522b\u7684\u7f16\u7a0b\u7279\u6027\uff0c\u8fd9\u5bf9\u90a3\u4e9b\u5f00\u53d1\u4eba\u5458\u6765\u8bf4\u4e5f\u6bd4\u8f83\u719f\u6089\uff0c\u800c\u4e14\uff0cRDD\u4e5f\u80fd\u591f\u652f\u6301\u66f4\u591a\u7c7b\u578b\u7684\u5e94\u7528\u3002RDD\u65b0\u589e\u7684\u6269\u5c55\uff0c\u4ece\u6982\u5ff5\u4e0a\u770b\u5f88\u7b80\u5355\uff0c\u5176\u4e2dSpark\u662f\u7b2c\u4e00\u4e2a\u4f7f\u7528\u4e86\u8fd9\u4e9b\u7279\u6027\u7684\u7cfb\u7edf\uff0c\u7c7b\u4f3cDryadLINQ\u7f16\u7a0b\u6a21\u578b\uff0c\u80fd\u591f\u6709\u6548\u5730\u652f\u6301\u57fa\u4e8e\u5de5\u4f5c\u96c6\u7684\u5e94\u7528\u3002</p>\u000a<p>\u9762\u5411\u57fa\u4e8e\u5de5\u4f5c\u96c6\u7684\u5e94\u7528\uff0c\u5df2\u7ecf\u5f00\u53d1\u4e86\u4e00\u4e9b\u4e13\u7528\u7cfb\u7edf\uff0c\u50cfTwister[13]\u3001HaLoop[8]\u5b9e\u73b0\u4e86\u4e00\u4e2a\u652f\u6301\u8fed\u4ee3\u7684MapReduce\u6a21\u578b\uff1bPregel[21]\uff0c\u652f\u6301\u56fe\u5e94\u7528\u7684BSP\u8ba1\u7b97\u6a21\u578b\u3002RDD\u662f\u4e00\u4e2a\u66f4\u901a\u7528\u7684\u62bd\u8c61\uff0c\u5b83\u80fd\u591f\u63cf\u8ff0\u652f\u6301\u8fed\u4ee3\u7684MapReduce\u3001Pregel\uff0c\u8fd8\u6709\u73b0\u6709\u4e00\u4e9b\u7cfb\u7edf\u672a\u80fd\u5904\u7406\u7684\u5e94\u7528\uff0c\u5982\u4ea4\u4e92\u5f0f\u6570\u636e\u6316\u6398\u3002\u7279\u522b\u5730\uff0c\u5b83\u80fd\u591f\u8ba9\u5f00\u53d1\u4eba\u5458\u52a8\u6001\u5730\u9009\u62e9\u64cd\u4f5c\u6765\u8fd0\u884c\u5728RDD\u4e0a\uff08\u5982\u67e5\u770b\u67e5\u8be2\u7684\u7ed3\u679c\u4ee5\u51b3\u5b9a\u4e0b\u4e00\u6b65\u8fd0\u884c\u54ea\u4e2a\u67e5\u8be2\uff09\uff0c\u800c\u4e0d\u662f\u63d0\u4f9b\u4e00\u7cfb\u5217\u56fa\u5b9a\u7684\u6b65\u9aa4\u53bb\u6267\u884c\u8fed\u4ee3\uff0cRDD\u8fd8\u652f\u6301\u66f4\u591a\u7c7b\u578b\u7684\u8f6c\u6362\u3002</p>\u000a<p>\u6700\u540e\uff0cDremel[22]\u662f\u4e00\u4e2a\u4f4e\u5ef6\u8fdf\u67e5\u8be2\u5f15\u64ce\uff0c\u5b83\u9762\u5411\u57fa\u4e8e\u78c1\u76d8\u5b58\u50a8\u7684\u5927\u6570\u636e\u96c6\uff0c\u8fd9\u7c7b\u6570\u636e\u96c6\u662f\u628a\u5d4c\u5957\u8bb0\u5f55\u6570\u636e\u751f\u6210\u57fa\u4e8e\u5217\u7684\u683c\u5f0f\u3002\u8fd9\u79cd\u683c\u5f0f\u7684\u6570\u636e\u4e5f\u80fd\u591f\u4fdd\u5b58\u4e3aRDD\u5e76\u5728Spark\u7cfb\u7edf\u4e2d\u4f7f\u7528\uff0c\u4f46Spark\u4e5f\u5177\u5907\u5c06\u6570\u636e\u52a0\u8f7d\u5230\u5185\u5b58\u6765\u5b9e\u73b0\u5feb\u901f\u67e5\u8be2\u7684\u80fd\u529b\u3002</p>\u000a<p><strong>Lineage</strong>\u3002\u6211\u4eec\u901a\u8fc7\u53c2\u8003[6]\u5230[10]\u505a\u8fc7\u8c03\u7814\uff0c\u5728\u79d1\u5b66\u8ba1\u7b97\u548c\u6570\u636e\u5e93\u9886\u57df\uff0c\u5bf9\u4e8e\u4e00\u4e9b\u5e94\u7528\uff0c\u5982\u9700\u8981\u89e3\u91ca\u7ed3\u679c\u4ee5\u53ca\u5141\u8bb8\u88ab\u91cd\u65b0\u751f\u6210\u3001\u5de5\u4f5c\u6d41\u4e2d\u53d1\u73b0\u4e86bug\u6216\u8005\u6570\u636e\u96c6\u4e22\u5931\u9700\u8981\u91cd\u65b0\u5904\u7406\u6570\u636e\uff0c\u8868\u793a\u6570\u636e\u7684Lineage\u548c\u539f\u59cb\u4fe1\u606f\u4e00\u76f4\u4ee5\u6765\u90fd\u662f\u4e00\u4e2a\u7814\u7a76\u8bfe\u9898\u3002RDD\u63d0\u4f9b\u4e86\u4e00\u4e2a\u53d7\u9650\u7684\u7f16\u7a0b\u6a21\u578b\uff0c\u5728\u8fd9\u4e2a\u6a21\u578b\u4e2d\u4f7f\u7528\u7ec6\u7c92\u5ea6\u7684Lineage\u6765\u8868\u793a\u662f\u975e\u5e38\u5bb9\u6613\u7684\uff0c\u56e0\u6b64\u5b83\u53ef\u4ee5\u88ab\u7528\u4e8e\u5bb9\u9519\u3002</p>\u000a<p><strong>\u7f13\u5b58\u7cfb\u7edf</strong>\u3002Nectar[14]\u80fd\u591f\u901a\u8fc7\u8bc6\u522b\u5e26\u6709\u7a0b\u5e8f\u5206\u6790\u7684\u5b50\u8868\u8fbe\u5f0f\uff0c\u8de8DryadLINQ\u4f5c\u4e1a\u91cd\u7528\u4e2d\u95f4\u7ed3\u679c\uff0c\u5982\u679c\u5c06\u8fd9\u79cd\u80fd\u529b\u52a0\u5165\u5230\u57fa\u4e8eRDD\u7684\u7cfb\u7edf\u4f1a\u975e\u5e38\u6709\u8da3\u3002\u4f46\u662fNectar\u5e76\u6ca1\u6709\u63d0\u4f9bIn-Memory\u7f13\u5b58\uff0c\u4e5f\u4e0d\u80fd\u591f\u8ba9\u7528\u6237\u663e\u5f0f\u5730\u63a7\u5236\u5e94\u8be5\u7f13\u5b58\u90a3\u4e2a\u6570\u636e\u96c6\uff0c\u4ee5\u53ca\u5982\u4f55\u5bf9\u5176\u8fdb\u884c\u5206\u533a\u3002Ciel[23]\u540c\u6837\u80fd\u591f\u8bb0\u4f4f\u4efb\u52a1\u7ed3\u679c\uff0c\u4f46\u4e0d\u80fd\u63d0\u4f9bIn-Memory\u7f13\u5b58\u5e76\u663e\u5f0f\u63a7\u5236\u5b83\u3002</p>\u000a<p><strong>\u8bed\u8a00\u8fed\u4ee3</strong>\u3002DryadLINQ[34]\u80fd\u591f\u4f7f\u7528LINQ\u83b7\u53d6\u5230\u8868\u8fbe\u5f0f\u6811\u7136\u540e\u5728\u96c6\u7fa4\u4e0a\u8fd0\u884c\uff0cSpark\u7cfb\u7edf\u7684\u8bed\u8a00\u96c6\u6210\u4e0e\u5b83\u5f88\u7c7b\u4f3c\u3002\u4e0d\u50cfDryadLINQ\uff0cSpark\u5141\u8bb8\u7528\u6237\u663e\u5f0f\u5730\u8de8\u67e5\u8be2\u5c06RDD\u5b58\u50a8\u5230\u5185\u5b58\u4e2d\uff0c\u5e76\u901a\u8fc7\u63a7\u5236\u5206\u533a\u6765\u4f18\u5316\u901a\u4fe1\u3002Spark\u652f\u6301\u4ea4\u4e92\u5f0f\u5904\u7406\uff0c\u4f46DryadLINQ\u5374\u4e0d\u652f\u6301\u3002</p>\u000a<p><strong>\u5173\u7cfb\u6570\u636e\u5e93</strong>\u3002\u4ece\u6982\u5ff5\u4e0a\u770b\uff0cRDD\u7c7b\u4f3c\u4e8e\u6570\u636e\u5e93\u4e2d\u7684\u89c6\u56fe\uff0c\u7f13\u5b58RDD\u7c7b\u4f3c\u4e8e\u7269\u5316\u89c6\u56fe[29]\u3002\u7136\u800c\uff0c\u6570\u636e\u5e93\u50cfDSM\u7cfb\u7edf\u4e00\u6837\uff0c\u5141\u8bb8\u5178\u578b\u5730\u8bfb\u5199\u6240\u6709\u8bb0\u5f55\uff0c\u901a\u8fc7\u8bb0\u5f55\u64cd\u4f5c\u548c\u6570\u636e\u7684\u65e5\u5fd7\u6765\u5b9e\u73b0\u5bb9\u9519\uff0c\u8fd8\u9700\u8981\u82b1\u8d39\u989d\u5916\u7684\u5f00\u9500\u6765\u7ef4\u62a4\u4e00\u81f4\u6027\u3002RDD\u7f16\u7a0b\u6a21\u578b\u901a\u8fc7\u589e\u52a0\u66f4\u591a\u9650\u5236\u6765\u907f\u514d\u8fd9\u4e9b\u5f00\u9500\u3002</p>\u000a<h2>9. \u603b\u7ed3</h2>\u000a<p>\u6211\u4eec\u63d0\u51fa\u7684RDD\u662f\u4e00\u4e2a\u9762\u5411\uff0c\u8fd0\u884c\u5728\u666e\u901a\u5546\u7528\u673a\u96c6\u7fa4\u4e4b\u4e0a\u5e76\u884c\u6570\u636e\u5904\u7406\u5e94\u7528\u7684\u5206\u5e03\u5f0f\u5185\u5b58\u62bd\u8c61\u3002RDD\u5e7f\u6cdb\u652f\u6301\u57fa\u4e8e\u5de5\u4f5c\u96c6\u7684\u5e94\u7528\uff0c\u5305\u62ec\u8fed\u4ee3\u5f0f\u673a\u5668\u5b66\u4e60\u548c\u56fe\u7b97\u6cd5\uff0c\u8fd8\u6709\u4ea4\u4e92\u5f0f\u6570\u636e\u6316\u6398\uff0c\u7136\u800c\u5b83\u4fdd\u7559\u4e86\u6570\u636e\u6d41\u6a21\u578b\u4e2d\u5f15\u4eba\u6ce8\u76ee\u7684\u7279\u70b9\uff0c\u5982\u81ea\u52a8\u5bb9\u9519\u6062\u590d\uff0c\u5904\u7406\u6267\u884c\u8fdb\u5ea6\u843d\u540e\u7684\u4efb\u52a1\uff0c\u4ee5\u53ca\u611f\u77e5\u8c03\u5ea6\u3002\u5b83\u662f\u901a\u8fc7\u9650\u5236\u7f16\u7a0b\u6a21\u578b\uff0c\u8fdb\u800c\u5141\u8bb8\u9ad8\u6548\u5730\u91cd\u5efaRDD\u5206\u533a\u6765\u5b9e\u73b0\u7684\u3002RDD\u5b9e\u73b0\u5904\u7406\u8fed\u4ee3\u5f0f\u4f5c\u4e1a\u7684\u901f\u5ea6\u8d85\u8fc7Hadoop\u5927\u7ea620\u500d\uff0c\u800c\u4e14\u8fd8\u80fd\u591f\u4ea4\u4e92\u5f0f\u67e5\u8be2\u6570\u767eG\u6570\u636e\u3002</p>\u000a<h2>\u81f4\u8c22</h2>\u000a<p>\u9996\u5148\u611f\u8c22Spark\u7528\u6237\uff0c\u5305\u62ecTimothy Hunter\u3001Lester Mackey\u3001Dilip Joseph\u3001Jibin Zhan\u548cTeodor Moldovan\uff0c\u4ed6\u4eec\u5728\u771f\u5b9e\u7684\u5e94\u7528\u4e2d\u4f7f\u7528Spark\uff0c\u63d0\u51fa\u4e86\u5b9d\u8d35\u7684\u5efa\u8bae\uff0c\u540c\u65f6\u4e5f\u53d1\u73b0\u4e86\u4e00\u4e9b\u65b0\u7684\u7814\u7a76\u6311\u6218\u3002\u8fd9\u6b21\u7814\u7a76\u79bb\u4e0d\u5f00\u4ee5\u4e0b\u7ec4\u7ec7\u6216\u56e2\u4f53\u7684\u5927\u529b\u652f\u6301\uff1aBerkeley AMP Lab\u521b\u7acb\u8d5e\u52a9\u8005Google\u548cSAP\uff0cAMP Lab\u8d5e\u52a9\u8005Amazon Web Services\u3001Cloudera\u3001Huawei\u3001IBM\u3001Intel\u3001Microsoft\u3001NEC\u3001NetApp\u548cVMWare\uff0c\u56fd\u5bb6\u914d\u5957\u8d44\u91d1\u52a0\u5ddeMICRO\u9879\u76ee\uff08\u52a9\u5b66\u91d1 06-152\uff0c07-010\uff09\uff0c\u56fd\u5bb6\u81ea\u7136\u79d1\u5b66\u57fa\u91d1 \uff08\u6279\u51c6 CNS-0509559\uff09\uff0c\u52a0\u5dde\u5927\u5b66\u5de5\u4e1a/\u5927\u5b66\u5408\u4f5c\u7814\u7a76\u9879\u76ee \uff08UC Discovery\uff09\u6388\u4e88\u7684COM07-10240\uff0c\u4ee5\u53ca\u81ea\u7136\u79d1\u5b66\u548c\u52a0\u62ff\u5927\u5de5\u7a0b\u7814\u7a76\u7406\u4e8b\u4f1a\u3002</p>\u000a<h2>\u53c2\u8003</h2>\u000a<p>[1] Amazon EC2. http://aws.amazon.com/ec2.<br />\u000a[2] Apache Hadoop. http://hadoop.apache.org.<br />\u000a[3] Apache Hive. http://hadoop.apache.org/hive.<br />\u000a[4] Applications powered by Hadoop. http://wiki.apache.org/hadoop/PoweredBy.<br />\u000a[5] Scala. http://www.scala-lang.org.<br />\u000a[6] R. Bose and J. Frew. Lineage retrieval for scientific data processing: a survey. ACM Computing Surveys, 37:1\u201328,<br />\u000a2005.<br />\u000a[7] S. Brin and L. Page. The anatomy of a large-scale hypertextual web search engine. In WWW, 1998.<br />\u000a[8] Y. Bu, B. Howe, M. Balazinska, and M. D. Ernst. HaLoop: efficient iterative data processing on large clusters. Proc. VLDB Endow., 3:285\u2013296, September 2010.<br />\u000a[9] C. Chambers, A. Raniwala, F. Perry, S. Adams, R. R. Henry, R. Bradshaw, and N. Weizenbaum. Flumejava: easy, efficient data-parallel pipelines. In Proceedings of the 2010 ACM SIGPLAN conference on Programming language design and implementation, PLDI \u201910. ACM, 2010.<br />\u000a[10] J. Cheney, L. Chiticariu, and W.-C. Tan. Provenance in databases: Why, how, and where. Foundations and Trends in Databases, 1(4):379\u2013474, 2009.<br />\u000a[11] C. T. Chu, S. K. Kim, Y. A. Lin, Y. Yu, G. R. Bradski, A. Y. Ng, and K. Olukotun. Map-reduce for machine learning on multicore. In NIPS \u201906, pages 281\u2013288. MIT Press, 2006.<br />\u000a[12] J. Dean and S. Ghemawat. MapReduce: Simplified data processing on large clusters. In OSDI, 2004.<br />\u000a[13] J. Ekanayake, H. Li, B. Zhang, T. Gunarathne, S.-H. Bae, J. Qiu, and G. Fox. Twister: a runtime for iterative mapreduce. In HPDC \u201910, 2010.<br />\u000a[14] P. K. Gunda, L. Ravindranath, C. A. Thekkath, Y. Yu, and L. Zhuang. Nectar: automatic management of data and computation in datacenters. In OSDI \u201910, 2010.<br />\u000a[15] T. Hastie, R. Tibshirani, and J. Friedman. The Elements of Statistical Learning: Data Mining, Inference, and Prediction. Springer Publishing Company, New York, NY, 2009.<br />\u000a[16] U. Hoelzle and L. A. Barroso. The Datacenter as a Computer: An Introduction to the Design of Warehouse-Scale Machines. Morgan and Claypool Publishers, 1st edition, 2009.<br />\u000a[17] Mobile Millennium Project. http://traffic.berkeley.edu.<br />\u000a[18] M. Isard, M. Budiu, Y. Yu, A. Birrell, and D. Fetterly. Dryad: distributed data-parallel programs from sequential building blocks. In EuroSys 07, 2007.<br />\u000a[19] A.-M. Kermarrec, G. Cabillic, A. Gefflaut, C. Morin, and I. Puaut. A recoverable distributed shared memory integrating coherence and recoverability. In FTCS \u201995, 1995.<br />\u000a[20] S. Y. Ko, I. Hoque, B. Cho, and I. Gupta. On availability of intermediate data in cloud computations. In HotOS<br />\u000a\u201909, 2009.<br />\u000a[21] G. Malewicz, M. H. Austern, A. J. Bik, J. C. Dehnert, I. Horn, N. Leiser, and G. Czajkowski. Pregel: a system for large-scale graph processing. In SIGMOD, pages 135\u2013146, 2010.<br />\u000a[22] S. Melnik, A. Gubarev, J. J. Long, G. Romer, S. Shivakumar, M. Tolton, and T. Vassilakis. Dremel: interactive analysis of web-scale datasets. Proc. VLDB Endow., 3:330\u2013339, Sept 2010.<br />\u000a[23] D. G. Murray, M. Schwarzkopf, C. Smowton, S. Smith, A. Madhavapeddy, and S. Hand. Ciel: a universal execution engine for distributed data-flow computing. In NSDI, 2011.<br />\u000a[24] B. Nitzberg and V. Lo. Distributed shared memory: a survey of issues and algorithms. Computer, 24(8):52\u201360, aug 1991.<br />\u000a[25] C. Olston, B. Reed, U. Srivastava, R. Kumar, and A. Tomkins. Pig latin: a not-so-foreign language for data processing. In SIGMOD \u201908, pages 1099\u20131110.<br />\u000a[26] J. Ousterhout, P. Agrawal, D. Erickson, C. Kozyrakis, J. Leverich, D. Mazi ` eres, S. Mitra, A. Narayanan, G. Parulkar, M. Rosenblum, S. M. Rumble, E. Stratmann, and R. Stutsman. The case for RAMClouds: scalable high-performance storage entirely in dram. SIGOPS Oper. Syst. Rev., 43:92\u2013105, Jan 2010.<br />\u000a[27] D. Peng and F. Dabek. Large-scale incremental processing using distributed transactions and notifications. In OSDI 2010.<br />\u000a[28] R. Power and J. Li. Piccolo: Building fast, distributed programs with partitioned tables. In Proc. OSDI 2010,<br />\u000a2010.<br />\u000a[29] R. Ramakrishnan and J. Gehrke. Database Management Systems. McGraw-Hill, Inc., 3 edition, 2003.<br />\u000a[30] D. Spiewak and T. Zhao. ScalaQL: Language-integrated database queries for scala. In SLE, pages 154\u2013163, 2009.<br />\u000a[31] K. Thomas, C. Grier, J. Ma, V. Paxson, and D. Song. Design and evaluation of a real-time URL spam filtering service. In IEEE Symposium on Security and Privacy, 2011.<br />\u000a[32] L. G. Valiant. A bridging model for parallel computation. Commun. ACM, 33:103\u2013111, August 1990.<br />\u000a[33] J. W. Young. A first order approximation to the optimum checkpoint interval. Commun. ACM, 17:530\u2013531, Sept 1974.<br />\u000a[34] Y. Yu, M. Isard, D. Fetterly, M. Budiu, U. Erlingsson, P. K. Gunda, and J. Currey. DryadLINQ: A system for general-purpose distributed data-parallel computing using a high-level language. In OSDI \u201908, 2008.</p>\u000a            <!-- \u7f72\u540d\u53ca\u8bb8\u53ef\u534f\u8bae -->\u000a            <div id="i_signature" style="display: block;background-color: #f8f8ee; border: solid 1px #e8e7d0; padding: 5px 10px 0px 10px; min-height: 10px; margin-bottom: 20px; margin-top: 20px; color: #666666;"><a target="_blank" href="http://creativecommons.org/licenses/by-nc-sa/4.0" rel="license"><img align="left" src="https://licensebuttons.net/l/by-nc-sa/4.0/88x31.png" style="border-width: 0pt;" alt="Creative Commons License"></a><p>\u672c\u6587\u57fa\u4e8e<a target="_blank" title="Attribution-NonCommercial 4.0 Unported" href="http://creativecommons.org/licenses/by-nc-sa/4.0/deed.zh">\u7f72\u540d-\u975e\u5546\u4e1a\u6027\u4f7f\u7528-\u76f8\u540c\u65b9\u5f0f\u5171\u4eab 4.0</a>\u8bb8\u53ef\u534f\u8bae\u53d1\u5e03\uff0c\u6b22\u8fce\u8f6c\u8f7d\u3001\u4f7f\u7528\u3001\u91cd\u65b0\u53d1\u5e03\uff0c\u4f46\u52a1\u5fc5\u4fdd\u7559\u6587\u7ae0\u7f72\u540d<a href="http://shiyanjun.cn" target="_blank">\u65f6\u5ef6\u519b</a>\uff08\u5305\u542b\u94fe\u63a5\uff1ahttp://shiyanjun.cn\uff09\uff0c\u4e0d\u5f97\u7528\u4e8e\u5546\u4e1a\u76ee\u7684\uff0c\u57fa\u4e8e\u672c\u6587\u4fee\u6539\u540e\u7684\u4f5c\u54c1\u52a1\u5fc5\u4ee5\u76f8\u540c\u7684\u8bb8\u53ef\u53d1\u5e03\u3002\u5982\u6709\u4efb\u4f55\u7591\u95ee\uff0c\u8bf7\u4e0e\u6211<a href="mailto:i@shiyanjun.cn" target="_blank">\u8054\u7cfb</a>\u3002</p>\u000a		            </div>\u000a	</div><!-- .entry-content -->\u000a\u000a	<footer class="entry-meta">\u000a		\u000a	</footer><!-- .entry-meta -->\u000a</article><!-- #post-744 -->\u000a\u000a					<nav id="nav-below">\u000a		<h1 class="assistive-text section-heading">Post navigation</h1>\u000a\u000a	\u000a		<div class="nav-previous" title="\u4e0a\u4e00\u7bc7"><a href="http://shiyanjun.cn/archives/742.html" rel="prev"><span class="meta-nav">&larr;</span> \u4f7f\u7528Java\u7f16\u5199\u5e76\u8fd0\u884cSpark\u5e94\u7528\u7a0b\u5e8f</a></div>		<div class="nav-next" title="\u4e0b\u4e00\u7bc7"><a href="http://shiyanjun.cn/archives/772.html" rel="next">Shark-0.9.0\u5b89\u88c5\u914d\u7f6e\u8fd0\u884c\u5b9e\u8df5 <span class="meta-nav">&rarr;</span></a></div>\u000a	\u000a	</nav><!-- #nav-below -->\u000a	\u000a					<div id="comments">\u000a	\u000a	\u000a			<h2 id="comments-title">\u000a			\u8bc4\u8bba(7)\uff1a &ldquo;<span>RDD\uff1a\u57fa\u4e8e\u5185\u5b58\u7684\u96c6\u7fa4\u8ba1\u7b97\u5bb9\u9519\u62bd\u8c61</span>&rdquo;		</h2>\u000a\u000a\u000a		<ol class="commentlist">\u000a				<li class="comment even thread-even depth-1" id="li-comment-18958">\u000a		<article id="comment-18958" class="comment">\u000a			<footer class="clearfix comment-head">\u000a				<div class="comment-author vcard">\u000a					<img src="http://shiyanjuncn.b0.upaiyun.com/wp-content/uploads/2014/11/User.png" width="40" height="40" alt="" class="avatar avatar-40 wp-user-avatar wp-user-avatar-40 alignnone photo avatar-default" />					<cite class="fn">heipark</cite>				</div><!-- .comment-author .vcard -->\u000a				\u000a				<div class="comment-meta commentmetadata">\u000a					<a href="http://shiyanjun.cn/archives/744.html#comment-18958"><time pubdate datetime="2014-06-18T22:21:29+00:00">\u000a					2014-06-18 22:21:29					</time></a>\u000a									</div><!-- .comment-meta .commentmetadata -->\u000a			</footer>\u000a\u000a			<div class="comment-content"><p>\u975e\u5e38\u597d\uff01\u611f\u8c22\uff01</p>\u000a</div>\u000a\u000a			<div class="reply">\u000a				<a class='comment-reply-link' href='/archives/744.html?replytocom=18958#respond' onclick='return addComment.moveForm("comment-18958", "18958", "respond", "744")'>\u56de\u590d</a>			</div><!-- .reply -->\u000a		</article><!-- #comment-## -->\u000a\u000a	</li><!-- #comment-## -->\u000a	<li class="comment odd alt thread-odd thread-alt depth-1" id="li-comment-22479">\u000a		<article id="comment-22479" class="comment">\u000a			<footer class="clearfix comment-head">\u000a				<div class="comment-author vcard">\u000a					<img src="http://shiyanjuncn.b0.upaiyun.com/wp-content/uploads/2014/11/User.png" width="40" height="40" alt="" class="avatar avatar-40 wp-user-avatar wp-user-avatar-40 alignnone photo avatar-default" />					<cite class="fn">yzmyyff</cite>				</div><!-- .comment-author .vcard -->\u000a				\u000a				<div class="comment-meta commentmetadata">\u000a					<a href="http://shiyanjun.cn/archives/744.html#comment-22479"><time pubdate datetime="2014-08-21T10:40:46+00:00">\u000a					2014-08-21 10:40:46					</time></a>\u000a									</div><!-- .comment-meta .commentmetadata -->\u000a			</footer>\u000a\u000a			<div class="comment-content"><p>\u5bf9\u4e8e\u61d2\u5f97\u770b\u539f\u6587\u7684\u4eba\u7b80\u76f4\u5c31\u662f\u798f\u97f3, \u975e\u5e38\u611f\u8c22.</p>\u000a</div>\u000a\u000a			<div class="reply">\u000a				<a class='comment-reply-link' href='/archives/744.html?replytocom=22479#respond' onclick='return addComment.moveForm("comment-22479", "22479", "respond", "744")'>\u56de\u590d</a>			</div><!-- .reply -->\u000a		</article><!-- #comment-## -->\u000a\u000a	</li><!-- #comment-## -->\u000a	<li class="comment even thread-even depth-1" id="li-comment-25621">\u000a		<article id="comment-25621" class="comment">\u000a			<footer class="clearfix comment-head">\u000a				<div class="comment-author vcard">\u000a					<img src="http://shiyanjuncn.b0.upaiyun.com/wp-content/uploads/2014/11/User.png" width="40" height="40" alt="" class="avatar avatar-40 wp-user-avatar wp-user-avatar-40 alignnone photo avatar-default" />					<cite class="fn">Jonh</cite>				</div><!-- .comment-author .vcard -->\u000a				\u000a				<div class="comment-meta commentmetadata">\u000a					<a href="http://shiyanjun.cn/archives/744.html#comment-25621"><time pubdate datetime="2014-09-26T15:15:48+00:00">\u000a					2014-09-26 15:15:48					</time></a>\u000a									</div><!-- .comment-meta .commentmetadata -->\u000a			</footer>\u000a\u000a			<div class="comment-content"><p>\u6700\u8fd1\u5728\u5b66Scala\uff0c\u5f88\u6709\u7528\uff0c\u597d\u8d34\uff0c\u9876\u554a\u3002</p>\u000a</div>\u000a\u000a			<div class="reply">\u000a				<a class='comment-reply-link' href='/archives/744.html?replytocom=25621#respond' onclick='return addComment.moveForm("comment-25621", "25621", "respond", "744")'>\u56de\u590d</a>			</div><!-- .reply -->\u000a		</article><!-- #comment-## -->\u000a\u000a	</li><!-- #comment-## -->\u000a	<li class="comment odd alt thread-odd thread-alt depth-1" id="li-comment-56443">\u000a		<article id="comment-56443" class="comment">\u000a			<footer class="clearfix comment-head">\u000a				<div class="comment-author vcard">\u000a					<img src="http://shiyanjuncn.b0.upaiyun.com/wp-content/uploads/2014/11/User.png" width="40" height="40" alt="" class="avatar avatar-40 wp-user-avatar wp-user-avatar-40 alignnone photo avatar-default" />					<cite class="fn">rp</cite>				</div><!-- .comment-author .vcard -->\u000a				\u000a				<div class="comment-meta commentmetadata">\u000a					<a href="http://shiyanjun.cn/archives/744.html#comment-56443"><time pubdate datetime="2015-11-09T15:24:25+00:00">\u000a					2015-11-09 15:24:25					</time></a>\u000a									</div><!-- .comment-meta .commentmetadata -->\u000a			</footer>\u000a\u000a			<div class="comment-content"><p>\u8001\u5b9e\u8bf4\uff0c\u6ca1\u6709\u4e00\u90e8\u5206\u6279\u5904\u7406\u57fa\u7840\u6839\u672c\u770b\u4e0d\u61c2\u3002\u5f53\u7136\u6587\u7ae0\u8fd8\u662f\u7ffb\u8bd1\u7684\u4e0d\u9519\u7684\uff0c\u5c31\u662f\u6574\u4e2a\u611f\u89c9spark\u50cfhadoop\uff0c\u5b66\u4e60\u7406\u89e3\u6210\u672c\u6709\u70b9\u9ad8\uff0c\u8fd9\u4e00\u70b9\u5c31\u4e0d\u5982storm\uff0c\u5f53\u7136\uff0c\u6574\u5408\u7684\u6a21\u5757\u4ec0\u4e48\u7684storm\u4e5f\u786e\u5b9e\u6bd4\u4e0d\u4e86\u3002</p>\u000a</div>\u000a\u000a			<div class="reply">\u000a				<a class='comment-reply-link' href='/archives/744.html?replytocom=56443#respond' onclick='return addComment.moveForm("comment-56443", "56443", "respond", "744")'>\u56de\u590d</a>			</div><!-- .reply -->\u000a		</article><!-- #comment-## -->\u000a\u000a	</li><!-- #comment-## -->\u000a	<li class="comment even thread-even depth-1" id="li-comment-56556">\u000a		<article id="comment-56556" class="comment">\u000a			<footer class="clearfix comment-head">\u000a				<div class="comment-author vcard">\u000a					<img src="http://shiyanjuncn.b0.upaiyun.com/wp-content/uploads/2014/11/User.png" width="40" height="40" alt="" class="avatar avatar-40 wp-user-avatar wp-user-avatar-40 alignnone photo avatar-default" />					<cite class="fn">aren33</cite>				</div><!-- .comment-author .vcard -->\u000a				\u000a				<div class="comment-meta commentmetadata">\u000a					<a href="http://shiyanjun.cn/archives/744.html#comment-56556"><time pubdate datetime="2015-11-27T15:01:06+00:00">\u000a					2015-11-27 15:01:06					</time></a>\u000a									</div><!-- .comment-meta .commentmetadata -->\u000a			</footer>\u000a\u000a			<div class="comment-content"><p>\u8c22\u8c22\u5206\u4eab, \u6536\u85cf\u4e86</p>\u000a</div>\u000a\u000a			<div class="reply">\u000a				<a class='comment-reply-link' href='/archives/744.html?replytocom=56556#respond' onclick='return addComment.moveForm("comment-56556", "56556", "respond", "744")'>\u56de\u590d</a>			</div><!-- .reply -->\u000a		</article><!-- #comment-## -->\u000a\u000a	</li><!-- #comment-## -->\u000a	<li class="comment odd alt thread-odd thread-alt depth-1" id="li-comment-57268">\u000a		<article id="comment-57268" class="comment">\u000a			<footer class="clearfix comment-head">\u000a				<div class="comment-author vcard">\u000a					<img src="http://shiyanjuncn.b0.upaiyun.com/wp-content/uploads/2014/11/User.png" width="40" height="40" alt="" class="avatar avatar-40 wp-user-avatar wp-user-avatar-40 alignnone photo avatar-default" />					<cite class="fn"><a href='http://blog.wojiaohgl.com' rel='external nofollow' class='url'>\u97e9</a></cite>				</div><!-- .comment-author .vcard -->\u000a				\u000a				<div class="comment-meta commentmetadata">\u000a					<a href="http://shiyanjun.cn/archives/744.html#comment-57268"><time pubdate datetime="2016-04-18T14:56:56+00:00">\u000a					2016-04-18 14:56:56					</time></a>\u000a									</div><!-- .comment-meta .commentmetadata -->\u000a			</footer>\u000a\u000a			<div class="comment-content"><p>narrow dependencies, where each<br />\u000apartition of the parent RDD is used by at most one partition<br />\u000aof the child RDD, wide dependencies, where multiple<br />\u000achild partitions may depend on it<br />\u000a\u8fd9\u4e2a\u7ffb\u8bd1\u8fc7\u6765\u4e0d\u5e94\u8be5\u662f<br />\u000a\u7a84\u4f9d\u8d56\uff1a\u7236RDD\u7684\u6bcf\u4e2a\u5206\u533a\u4ec5\u88ab\u81f3\u591a\u4e00\u4e2a\u5b50RDD\u5206\u533a\u4f7f\u7528<br />\u000a\u5bbd\u4f9d\u8d56\uff1a\u591a\u4e2a\u5b50\u5206\u533a\u53ef\u4ee5\u4f9d\u8d56\u4e8e\u5b83\uff08\u5373\u4e00\u4e2a\u7236RDD\u7684\u5206\u533a\u53ef\u4ee5\u88ab\u591a\u4e2a\u5b50RDD\u5206\u533a\u4f7f\u7528\uff09</p>\u000a</div>\u000a\u000a			<div class="reply">\u000a				<a class='comment-reply-link' href='/archives/744.html?replytocom=57268#respond' onclick='return addComment.moveForm("comment-57268", "57268", "respond", "744")'>\u56de\u590d</a>			</div><!-- .reply -->\u000a		</article><!-- #comment-## -->\u000a\u000a	</li><!-- #comment-## -->\u000a	<li class="comment even thread-even depth-1" id="li-comment-57724">\u000a		<article id="comment-57724" class="comment">\u000a			<footer class="clearfix comment-head">\u000a				<div class="comment-author vcard">\u000a					<img src="http://shiyanjuncn.b0.upaiyun.com/wp-content/uploads/2014/11/User.png" width="40" height="40" alt="" class="avatar avatar-40 wp-user-avatar wp-user-avatar-40 alignnone photo avatar-default" />					<cite class="fn"><a href='http://shiyanjun.cn/archives/744.html' rel='external nofollow' class='url'>Michael</a></cite>				</div><!-- .comment-author .vcard -->\u000a				\u000a				<div class="comment-meta commentmetadata">\u000a					<a href="http://shiyanjun.cn/archives/744.html#comment-57724"><time pubdate datetime="2016-08-30T21:10:12+00:00">\u000a					2016-08-30 21:10:12					</time></a>\u000a									</div><!-- .comment-meta .commentmetadata -->\u000a			</footer>\u000a\u000a			<div class="comment-content"><p>\u771f\u5fc3\u4e0d\u9519\u3002\u8bba\u6587\u5f88\u4e0d\u9519\uff0c\u7ffb\u8bd1\u5f97\u5f88\u68d2</p>\u000a</div>\u000a\u000a			<div class="reply">\u000a				<a class='comment-reply-link' href='/archives/744.html?replytocom=57724#respond' onclick='return addComment.moveForm("comment-57724", "57724", "respond", "744")'>\u56de\u590d</a>			</div><!-- .reply -->\u000a		</article><!-- #comment-## -->\u000a\u000a	</li><!-- #comment-## -->\u000a		</ol>\u000a\u000a		\u000a	\u000a	\u000a									<div id="respond" class="comment-respond">\u000a				<h3 id="reply-title" class="comment-reply-title">\u53d1\u8868\u8bc4\u8bba <small><a rel="nofollow" id="cancel-comment-reply-link" href="/archives/744.html#respond" style="display:none;">\u53d6\u6d88\u56de\u590d</a></small></h3>\u000a									<form action="http://shiyanjun.cn/wp-comments-post.php" method="post" id="commentform" class="comment-form">\u000a																			<p class="comment-notes">\u7535\u5b50\u90ae\u4ef6\u5730\u5740\u4e0d\u4f1a\u88ab\u516c\u5f00\u3002 \u5fc5\u586b\u9879\u5df2\u7528<span class="required">*</span>\u6807\u6ce8</p>							<p class="comment-form-author"><label for="author">\u59d3\u540d <span class="required">*</span></label> <input id="author" name="author" type="text" value="" size="30" aria-required='true' /></p>\u000a<p class="comment-form-email"><label for="email">\u7535\u5b50\u90ae\u4ef6 <span class="required">*</span></label> <input id="email" name="email" type="text" value="" size="30" aria-required='true' /></p>\u000a<p class="comment-form-url"><label for="url">\u7ad9\u70b9</label> <input id="url" name="url" type="text" value="" size="30" /></p>\u000a												<p class="comment-form-comment"><label for="comment">\u8bc4\u8bba</label> <textarea id="comment" name="comment" cols="45" rows="8" aria-required="true"></textarea></p>						<p class="form-allowed-tags">\u60a8\u53ef\u4ee5\u4f7f\u7528\u8fd9\u4e9b<abbr title="HyperText Markup Language">HTML</abbr>\u6807\u7b7e\u548c\u5c5e\u6027\uff1a <code>&lt;a href=&quot;&quot; title=&quot;&quot;&gt; &lt;abbr title=&quot;&quot;&gt; &lt;acronym title=&quot;&quot;&gt; &lt;b&gt; &lt;blockquote cite=&quot;&quot;&gt; &lt;cite&gt; &lt;code&gt; &lt;del datetime=&quot;&quot;&gt; &lt;em&gt; &lt;i&gt; &lt;q cite=&quot;&quot;&gt; &lt;strike&gt; &lt;strong&gt; </code></p>						<p class="form-submit">\u000a							<input name="submit" type="submit" id="submit" value="\u53d1\u8868\u8bc4\u8bba" />\u000a							<input type='hidden' name='comment_post_ID' value='744' id='comment_post_ID' />\u000a<input type='hidden' name='comment_parent' id='comment_parent' value='0' />\u000a						</p>\u000a						<p style="display: none;"><input type="hidden" id="akismet_comment_nonce" name="akismet_comment_nonce" value="a0128151fd" /></p><p style="display: none;"><input type="hidden" id="ak_js" name="ak_js" value="237"/></p>					</form>\u000a							</div><!-- #respond -->\u000a			\u000a</div><!-- #comments -->\u000a			\u000a        </div> <!-- end #main -->\u000a\u000a        		<div id="sidebar" class="widget-area col300" role="complementary">\u000a					<div class="widget-wrap"><aside id="recent-posts-2" class="widget widget_recent_entries">		<h2 class="widget-title">\u6700\u65b0\u6587\u7ae0</h2>		<ul>\u000a					<li>\u000a				<a href="http://shiyanjun.cn/archives/1545.html">Spark Standalone\u67b6\u6784\u8bbe\u8ba1\u8981\u70b9\u5206\u6790</a>\u000a						</li>\u000a					<li>\u000a				<a href="http://shiyanjun.cn/archives/1536.html">Spark RPC\u901a\u4fe1\u5c42\u8bbe\u8ba1\u539f\u7406\u5206\u6790</a>\u000a						</li>\u000a					<li>\u000a				<a href="http://shiyanjun.cn/archives/1508.html">Apache Flink\uff1a\u7279\u6027\u3001\u6982\u5ff5\u3001\u7ec4\u4ef6\u6808\u3001\u67b6\u6784\u53ca\u539f\u7406\u5206\u6790</a>\u000a						</li>\u000a					<li>\u000a				<a href="http://shiyanjun.cn/archives/1497.html">Flume\u65e5\u5fd7\u6536\u96c6\u5206\u5c42\u67b6\u6784\u5e94\u7528\u5b9e\u8df5</a>\u000a						</li>\u000a					<li>\u000a				<a href="http://shiyanjun.cn/archives/1472.html">Apache Storm\u5185\u90e8\u539f\u7406\u5206\u6790</a>\u000a						</li>\u000a					<li>\u000a				<a href="http://shiyanjun.cn/archives/1457.html">MapReduce V1\uff1aMapTask\u6267\u884c\u6d41\u7a0b\u5206\u6790</a>\u000a						</li>\u000a					<li>\u000a				<a href="http://shiyanjun.cn/archives/1429.html">\u57fa\u4e8e\u534f\u540c\u8fc7\u6ee4\u7684\u63a8\u8350\u65b9\u6cd5</a>\u000a						</li>\u000a					<li>\u000a				<a href="http://shiyanjun.cn/archives/1418.html">MapReduce V1\uff1aTaskTracker\u7aef\u542f\u52a8Task\u6d41\u7a0b\u5206\u6790</a>\u000a						</li>\u000a					<li>\u000a				<a href="http://shiyanjun.cn/archives/1408.html">MapReduce V1\uff1aTaskTracker\u8bbe\u8ba1\u8981\u70b9\u6982\u8981\u5206\u6790</a>\u000a						</li>\u000a					<li>\u000a				<a href="http://shiyanjun.cn/archives/1398.html">k-medoids\u805a\u7c7b\u7b97\u6cd5\u5b9e\u73b0</a>\u000a						</li>\u000a				</ul>\u000a		</aside></div><div class="widget-wrap"><aside id="categories-2" class="widget widget_categories"><h2 class="widget-title">\u6587\u7ae0\u5206\u7c7b</h2>		<ul>\u000a	<li class="cat-item cat-item-8"><a href="http://shiyanjun.cn/archives/category/opensource" title="\u67e5\u770b\u5f00\u6e90\u6280\u672f\u4e0b\u7684\u6240\u6709\u6587\u7ae0">\u5f00\u6e90\u6280\u672f</a> (83)\u000a<ul class='children'>\u000a	<li class="cat-item cat-item-86"><a href="http://shiyanjun.cn/archives/category/opensource/akka" title="\u67e5\u770bAkka\u4e0b\u7684\u6240\u6709\u6587\u7ae0">Akka</a> (3)\u000a</li>\u000a	<li class="cat-item cat-item-84"><a href="http://shiyanjun.cn/archives/category/opensource/crunch" title="\u67e5\u770bCrunch\u4e0b\u7684\u6240\u6709\u6587\u7ae0">Crunch</a> (1)\u000a</li>\u000a	<li class="cat-item cat-item-36"><a href="http://shiyanjun.cn/archives/category/opensource/dubbo" title="\u67e5\u770bDubbo\u4e0b\u7684\u6240\u6709\u6587\u7ae0">Dubbo</a> (4)\u000a</li>\u000a	<li class="cat-item cat-item-88"><a href="http://shiyanjun.cn/archives/category/opensource/elasticsearch" title="\u67e5\u770bElasticSearch\u4e0b\u7684\u6240\u6709\u6587\u7ae0">ElasticSearch</a> (1)\u000a</li>\u000a	<li class="cat-item cat-item-95"><a href="http://shiyanjun.cn/archives/category/opensource/flink" title="\u67e5\u770bFlink\u4e0b\u7684\u6240\u6709\u6587\u7ae0">Flink</a> (1)\u000a</li>\u000a	<li class="cat-item cat-item-79"><a href="http://shiyanjun.cn/archives/category/opensource/flume" title="\u67e5\u770bFlume\u4e0b\u7684\u6240\u6709\u6587\u7ae0">Flume</a> (2)\u000a</li>\u000a	<li class="cat-item cat-item-9"><a href="http://shiyanjun.cn/archives/category/opensource/hadoop" title="\u67e5\u770bHadoop\u4e0b\u7684\u6240\u6709\u6587\u7ae0">Hadoop</a> (23)\u000a</li>\u000a	<li class="cat-item cat-item-62"><a href="http://shiyanjun.cn/archives/category/opensource/hive" title="\u67e5\u770bHive\u4e0b\u7684\u6240\u6709\u6587\u7ae0">Hive</a> (2)\u000a</li>\u000a	<li class="cat-item cat-item-82"><a href="http://shiyanjun.cn/archives/category/opensource/hue" title="\u67e5\u770bHue\u4e0b\u7684\u6240\u6709\u6587\u7ae0">Hue</a> (1)\u000a</li>\u000a	<li class="cat-item cat-item-61"><a href="http://shiyanjun.cn/archives/category/opensource/impala" title="\u67e5\u770bImpala\u4e0b\u7684\u6240\u6709\u6587\u7ae0">Impala</a> (2)\u000a</li>\u000a	<li class="cat-item cat-item-93"><a href="http://shiyanjun.cn/archives/category/opensource/mahout" title="\u67e5\u770bMahout\u4e0b\u7684\u6240\u6709\u6587\u7ae0">Mahout</a> (1)\u000a</li>\u000a	<li class="cat-item cat-item-29"><a href="http://shiyanjun.cn/archives/category/opensource/maven" title="\u67e5\u770bMaven\u4e0b\u7684\u6240\u6709\u6587\u7ae0">Maven</a> (1)\u000a</li>\u000a	<li class="cat-item cat-item-30"><a href="http://shiyanjun.cn/archives/category/opensource/mina" title="\u67e5\u770bMina\u4e0b\u7684\u6240\u6709\u6587\u7ae0">Mina</a> (6)\u000a</li>\u000a	<li class="cat-item cat-item-73"><a href="http://shiyanjun.cn/archives/category/opensource/mybatis" title="\u67e5\u770bMybatis\u4e0b\u7684\u6240\u6709\u6587\u7ae0">Mybatis</a> (1)\u000a</li>\u000a	<li class="cat-item cat-item-15"><a href="http://shiyanjun.cn/archives/category/opensource/oozie" title="\u67e5\u770bOozie\u4e0b\u7684\u6240\u6709\u6587\u7ae0">Oozie</a> (4)\u000a</li>\u000a	<li class="cat-item cat-item-85"><a href="http://shiyanjun.cn/archives/category/opensource/pig" title="\u67e5\u770bPig\u4e0b\u7684\u6240\u6709\u6587\u7ae0">Pig</a> (1)\u000a</li>\u000a	<li class="cat-item cat-item-11"><a href="http://shiyanjun.cn/archives/category/opensource/solr" title="\u67e5\u770bSolr\u4e0b\u7684\u6240\u6709\u6587\u7ae0">Solr</a> (5)\u000a</li>\u000a	<li class="cat-item cat-item-68"><a href="http://shiyanjun.cn/archives/category/opensource/spark" title="\u67e5\u770bSpark\u4e0b\u7684\u6240\u6709\u6587\u7ae0">Spark</a> (8)\u000a</li>\u000a	<li class="cat-item cat-item-67"><a href="http://shiyanjun.cn/archives/category/opensource/sqoop" title="\u67e5\u770bSqoop\u4e0b\u7684\u6240\u6709\u6587\u7ae0">Sqoop</a> (3)\u000a</li>\u000a	<li class="cat-item cat-item-35"><a href="http://shiyanjun.cn/archives/category/opensource/storm" title="\u67e5\u770bStorm\u4e0b\u7684\u6240\u6709\u6587\u7ae0">Storm</a> (5)\u000a</li>\u000a	<li class="cat-item cat-item-22"><a href="http://shiyanjun.cn/archives/category/opensource/thrift" title="\u67e5\u770bThrift\u4e0b\u7684\u6240\u6709\u6587\u7ae0">Thrift</a> (2)\u000a</li>\u000a	<li class="cat-item cat-item-38"><a href="http://shiyanjun.cn/archives/category/opensource/webservices" title="\u67e5\u770bWeb Services\u4e0b\u7684\u6240\u6709\u6587\u7ae0">Web Services</a> (1)\u000a</li>\u000a	<li class="cat-item cat-item-23"><a href="http://shiyanjun.cn/archives/category/opensource/zookeeper" title="\u67e5\u770bZooKeeper\u4e0b\u7684\u6240\u6709\u6587\u7ae0">ZooKeeper</a> (3)\u000a</li>\u000a</ul>\u000a</li>\u000a	<li class="cat-item cat-item-18"><a href="http://shiyanjun.cn/archives/category/database" title="\u67e5\u770b\u6570\u636e\u5e93\u4e0b\u7684\u6240\u6709\u6587\u7ae0">\u6570\u636e\u5e93</a> (5)\u000a<ul class='children'>\u000a	<li class="cat-item cat-item-20"><a href="http://shiyanjun.cn/archives/category/database/nosql" title="\u67e5\u770bNoSQL\u6570\u636e\u5e93\u4e0b\u7684\u6240\u6709\u6587\u7ae0">NoSQL\u6570\u636e\u5e93</a> (4)\u000a	<ul class='children'>\u000a	<li class="cat-item cat-item-10"><a href="http://shiyanjun.cn/archives/category/database/nosql/hbase" title="\u67e5\u770bHBase\u4e0b\u7684\u6240\u6709\u6587\u7ae0">HBase</a> (3)\u000a</li>\u000a	<li class="cat-item cat-item-21"><a href="http://shiyanjun.cn/archives/category/database/nosql/redis" title="\u67e5\u770bRedis\u4e0b\u7684\u6240\u6709\u6587\u7ae0">Redis</a> (1)\u000a</li>\u000a	</ul>\u000a</li>\u000a	<li class="cat-item cat-item-19"><a href="http://shiyanjun.cn/archives/category/database/rdb" title="\u67e5\u770b\u5173\u7cfb\u6570\u636e\u5e93\u4e0b\u7684\u6240\u6709\u6587\u7ae0">\u5173\u7cfb\u6570\u636e\u5e93</a> (1)\u000a	<ul class='children'>\u000a	<li class="cat-item cat-item-49"><a href="http://shiyanjun.cn/archives/category/database/rdb/mysql" title="\u67e5\u770bMySQL\u4e0b\u7684\u6240\u6709\u6587\u7ae0">MySQL</a> (1)\u000a</li>\u000a	</ul>\u000a</li>\u000a</ul>\u000a</li>\u000a	<li class="cat-item cat-item-12"><a href="http://shiyanjun.cn/archives/category/datamining" title="\u67e5\u770b\u6570\u636e\u6316\u6398\u4e0b\u7684\u6240\u6709\u6587\u7ae0">\u6570\u636e\u6316\u6398</a> (10)\u000a</li>\u000a	<li class="cat-item cat-item-16"><a href="http://shiyanjun.cn/archives/category/server" title="\u67e5\u770b\u670d\u52a1\u5668\u4e0b\u7684\u6240\u6709\u6587\u7ae0">\u670d\u52a1\u5668</a> (4)\u000a<ul class='children'>\u000a	<li class="cat-item cat-item-78"><a href="http://shiyanjun.cn/archives/category/server/ganglia" title="\u67e5\u770bGanglia\u4e0b\u7684\u6240\u6709\u6587\u7ae0">Ganglia</a> (1)\u000a</li>\u000a	<li class="cat-item cat-item-37"><a href="http://shiyanjun.cn/archives/category/server/haproxy" title="\u67e5\u770bHAProxy\u4e0b\u7684\u6240\u6709\u6587\u7ae0">HAProxy</a> (1)\u000a</li>\u000a	<li class="cat-item cat-item-76"><a href="http://shiyanjun.cn/archives/category/server/memcached" title="\u67e5\u770bMemcached\u4e0b\u7684\u6240\u6709\u6587\u7ae0">Memcached</a> (1)\u000a</li>\u000a	<li class="cat-item cat-item-17"><a href="http://shiyanjun.cn/archives/category/server/nginx" title="\u67e5\u770bNginx\u4e0b\u7684\u6240\u6709\u6587\u7ae0">Nginx</a> (1)\u000a</li>\u000a</ul>\u000a</li>\u000a	<li class="cat-item cat-item-70"><a href="http://shiyanjun.cn/archives/category/algorithm" title="\u67e5\u770b\u7b97\u6cd5\u4e0b\u7684\u6240\u6709\u6587\u7ae0">\u7b97\u6cd5</a> (8)\u000a</li>\u000a	<li class="cat-item cat-item-2"><a href="http://shiyanjun.cn/archives/category/programming" title="\u67e5\u770b\u7f16\u7a0b\u8bed\u8a00\u4e0b\u7684\u6240\u6709\u6587\u7ae0">\u7f16\u7a0b\u8bed\u8a00</a> (4)\u000a<ul class='children'>\u000a	<li class="cat-item cat-item-3"><a href="http://shiyanjun.cn/archives/category/programming/java" title="\u67e5\u770bJava\u4e0b\u7684\u6240\u6709\u6587\u7ae0">Java</a> (2)\u000a</li>\u000a	<li class="cat-item cat-item-74"><a href="http://shiyanjun.cn/archives/category/programming/nodejs" title="\u67e5\u770bNode.js\u4e0b\u7684\u6240\u6709\u6587\u7ae0">Node.js</a> (1)\u000a</li>\u000a	<li class="cat-item cat-item-5"><a href="http://shiyanjun.cn/archives/category/programming/php" title="\u67e5\u770bPHP\u4e0b\u7684\u6240\u6709\u6587\u7ae0">PHP</a> (1)\u000a</li>\u000a</ul>\u000a</li>\u000a		</ul>\u000a</aside></div><div class="widget-wrap"><aside id="archives-2" class="widget widget_archive"><h2 class="widget-title">\u6587\u7ae0\u5b58\u6863</h2>		<ul>\u000a	<li><a href='http://shiyanjun.cn/archives/date/2016/11'>2016\u5e74\u5341\u4e00\u6708</a>&nbsp;(1)</li>\u000a	<li><a href='http://shiyanjun.cn/archives/date/2016/09'>2016\u5e74\u4e5d\u6708</a>&nbsp;(1)</li>\u000a	<li><a href='http://shiyanjun.cn/archives/date/2016/04'>2016\u5e74\u56db\u6708</a>&nbsp;(1)</li>\u000a	<li><a href='http://shiyanjun.cn/archives/date/2016/02'>2016\u5e74\u4e8c\u6708</a>&nbsp;(3)</li>\u000a	<li><a href='http://shiyanjun.cn/archives/date/2015/12'>2015\u5e74\u5341\u4e8c\u6708</a>&nbsp;(5)</li>\u000a	<li><a href='http://shiyanjun.cn/archives/date/2015/11'>2015\u5e74\u5341\u4e00\u6708</a>&nbsp;(4)</li>\u000a	<li><a href='http://shiyanjun.cn/archives/date/2015/10'>2015\u5e74\u5341\u6708</a>&nbsp;(2)</li>\u000a	<li><a href='http://shiyanjun.cn/archives/date/2015/09'>2015\u5e74\u4e5d\u6708</a>&nbsp;(1)</li>\u000a	<li><a href='http://shiyanjun.cn/archives/date/2015/08'>2015\u5e74\u516b\u6708</a>&nbsp;(3)</li>\u000a	<li><a href='http://shiyanjun.cn/archives/date/2015/07'>2015\u5e74\u4e03\u6708</a>&nbsp;(1)</li>\u000a	<li><a href='http://shiyanjun.cn/archives/date/2015/06'>2015\u5e74\u516d\u6708</a>&nbsp;(1)</li>\u000a	<li><a href='http://shiyanjun.cn/archives/date/2015/05'>2015\u5e74\u4e94\u6708</a>&nbsp;(1)</li>\u000a	<li><a href='http://shiyanjun.cn/archives/date/2015/04'>2015\u5e74\u56db\u6708</a>&nbsp;(1)</li>\u000a	<li><a href='http://shiyanjun.cn/archives/date/2015/03'>2015\u5e74\u4e09\u6708</a>&nbsp;(1)</li>\u000a	<li><a href='http://shiyanjun.cn/archives/date/2015/02'>2015\u5e74\u4e8c\u6708</a>&nbsp;(1)</li>\u000a	<li><a href='http://shiyanjun.cn/archives/date/2015/01'>2015\u5e74\u4e00\u6708</a>&nbsp;(1)</li>\u000a	<li><a href='http://shiyanjun.cn/archives/date/2014/12'>2014\u5e74\u5341\u4e8c\u6708</a>&nbsp;(2)</li>\u000a	<li><a href='http://shiyanjun.cn/archives/date/2014/11'>2014\u5e74\u5341\u4e00\u6708</a>&nbsp;(1)</li>\u000a	<li><a href='http://shiyanjun.cn/archives/date/2014/10'>2014\u5e74\u5341\u6708</a>&nbsp;(3)</li>\u000a	<li><a href='http://shiyanjun.cn/archives/date/2014/09'>2014\u5e74\u4e5d\u6708</a>&nbsp;(1)</li>\u000a	<li><a href='http://shiyanjun.cn/archives/date/2014/08'>2014\u5e74\u516b\u6708</a>&nbsp;(1)</li>\u000a	<li><a href='http://shiyanjun.cn/archives/date/2014/07'>2014\u5e74\u4e03\u6708</a>&nbsp;(2)</li>\u000a	<li><a href='http://shiyanjun.cn/archives/date/2014/06'>2014\u5e74\u516d\u6708</a>&nbsp;(2)</li>\u000a	<li><a href='http://shiyanjun.cn/archives/date/2014/05'>2014\u5e74\u4e94\u6708</a>&nbsp;(2)</li>\u000a	<li><a href='http://shiyanjun.cn/archives/date/2014/04'>2014\u5e74\u56db\u6708</a>&nbsp;(1)</li>\u000a	<li><a href='http://shiyanjun.cn/archives/date/2014/03'>2014\u5e74\u4e09\u6708</a>&nbsp;(14)</li>\u000a	<li><a href='http://shiyanjun.cn/archives/date/2014/02'>2014\u5e74\u4e8c\u6708</a>&nbsp;(4)</li>\u000a	<li><a href='http://shiyanjun.cn/archives/date/2014/01'>2014\u5e74\u4e00\u6708</a>&nbsp;(1)</li>\u000a	<li><a href='http://shiyanjun.cn/archives/date/2013/12'>2013\u5e74\u5341\u4e8c\u6708</a>&nbsp;(3)</li>\u000a	<li><a href='http://shiyanjun.cn/archives/date/2013/11'>2013\u5e74\u5341\u4e00\u6708</a>&nbsp;(5)</li>\u000a	<li><a href='http://shiyanjun.cn/archives/date/2013/10'>2013\u5e74\u5341\u6708</a>&nbsp;(6)</li>\u000a	<li><a href='http://shiyanjun.cn/archives/date/2013/09'>2013\u5e74\u4e5d\u6708</a>&nbsp;(13)</li>\u000a	<li><a href='http://shiyanjun.cn/archives/date/2013/08'>2013\u5e74\u516b\u6708</a>&nbsp;(21)</li>\u000a		</ul>\u000a</aside></div><div class="widget-wrap"><aside id="colorful_tag_cloud-2" class="widget widget_colorful_tag_cloud"><h2 class="widget-title">\u5168\u7ad9\u6807\u7b7e</h2><a href='http://shiyanjun.cn/archives/tag/mysql' class='tag-link-49' title='1' style='font-size: 12pt; color: #00a650'>MySQL</a>\u000a<a href='http://shiyanjun.cn/archives/tag/mina-2' class='tag-link-31' title='6' style='font-size: 20.5344827586pt; color: #00f'>Mina</a>\u000a<a href='http://shiyanjun.cn/archives/tag/hessian' class='tag-link-41' title='1' style='font-size: 12pt; color: #00a650'>Hessian</a>\u000a<a href='http://shiyanjun.cn/archives/tag/akka' class='tag-link-86' title='3' style='font-size: 16.6551724138pt; color: #bc8cbf'>Akka</a>\u000a<a href='http://shiyanjun.cn/archives/tag/hue' class='tag-link-82' title='1' style='font-size: 12pt; color: #00a650'>Hue</a>\u000a<a href='http://shiyanjun.cn/archives/tag/hbase' class='tag-link-10' title='4' style='font-size: 18.2068965517pt; color: #0f0'>HBase</a>\u000a<a href='http://shiyanjun.cn/archives/tag/k-means' class='tag-link-64' title='2' style='font-size: 14.7931034483pt; color: #f16522'>K-means</a>\u000a<a href='http://shiyanjun.cn/archives/tag/spark-2-0-0' class='tag-link-96' title='2' style='font-size: 14.7931034483pt; color: #f16522'>Spark-2.0.0</a>\u000a<a href='http://shiyanjun.cn/archives/tag/sqoop' class='tag-link-67' title='3' style='font-size: 16.6551724138pt; color: #bc8cbf'>Sqoop</a>\u000a<a href='http://shiyanjun.cn/archives/tag/jax-ws' class='tag-link-39' title='1' style='font-size: 12pt; color: #00a650'>JAX-WS</a>\u000a<a href='http://shiyanjun.cn/archives/tag/flink' class='tag-link-95' title='1' style='font-size: 12pt; color: #00a650'>Flink</a>\u000a<a href='http://shiyanjun.cn/archives/tag/zookeeper' class='tag-link-23' title='4' style='font-size: 18.2068965517pt; color: #0f0'>ZooKeeper</a>\u000a<a href='http://shiyanjun.cn/archives/tag/hadoop2' class='tag-link-25' title='3' style='font-size: 16.6551724138pt; color: #bc8cbf'>Hadoop2</a>\u000a<a href='http://shiyanjun.cn/archives/tag/jvm' class='tag-link-42' title='1' style='font-size: 12pt; color: #00a650'>JVM</a>\u000a<a href='http://shiyanjun.cn/archives/tag/redis' class='tag-link-21' title='1' style='font-size: 12pt; color: #00a650'>Redis</a>\u000a<a href='http://shiyanjun.cn/archives/tag/mahout' class='tag-link-93' title='1' style='font-size: 12pt; color: #00a650'>Mahout</a>\u000a<a href='http://shiyanjun.cn/archives/tag/%e5%88%86%e7%b1%bb' class='tag-link-90' title='3' style='font-size: 16.6551724138pt; color: #bc8cbf'>\u5206\u7c7b</a>\u000a<a href='http://shiyanjun.cn/archives/tag/id3' class='tag-link-57' title='1' style='font-size: 12pt; color: #00a650'>ID3</a>\u000a<a href='http://shiyanjun.cn/archives/tag/hdfs' class='tag-link-72' title='5' style='font-size: 19.4482758621pt; color: #2f3192'>HDFS</a>\u000a<a href='http://shiyanjun.cn/archives/tag/maven' class='tag-link-29' title='1' style='font-size: 12pt; color: #00a650'>Maven</a>\u000a<a href='http://shiyanjun.cn/archives/tag/jregex' class='tag-link-26' title='1' style='font-size: 12pt; color: #00a650'>JRegex</a>\u000a<a href='http://shiyanjun.cn/archives/tag/hwi' class='tag-link-77' title='1' style='font-size: 12pt; color: #00a650'>HWI</a>\u000a<a href='http://shiyanjun.cn/archives/tag/dbscan' class='tag-link-87' title='1' style='font-size: 12pt; color: #00a650'>DBSCAN</a>\u000a<a href='http://shiyanjun.cn/archives/tag/mybatis' class='tag-link-73' title='1' style='font-size: 12pt; color: #00a650'>Mybatis</a>\u000a<a href='http://shiyanjun.cn/archives/tag/crunch' class='tag-link-84' title='1' style='font-size: 12pt; color: #00a650'>Crunch</a>\u000a<a href='http://shiyanjun.cn/archives/tag/k-medoids' class='tag-link-91' title='1' style='font-size: 12pt; color: #00a650'>k-medoids</a>\u000a<a href='http://shiyanjun.cn/archives/tag/storm' class='tag-link-35' title='5' style='font-size: 19.4482758621pt; color: #2f3192'>Storm</a>\u000a<a href='http://shiyanjun.cn/archives/tag/web-services' class='tag-link-40' title='1' style='font-size: 12pt; color: #00a650'>Web Services</a>\u000a<a href='http://shiyanjun.cn/archives/tag/yarn' class='tag-link-65' title='2' style='font-size: 14.7931034483pt; color: #f16522'>YARN</a>\u000a<a href='http://shiyanjun.cn/archives/tag/cf' class='tag-link-92' title='1' style='font-size: 12pt; color: #00a650'>CF</a>\u000a<a href='http://shiyanjun.cn/archives/tag/libsvm' class='tag-link-32' title='2' style='font-size: 14.7931034483pt; color: #f16522'>libsvm</a>\u000a<a href='http://shiyanjun.cn/archives/tag/thrift' class='tag-link-22' title='4' style='font-size: 18.2068965517pt; color: #0f0'>Thrift</a>\u000a<a href='http://shiyanjun.cn/archives/tag/sql' class='tag-link-24' title='1' style='font-size: 12pt; color: #00a650'>SQL</a>\u000a<a href='http://shiyanjun.cn/archives/tag/hive' class='tag-link-62' title='3' style='font-size: 16.6551724138pt; color: #bc8cbf'>Hive</a>\u000a<a href='http://shiyanjun.cn/archives/tag/%e5%86%b3%e7%ad%96%e6%a0%91' class='tag-link-58' title='2' style='font-size: 14.7931034483pt; color: #f16522'>\u51b3\u7b56\u6811</a>\u000a<a href='http://shiyanjun.cn/archives/tag/solr' class='tag-link-11' title='5' style='font-size: 19.4482758621pt; color: #2f3192'>Solr</a>\u000a<a href='http://shiyanjun.cn/archives/tag/spark' class='tag-link-68' title='8' style='font-size: 22.0862068966pt; color: #16bcb4'>Spark</a>\u000a<a href='http://shiyanjun.cn/archives/tag/elasticsearch' class='tag-link-88' title='1' style='font-size: 12pt; color: #00a650'>ElasticSearch</a>\u000a<a href='http://shiyanjun.cn/archives/tag/%e6%8e%92%e5%ba%8f' class='tag-link-71' title='8' style='font-size: 22.0862068966pt; color: #16bcb4'>\u6392\u5e8f</a>\u000a<a href='http://shiyanjun.cn/archives/tag/solrcloud' class='tag-link-27' title='1' style='font-size: 12pt; color: #00a650'>SolrCloud</a>\u000a<a href='http://shiyanjun.cn/archives/tag/%e8%81%9a%e7%b1%bb' class='tag-link-89' title='3' style='font-size: 16.6551724138pt; color: #bc8cbf'>\u805a\u7c7b</a>\u000a<a href='http://shiyanjun.cn/archives/tag/hadoop-1-2-1' class='tag-link-80' title='11' style='font-size: 24.1034482759pt; color: #005b7e'>Hadoop-1.2.1</a>\u000a<a href='http://shiyanjun.cn/archives/tag/node-js' class='tag-link-75' title='1' style='font-size: 12pt; color: #00a650'>Node.js</a>\u000a<a href='http://shiyanjun.cn/archives/tag/spring' class='tag-link-46' title='1' style='font-size: 12pt; color: #00a650'>Spring</a>\u000a<a href='http://shiyanjun.cn/archives/tag/haproxy' class='tag-link-37' title='1' style='font-size: 12pt; color: #00a650'>HAProxy</a>\u000a<a href='http://shiyanjun.cn/archives/tag/svm' class='tag-link-33' title='1' style='font-size: 12pt; color: #00a650'>SVM</a>\u000a<a href='http://shiyanjun.cn/archives/tag/oozie' class='tag-link-15' title='4' style='font-size: 18.2068965517pt; color: #0f0'>Oozie</a>\u000a<a href='http://shiyanjun.cn/archives/tag/hadoop' class='tag-link-9' title='28' style='font-size: 30pt; color: #ee1d24'>Hadoop</a>\u000a<a href='http://shiyanjun.cn/archives/tag/impala' class='tag-link-61' title='2' style='font-size: 14.7931034483pt; color: #f16522'>Impala</a>\u000a<a href='http://shiyanjun.cn/archives/tag/c4-5' class='tag-link-60' title='1' style='font-size: 12pt; color: #00a650'>C4.5</a>\u000a<a href='http://shiyanjun.cn/archives/tag/mapreduce' class='tag-link-34' title='13' style='font-size: 25.1896551724pt; color: #f49bc1'>MapReduce</a>\u000a<a href='http://shiyanjun.cn/archives/tag/pig' class='tag-link-85' title='1' style='font-size: 12pt; color: #00a650'>Pig</a>\u000a<a href='http://shiyanjun.cn/archives/tag/tomcat' class='tag-link-28' title='1' style='font-size: 12pt; color: #00a650'>Tomcat</a>\u000a<a href='http://shiyanjun.cn/archives/tag/flume' class='tag-link-79' title='2' style='font-size: 14.7931034483pt; color: #f16522'>Flume</a>\u000a<a href='http://shiyanjun.cn/archives/tag/memcached' class='tag-link-76' title='1' style='font-size: 12pt; color: #00a650'>Memcached</a>\u000a<a href='http://shiyanjun.cn/archives/tag/java' class='tag-link-3' title='2' style='font-size: 14.7931034483pt; color: #f16522'>Java</a>\u000a<a href='http://shiyanjun.cn/archives/tag/jstorm' class='tag-link-83' title='1' style='font-size: 12pt; color: #00a650'>JStorm</a>\u000a<a href='http://shiyanjun.cn/archives/tag/ganglia' class='tag-link-78' title='1' style='font-size: 12pt; color: #00a650'>Ganglia</a>\u000a<a href='http://shiyanjun.cn/archives/tag/kafka' class='tag-link-81' title='1' style='font-size: 12pt; color: #00a650'>Kafka</a>\u000a<a href='http://shiyanjun.cn/archives/tag/php' class='tag-link-5' title='1' style='font-size: 12pt; color: #00a650'>PHP</a>\u000a<a href='http://shiyanjun.cn/archives/tag/nginx' class='tag-link-17' title='1' style='font-size: 12pt; color: #00a650'>Nginx</a>\u000a<a href='http://shiyanjun.cn/archives/tag/dubbo' class='tag-link-36' title='4' style='font-size: 18.2068965517pt; color: #0f0'>Dubbo</a></aside></div><div class="widget-wrap"><aside id="get-recent-comments" class="widget widget_get_recent_comments"><h2 class="widget-title">\u6700\u65b0\u8bc4\u8bba</h2><div id="get_recent_comments_wrap"><ul>	<li><a href="http://shiyanjun.cn/archives/934.html#comment-58062" title="Kafka+Storm+HDFS\u6574\u5408\u5b9e\u8df5, 2014-10-21 19:24:19">wechat</a>: 2014\u5e74\u7684\u535a\u6587\uff0c\u4e0d\u77e5\u9053\u73b0\u5728\u9a6c\u4e0a2017\u5e74\u6709\u6ca1\u6709\u4ec0\u4e48\u53ef\u66ff\u6362\u7684 \u65b9\u6848</li>\u000a	<li><a href="http://shiyanjun.cn/archives/548.html#comment-58059" title="\u4f7f\u7528libsvm\u5b9e\u73b0\u6587\u672c\u5206\u7c7b, 2013-12-13 23:43:05">budongqiuzhi</a>: \u697c\u4e3b\uff0c\u4e0d\u77e5\u4f60\u8fd8\u4f1a\u4e0d\u4f1a\u56de\u7b54\u6211\u7684\u95ee\u9898\uff0c\u6211\u884c\u95ee\u4e0bprocessor .dataset.label.vector.file=C:\u005c \u005cUsers\u005c\u005cKINKOO\u005c\u005cDesktop\u005c\u005cve...</li>\u000a	<li><a href="http://shiyanjun.cn/archives/1119.html#comment-58057" title="Hadoop YARN\u67b6\u6784\u8bbe\u8ba1\u8981\u70b9, 2015-06-01 22:57:15">luogh</a>: \u535a\u4e3b\u753b\u7684\u56fe\u5f88\u6e05\u6670\uff0c\u7b80\u6d01\u3002\u628ayarn\u7684\u6574\u4f53\u601d\u60f3\u57fa\u672c\u68b3\u7406\u4e86\u4e00\u904d\uff0c \u7ed9\u6211\u4eec\u81ea\u5df1\u60f3\u770b\u6e90\u7801\u7684\u540c\u5b66\u8fbe\u5230\u4e86\u4e8b\u534a\u529f\u500d\u7684\u6548\u679c\u554a\u3002\u611f\u8c22\u3002</li>\u000a	<li><a href="http://shiyanjun.cn/archives/1002.html#comment-58049" title="Hue\u5b89\u88c5\u914d\u7f6e\u5b9e\u8df5, 2014-12-17 21:19:10">chenerzhu</a>: \u627e\u5230\u4e86\uff0c\u50cf\u8fd9\u6837\u5c31\u53ef\u4ee5\u4e86 ./build/env/bin/hue runserver_plus 0.0.0.0:8888</li>\u000a	<li><a href="http://shiyanjun.cn/archives/1002.html#comment-58048" title="Hue\u5b89\u88c5\u914d\u7f6e\u5b9e\u8df5, 2014-12-17 21:19:10">chenerzhu</a>: \u8bf7\u95eehue\u80fd\u4f7f\u7528\u516c\u7f51\u7684ip\u8bbf\u95ee\u5417\uff1f</li>\u000a	<li><a href="http://shiyanjun.cn/archives/915.html#comment-58041" title="Flume(NG)\u67b6\u6784\u8bbe\u8ba1\u8981\u70b9\u53ca\u914d\u7f6e\u5b9e\u8df5, 2014-09-17 22:29:49">canghong</a>: \u5199\u535a\u4e3b\uff0c \u5565\u65f6\u5019\u4e5f\u4e00\u4e2aFlume\u7684\u5206\u5c42\u67b6\u6784\u5427</li>\u000a	<li><a href="http://shiyanjun.cn/archives/1472.html#comment-58037" title="Apache Storm\u5185\u90e8\u539f\u7406\u5206\u6790, 2016-02-17 21:42:58">canghong</a>: \u975e\u5e38\u6709\u5e2e\u52a9\uff0c\u611f\u8c22\uff5e \uff5e</li>\u000a	<li><a href="http://shiyanjun.cn/archives/1545.html#comment-58035" title="Spark Standalone\u67b6\u6784\u8bbe\u8ba1\u8981\u70b9\u5206\u6790, 2016-11-23 14:59:20">\u80d6\u54e5</a>: \u8f6c\u8d77</li>\u000a	<li><a href="http://shiyanjun.cn/archives/1545.html#comment-58026" title="Spark Standalone\u67b6\u6784\u8bbe\u8ba1\u8981\u70b9\u5206\u6790, 2016-11-23 14:59:20">ll</a>: test\u4f60\u597d</li>\u000a	<li><a href="http://shiyanjun.cn/archives/1545.html#comment-57990" title="Spark Standalone\u67b6\u6784\u8bbe\u8ba1\u8981\u70b9\u5206\u6790, 2016-11-23 14:59:20">ostarsier</a>: \u535a\u4e3b\u753b\u7684\u56fe\u5f88\u6709\u827a\u672f\u6c14\u606f\u554a</li>\u000a</ul></div></aside></div><div class="widget-wrap"><aside id="meta-2" class="widget widget_meta"><h2 class="widget-title">\u7ad9\u70b9\u7ba1\u7406</h2>			<ul>\u000a						<li><a href="http://shiyanjun.cn/wp-login.php">\u767b\u5f55</a></li>\u000a			<li><a href="http://shiyanjun.cn/feed" title="\u4f7f\u7528RSS 2.0\u8ba2\u9605\u672c\u7ad9\u70b9\u5185\u5bb9">\u6587\u7ae0<abbr title="Really Simple Syndication">RSS</abbr></a></li>\u000a			<li><a href="http://shiyanjun.cn/comments/feed" title="\u4f7f\u7528RSS\u8ba2\u9605\u672c\u7ad9\u70b9\u7684\u6240\u6709\u6587\u7ae0\u7684\u8fd1\u671f\u8bc4\u8bba">\u8bc4\u8bba<abbr title="Really Simple Syndication">RSS</abbr></a></li>\u000a<li><a href="https://cn.wordpress.org/" title="\u57fa\u4e8eWordPress\uff0c\u4e00\u4e2a\u4f18\u7f8e\u3001\u5148\u8fdb\u7684\u4e2a\u4eba\u4fe1\u606f\u53d1\u5e03\u5e73\u53f0\u3002">WordPress.org</a></li>			</ul>\u000a</aside></div><div class="widget-wrap"><aside id="text-4" class="widget widget_text"><h2 class="widget-title">  </h2>			<div class="textwidget"><p><script type="text/javascript">var cnzz_protocol = (("https:" == document.location.protocol) ? " https://" : " http://");document.write(unescape("%3Cspan id='cnzz_stat_icon_1000041007'%3E%3C/span%3E%3Cscript src='" + cnzz_protocol + "s22.cnzz.com/z_stat.php%3Fid%3D1000041007%26online%3D1%26show%3Dline' type='text/javascript'%3E%3C/script%3E"));</script><br />\u000a<!--<br />\u000a<a target="_blank" href="https://www.upyun.com/"><img src="http://upfiles.b0.upaiyun.com/logo/180x90.png" alt="UPYUN"></a><br />\u000a--></p>\u000a</div>\u000a		</aside></div>		</div><!-- #secondary .widget-area -->\u000a\u000a    </div> <!-- end #content -->\u000a        \u000a	<footer id="colophon" role="contentinfo">\u000a		<div id="site-generator">\u000a			COPYRIGHT  2013-2018 <a href="http://www.shiyanjun.cn/" rel="designer"><strong>\u7b80\u5355\u4e4b\u7f8e</strong></a>            <span class="sep"> | </span>\u000a             Powered by <a href="http://wordpress.org/" title="Semantic Personal Publishing Platform">WORDPRESS</a>\u000a<span class="sep"> | </span>\u000a			 <a href="http://www.miitbeian.gov.cn/">\u4eacICP\u590714038454\u53f7</a>\u000a            		</div>\u000a		<div id="partnership">\u000a			<a target="_blank" href="https://www.upyun.com/"><img src="https://www.upyun.com/assets/league/90X45.png" title="UPYUN"></a>\u000a		</div>\u000a	</footer><!-- #colophon -->\u000a</div><!-- #page -->\u000a\u000a<div id="wp-auto-top"><div id="wp-auto-top-top"></div><div id="wp-auto-top-comment"></div><div id="wp-auto-top-bottom"></div></div>\u000a<script> var commentPositionId = '#comments';var wpAutoTopSpeed = 5;</script><style>\u000a   #wp-auto-top{position:fixed;top:85%;right:50%;display:block;margin-right:-49%; z-index:9999;}\u000a   #wp-auto-top-top,#wp-auto-top-comment,#wp-auto-top-bottom{background:url(http://shiyanjun.cn/wp-content/plugins/wp-auto-top/img/29.png) no-repeat;position:relative;cursor:pointer;height:25px;width:29px;margin:10px 0 0;}\u000a   #wp-auto-top-comment{background-position:left -30px;height:32px;}#wp-auto-top-bottom{background-position:left -68px;}\u000a   #wp-auto-top-comment:hover{background-position:right -30px;}\u000a   #wp-auto-top-top:hover{background-position:right 0;}\u000a   #wp-auto-top-bottom:hover{background-position:right -68px ;}\u000a   </style><script type='text/javascript' src='http://shiyanjun.cn/wp-content/plugins/akismet/_inc/form.js?ver=3.0.1'></script>\u000a<script type='text/javascript' src='http://shiyanjun.cn/wp-content/plugins/syntaxhighlighter/syntaxhighlighter2/scripts/shCore.js?ver=2.1.364'></script>\u000a<script type='text/javascript' src='http://shiyanjun.cn/wp-content/plugins/syntaxhighlighter/syntaxhighlighter2/scripts/shBrushScala.js?ver=2.1.364'></script>\u000a<script type='text/javascript'>\u000a	(function(){\u000a		var corecss = document.createElement('link');\u000a		var themecss = document.createElement('link');\u000a		var corecssurl = "http://shiyanjun.cn/wp-content/plugins/syntaxhighlighter/syntaxhighlighter2/styles/shCore.css?ver=2.1.364";\u000a		if ( corecss.setAttribute ) {\u000a				corecss.setAttribute( "rel", "stylesheet" );\u000a				corecss.setAttribute( "type", "text/css" );\u000a				corecss.setAttribute( "href", corecssurl );\u000a		} else {\u000a				corecss.rel = "stylesheet";\u000a				corecss.href = corecssurl;\u000a		}\u000a		document.getElementsByTagName("head")[0].insertBefore( corecss, document.getElementById("syntaxhighlighteranchor") );\u000a		var themecssurl = "http://shiyanjun.cn/wp-content/plugins/syntaxhighlighter/syntaxhighlighter2/styles/shThemeDefault.css?ver=2.1.364";\u000a		if ( themecss.setAttribute ) {\u000a				themecss.setAttribute( "rel", "stylesheet" );\u000a				themecss.setAttribute( "type", "text/css" );\u000a				themecss.setAttribute( "href", themecssurl );\u000a		} else {\u000a				themecss.rel = "stylesheet";\u000a				themecss.href = themecssurl;\u000a		}\u000a		//document.getElementById("syntaxhighlighteranchor").appendChild(themecss);\u000a		document.getElementsByTagName("head")[0].insertBefore( themecss, document.getElementById("syntaxhighlighteranchor") );\u000a	})();\u000a	SyntaxHighlighter.config.clipboardSwf = 'http://shiyanjun.cn/wp-content/plugins/syntaxhighlighter/syntaxhighlighter2/scripts/clipboard.swf';\u000a	SyntaxHighlighter.config.strings.expandSource = 'show source';\u000a	SyntaxHighlighter.config.strings.viewSource = '\u67e5\u770b\u6e90\u4ee3\u7801';\u000a	SyntaxHighlighter.config.strings.copyToClipboard = '\u590d\u5236\u5230\u526a\u8d34\u677f';\u000a	SyntaxHighlighter.config.strings.copyToClipboardConfirmation = '\u4ee3\u7801\u73b0\u5728\u5728\u4f60\u7684\u526a\u8d34\u677f';\u000a	SyntaxHighlighter.config.strings.print = '\u6253\u5370';\u000a	SyntaxHighlighter.config.strings.help = '\u5e2e\u52a9';\u000a	SyntaxHighlighter.config.strings.alert = 'SyntaxHighlighter\u005cn\u005cn';\u000a	SyntaxHighlighter.config.strings.noBrush = '\u65e0\u6cd5\u627e\u5230Brush\uff1a';\u000a	SyntaxHighlighter.config.strings.brushNotHtmlScript = 'Brush\u4e0d\u80fd\u8bbe\u7f6e html-script\u9009\u9879';\u000a	SyntaxHighlighter.defaults['pad-line-numbers'] = 1;\u000a	SyntaxHighlighter.all();\u000a</script>\u000a<script type='text/javascript' src='http://shiyanjun.cn/wp-includes/js/comment-reply.min.js?ver=3.9.2'></script>\u000a<script type='text/javascript' src='http://shiyanjun.cn/wp-content/plugins/wp-auto-top/wp-auto-top.js?ver=3.9.2'></script>\u000a\u000a</body>\u000a</html>
p3
a.